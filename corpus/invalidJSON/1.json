{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/cmu-db/noisepage-stats"
		},
		"file": {
			"name": "openapi.yml.j2",
			"path": "performance-storage-service/openapi/openapi.yml.j2",
			"content": "openapi: 3.0.0\ninfo:\n  description: \"This service takes in performance test result data and stores it in TimescaleDB\"\n  version: \"2.0.0\"\n  title: \"InCRUDibles Dash\"\nservers:\n  - url: \"https://incrudibles-{{ env }}.db.pdl.cmu.edu\"\n    description: \"{{ env | capitalize }} server\"\nsecurity:\n  - BasicAuth: []\npaths:\n  /oltpbench:\n    post:\n      summary: \"Report a new set of OLTPBench results from a build\"\n      description: \"\"\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/OLTPBenchResult\"\n      responses:\n        \"201\":\n          description: Created\n        \"400\":\n          description: Bad Request\n        \"403\":\n          description: Forbidden\n        \"500\":\n          description: Internal Server Error\n\n  /microbenchmark:\n    post:\n      summary: \"Report a new microbenchmark results from a build\"\n      description: \"\"\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/MicrobenchmarkResult\"\n      responses:\n        \"201\":\n          description: Created\n        \"400\":\n          description: Bad Request\n        \"403\":\n          description: Forbidden\n        \"500\":\n          description: Internal Server Error\n\n  /artifact-stats:\n    post:\n      summary: \"Report a new artifact stats result from a build\"\n      description: \"\"\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/ArtifactStatsResult\"\n      responses:\n        \"201\":\n          description: Created\n        \"400\":\n          description: Bad Request\n        \"403\":\n          description: Forbidden\n        \"500\":\n          description: Internal Server Error\n\ncomponents:\n  securitySchemes:\n    BasicAuth:\n      type: http\n      scheme: basic\n  schemas:\n    # OLTPBench specific schemas\n    OLTPBenchResult:\n      description: A build result from running all the OLTPBench results\n      type: object\n      required:\n        - metadata\n        - timestamp\n        - type\n        - parameters\n        - metrics\n      properties:\n        metadata:\n          $ref: \"#/components/schemas/Metadata\"\n        timestamp:\n          type: string\n          format: unix-timestamp\n          example: 1592389291843\n          # TODO: Is this start time or end time?\n          description: The start time of the Jenkins job.\n        type:\n          type: string\n          enum:\n            - tatp\n            - tpcc\n            - noop\n            - smallbank\n            - ycsb\n          description: The type of OLTPBench.\n        parameters:\n          $ref: \"#/components/schemas/OLTPBenchParameters\"\n        metrics:\n          $ref: \"#/components/schemas/OLTPBenchMetrics\"\n\n    OLTPBenchParameters:\n      description: The settings that the test was run with\n      type: object\n      required:\n        - query_mode\n        - scale_factor\n        - terminals\n        - client_time\n        - transaction_weights\n        - max_connection_threads\n      properties:\n        query_mode:\n          type: string\n          enum:\n            - simple\n            - extended\n          description: The query mode when running the testing script.\n        scale_factor:\n          type: number\n          format: float\n          description: The size of the database to load.\n        terminals:\n          type: integer\n          description: The number of client threads that will issue requests to the DBMS.\n        client_time:\n          type: integer\n          description: How long did this test run.\n        transaction_weights:\n          type: array\n          items:\n            $ref: \"#/components/schemas/TransactionWeight\"\n        max_connection_threads:\n          type: integer\n          description: The maximum number of threads in the thread pool.\n\n    TransactionWeight:\n      type: object\n      description: An object containing information about the performance test transaction weights\n      required:\n        - name\n        - weight\n      properties:\n        name:\n          type: string\n          description: The name of the transaction (i.e. DELETE_CALL_FORWARDING)\n        weight:\n          type: integer\n          description: The weight of the transaction type for the run of OLTPBench\n\n    OLTPBenchMetrics:\n      type: object\n      description: An object containing all test metrics for OLTPBench performance tests\n      required:\n        - throughput\n      properties:\n        throughput:\n          type: number\n          format: float\n          description: The transactions per second that the test completed\n        latency:\n          $ref: \"#/components/schemas/LatencyMetrics\"\n        memory_info:\n          type: object\n          description: An object containing RSS and VMS summary memory info.\n          properties:\n            rss:\n              $ref: \"#/components/schemas/MemoryItemSummary\"\n            vms:\n              $ref: \"#/components/schemas/MemoryItemSummary\"\n        incremental_metrics:\n          type: array\n          items:\n            $ref: \"#/components/schemas/IncrementalMetrics\"\n\n    # Microbenchmark specific schemas\n    MicrobenchmarkResult:\n      description: The results of the microbenchmark jenkins job\n      type: object\n      required:\n        - metadata\n        - timestamp\n        - test_suite\n        - test_name\n        - parameters\n        - metrics\n      properties:\n        metadata:\n          $ref: \"#/components/schemas/Metadata\"\n        timestamp:\n          type: string\n          format: unix-timestamp\n          example: 1592389291843\n          description: The time the microbenchmark was executed.\n        test_suite:\n          type: string\n          example: BwTreeBenchmark\n          description: The name of the microbenchmark test suite.\n        test_name:\n          type: string\n          example: RandomInsert\n          description: The name of the microbenchmark test.\n        parameters:\n          $ref: \"#/components/schemas/MicrobenchmarkParameters\"\n        metrics:\n          $ref: \"#/components/schemas/MicrobenchmarkMetrics\"\n\n    MicrobenchmarkParameters:\n      description: The parameters that were used to run the microbenchmark tests\n      type: object\n      required:\n        - threads\n        - min_runtime\n      properties:\n        threads:\n          type: integer\n          description: The number of threads used for multi-threaded benchmarks.\n        min_runtime:\n          type: integer\n          description: The minimum time the benchmarks could be run for (seconds).\n\n    MicrobenchmarkMetrics:\n      description: The results from a single microbenchmark test\n      type: object\n      required:\n        - throughput\n        - tolerance\n        - iterations\n      properties:\n        status:\n          type: string\n          description: A text status of whether the throughput violated the tolerance.\n          enum:\n            - \"PASS\"\n            - \"FAIL\"\n        throughput:\n          type: number\n          format: float\n          description: The transations per second executed during the test.\n        ref_throughput:\n          type: number\n          format: float\n          description: |\n            The average throughput for the test over the last 30 days. This is \n            collected from Jenkins artifacts created over the last 30 days of the test execution.\n        stdev_throughput:\n          type: number\n          format: float\n          description: |\n            The standard deviation of thoughput results for the test. This is \n            collected from Jenkins artifacts created over the last 30 days of the test execution.\n        tolerance:\n          type: integer\n          description: The allowed throughput degradation before a warning should be raised (number refers to %)\n        iterations:\n          type: integer\n          description: The number of times the benchmark was run for to create a statistically stable result.\n\n    # Artifact stats specific schemas\n    ArtifactStatsResult:\n      description: The results of the artifact stats jenkins job\n      type: object\n      required:\n        - metadata\n        - timestamp\n        - metrics\n      properties:\n        metadata:\n          $ref: \"#/components/schemas/Metadata\"\n        timestamp:\n          type: string\n          format: unix-timestamp\n          example: 1592389291843\n          description: The time the artifact stats were collected.\n        metrics:\n          type: object\n          description: |\n            The artifact stats that were collected. There is no validation so\n            this field remains very flexible.\n          example: { \"complie_time\": 1234.1234, \"rss_on_start\": 21342342 }\n    # Generic schemas\n    Metadata:\n      description: The metadata of the test\n      type: object\n      required:\n        - jenkins\n        - github\n        - noisepage\n        - environment\n      properties:\n        jenkins:\n          $ref: \"#/components/schemas/JenkinsMetadata\"\n        github:\n          $ref: \"#/components/schemas/GithubMetadata\"\n        noisepage:\n          $ref: \"#/components/schemas/NoisepageMetadata\"\n        environment:\n          $ref: \"#/components/schemas/EnvironmentMetadata\"\n\n    JenkinsMetadata:\n      description: The metadata related to Jenkins\n      type: object\n      required:\n        - jenkins_job_id\n      properties:\n        jenkins_job_id:\n          type: integer\n          description: The ID of the job which runs this test on Jenkins\n\n    GithubMetadata:\n      description: The metadata related to GitHub\n      type: object\n      required:\n        - git_commit_id\n        - git_branch\n      properties:\n        git_commit_id:\n          type: string\n          description: The commit id of the current job\n        git_branch:\n          type: string\n          description: The name of the branch where the nightly job runs\n\n    NoisepageMetadata:\n      description: The metadata related to Noisepage\n      type: object\n      required:\n        - db_version\n      properties:\n        db_version:\n          type: string\n          description: The version of NoisePage\n\n    EnvironmentMetadata:\n      description: The metadata related to the environment\n      type: object\n      required:\n        - os_version\n        - cpu_number\n        - cpu_socket\n        - wal_device\n      properties:\n        os_version:\n          type: string\n          description: The version of the operating system on the testing server.\n        cpu_number:\n          type: string\n          description: The number of CPU used on the testing server\n        cpu_socket:\n          type: string\n          description: The number of the cpu socket on the testing server. When it is larger than 1, this server is a NUMA system\n        wal_device:\n          type: string\n          enum:\n            - HDD\n            - RAM disk\n            - SATA SSD\n            - NVMe SSD\n            - None\n          description: The type of storage that the write ahead log is written to.\n\n    LatencyMetrics:\n      type: object\n      description: An object containing latency metrics for OLTPBench performance tests\n      properties:\n        l_25:\n          type: number\n          format: float\n          description: The 25th percentile of the latency results.\n        l_75:\n          type: number\n          format: float\n          description: The 75th percentile of the latency results.\n        l_90:\n          type: number\n          format: float\n          description: The 90th percentile of the latency results.\n        l_95:\n          type: number\n          format: float\n          description: The 95th percentile of the latency results.\n        l_99:\n          type: number\n          format: float\n          description: The 99th percentile of the latency results.\n        avg:\n          type: number\n          format: float\n          description: The average of the latency results.\n        median:\n          type: number\n          format: float\n          description: The median of the latency results.\n        max:\n          type: number\n          format: float\n          description: The max of the latency results.\n        min:\n          type: number\n          format: float\n          description: The min of the latency results.\n\n    MemoryItemSummary:\n      type: object\n      properties:\n        avg:\n          type: number\n          format: float\n          description: the average consumption of a given memory info in bytes with 4 decimal places.\n          example: 801628490.3527\n\n    MemoryMetrics:\n      type: object\n      description: An object containing memory metrics for OLTPBench performance tests\n      properties:\n        rss:\n          type: integer\n          description: The resident set size, the non-swapped physical memory that a task has used in bytes.\n          example: 5148712960\n        vms:\n          type: integer\n          description: The virtual memory size, the total amount of virtual memory used by the process in bytes.\n          example: 19047882752\n\n    IncrementalMetrics:\n      type: object\n      description: An object containing all metrics for long-running OLTPBench performance tests\n      required:\n        - time\n        - throughput\n      properties:\n        time:\n          type: integer\n          description: The time point of the long-running test\n        throughput:\n          type: number\n          format: float\n          description: The transactions per second that the test completed\n        latency:\n          $ref: \"#/components/schemas/LatencyMetrics\"\n        memory_info:\n          $ref: \"#/components/schemas/MemoryMetrics\"\n"
		}
	},
	"Error": "invalid json"
}