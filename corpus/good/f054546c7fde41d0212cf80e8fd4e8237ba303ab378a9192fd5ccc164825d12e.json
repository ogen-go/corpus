{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/arnaudbirk/ign-gpao"
		},
		"file": {
			"name": "swagger.yml",
			"size": 0,
			"path": "api/doc/swagger.yml",
			"byteSize": 13399,
			"content": "openapi: \"3.0.1\"\ninfo: \n  title: \"API GPAO\"\n  version: \"1.0.0\"\n  description: \"Documentation de l'API mise en place dans le cadre de la refonte de la GPAO.\"\nservers:\n  - url: \"http://localhost:8080/api\"\n    description: \"Serveur de production\"\ntags:\n  - name: jobs\n    description: Manipulation des jobs\n  - name: projects\n    description: Manipulation des projets\n  - name: sessions\n    description: Manipulation des sessions\n  - name: client\n    description: Gestion du client python\n  - name: nodes\n    description: Gestion des noeuds\n  - name: maintenance\n    description: Effectue des opérations de maintenance sur la GPAO\npaths:\n  '/jobs':\n    get:\n      tags:\n        - jobs\n      summary: \"Récupération de tous les jobs\"\n      description: \"Récupération de tous les jobs quelque soit son statut\"\n      responses:\n        '200':\n          description: OK\n  '/jobs/reinit':\n    post:\n      tags:\n        - jobs\n      summary: \"Réinitialisation des jobs\"\n      description: \"Réinitialise le statut à ready, le log, start_date, end_date, return_code de tous les jobs passé en paramétre\"\n      requestBody:\n        description: l'ensemble des identifiants des jobs à réinitialiser\n        required: true\n        content:\n         application/json:\n           schema:\n              type: object\n              properties:\n                  ids:\n                    type: array\n                    items:\n                      type: integer\n              example:\n                ids:\n                  - 1\n                  - 2\n                  - 3\n      responses:\n        '200':\n          description: OK\n  '/jobs/status':\n    get:\n      tags:\n        - jobs\n      summary: \"Récupération du nombre de jobs par statut\"\n      description: \"Récupération du nombre de jobs par statut et du total de jobs dans la base\"\n      responses:\n        '200':\n          description: OK\n  '/job/{id}':\n    get:\n      tags:\n        - jobs\n      summary: \"Récupération d'un job en particulier\"\n      description: \"Récupération de toutes les informations relatives à un job en fonction de son id\"\n      parameters:\n        - in: path\n          name: id\n          description: l'identifiant du job\n          required: true\n          schema:\n            type: integer\n      responses:\n        '200':\n          description: OK\n  '/job/ready':\n    get:\n      tags:\n        - jobs\n      summary: \"Récupération de l'identifiant d'un job\"\n      description: \"Récupération de l'identifiant d'un job avec le statut ready et mise à jour de son à jour de son statut en running\"\n      parameters:\n        - in: query\n          name: id_session\n          description: l'identifiant de session\n          required: true\n          schema:\n            type: integer\n      responses:\n        '200':\n          description: OK\n  '/job/{id}/dependencies':\n    get:\n      tags:\n        - jobs\n      summary: \"Récupération des dépendances\"\n      description: \"Récupération de toutes les dépendances liées à un job\"\n      parameters:\n        - in: path\n          name: id\n          description: l'identifiant du job pour lequel on souhaite récupérer les dépendances\n          required: true\n          schema:\n            type: integer\n      responses:\n        '200':\n          description: OK\n  '/job':\n    post:\n      tags:\n        - jobs\n      summary: \"Mise à jour d'un job\"\n      description: \"Permet de mettre à jour le log et le statut d'un job en fonction de son identifiant\"\n      parameters:\n        - in: query\n          name: id\n          description: l'identifiant du job à modifier\n          required: true\n          schema:\n            type: integer\n        - in: query\n          name: status\n          description: le statut du job à modifier\n          required: true\n          schema:\n            type: string\n            enum:\n              - failed\n              - done\n        - in: query\n          name: returnCode\n          description: le code de retour de la commande\n          required: true\n          schema:\n            type: integer\n      requestBody:\n        description: log en sortie du script\n        required: true\n        content:\n          application/json:\n            schema:\n              type: object\n              properties:\n                log:\n                  type: string\n      responses:\n        '200':\n          description: OK\n  '/job/{id}/appendLog':\n    post:\n      tags:\n        - jobs\n      summary: \"Enrichissement du log\"\n      description: \"Permet de mettre à jour le log et le statut d'un job en fonction de son identifiant\"\n      parameters:\n        - in: path\n          name: id\n          description: l'identifiant du job à modifier\n          required: true\n          schema:\n            type: integer\n      requestBody:\n        description: log en sortie du script\n        required: true\n        content:\n          application/json:\n            schema:\n              type: object\n              properties:\n                log:\n                  type: string\n      responses:\n        '200':\n          description: OK\n\n  '/project':\n    put:\n     tags:\n       - projects\n     summary: \"Ajout d'un projet\"\n     description: \"Permet d ajout un projet avec ses differents jobs\"\n     requestBody:\n       description: la structure du projet\n       required: true\n       content:\n         application/json:\n           schema:\n              type: object\n              properties:\n                projects:\n                  type: array\n                  items:\n                    $ref: '#/components/schemas/projects'\n              example: \n                projects:\n                  - name: Chantier 1\n                    jobs:\n                      - name: jobs 1\n                        command: touch file1\n                      - name: jobs 2\n                        command: touch file2\n                      - name: jobs 3\n                        command: touch file3\n                        deps:\n                          - id: 0\n                          - id: 1\n                  - name: Chantier 2\n                    jobs:\n                      - name: jobs 1\n                        command: touch file1\n                    deps:\n                      - id: 0\n     responses:\n       '200':\n         description: OK\n  '/project/{id}':\n    delete:\n     tags:\n       - projects\n     summary: \"Suppression d'un projet\"\n     parameters:\n        - in: path\n          name: id\n          description: l'identifiant du job à supprimer\n          required: true\n          schema:\n            type: integer\n     responses:\n       '200':\n         description: OK\n       '404':\n         description: Not Found\n    get:\n      tags:\n        - projects\n      summary: \"Récupération d'un projet en particulier\"\n      description: \"Récupération de toutes les informations relatives à un projet en fonction de son id\"\n      parameters:\n        - in: path\n          name: id\n          description: l'identifiant du projet\n          required: true\n          schema:\n            type: integer\n      responses:\n        '200':\n          description: OK\n  '/project/{id}/dependencies':\n    get:\n      tags:\n        - projects\n      summary: \"Récupération des dépendances\"\n      description: \"Récupération de toutes les dépendances liées à un projet\"\n      parameters:\n        - in: path\n          name: id\n          description: l'identifiant du projet pour lequel on souhaite récupérer les dépendances\n          required: true\n          schema:\n            type: integer\n      responses:\n        '200':\n          description: OK\n  '/project/{id}/setPriority':\n    post:\n     tags:\n       - projects\n     summary: \"Changement de la priorité des jobs du projet\"\n     parameters:\n        - in: path\n          name: id\n          description: l'identifiant du projet à modififier\n          required: true\n          schema:\n            type: integer\n        - in: query\n          name: priority\n          description: priority\n          required: true\n          schema:\n            type: string\n            enum:\n              - low\n              - normal\n              - high\n     responses:\n       '200':\n         description: OK\n       '404':\n         description: Not Found\n  '/projects':\n    get:\n     tags:\n       - projects\n     summary: \"Récupération de tous les projets\"\n     description: \"Récupération de tous les projets quelque soit leur statut\"\n     responses:\n       '200':\n         description: OK\n  '/projects/statusByJobs':\n    get:\n      tags:\n        - projects\n      summary: \"Récupération du nombre de job pour chaque statut différents\"\n      description: \"Récupération de tous les projets avec le nombre de jobs par statut\"\n      responses:\n        '200':\n          description: OK\n  '/projects/status':\n    get:\n      tags:\n        - projects\n      summary: \"Récupération du statut global de tous les projets\"\n      description: \"Récupération du nombre de projet par statut\"\n      responses:\n        '200':\n          description: OK\n  '/projects/delete':\n    delete:\n     tags:\n       - projects\n     summary: \"Supprime tous les projets de la base\"\n     description: \"Supprime tous les projets de la base ainsi que les jobs, dependances correspondantes\"\n     responses:\n       '200':\n         description: OK\n  '/nodes':\n    get:\n      tags:\n        - nodes\n      summary: \"Récupération de toutes les machines\"\n      description: \"Récupération de toutes les machines\"\n      responses:\n        '200':\n          description: OK\n  '/node/setNbActive':\n    post:\n      tags:\n        - nodes\n      summary: \"Réglage du nombre de coeurs actifs pour une machine\"\n      description: \"Réglage du nombre de coeurs actifs pour une machine\"\n      parameters:\n        - in: query\n          name: host\n          description: hostname\n          required: true\n          schema:\n            type: string\n        - in: query\n          name: limit\n          description: le nb max de coeurs actifs\n          required: true\n          schema:\n            type: integer\n      responses:\n        '200':\n          description: OK\n  '/sessions':\n    get:\n      tags:\n        - sessions\n      summary: \"Récupération de toutes les sessions\"\n      description: \"Récupération de toutes les sessions enregistrées dans la table sessions\"\n      responses:\n        '200':\n          description: OK\n  '/sessions/status':\n    get:\n      tags:\n        - sessions\n      summary: \"Récupération du statut de toutes les sessions\"\n      description: \"Récupération du nombre de sessions pour chaque type de statut\"\n      responses:\n        '200':\n          description: OK\n  '/session':\n    put:\n      tags:\n        - sessions\n      summary: \"Insetion d'une session dans la base\"\n      description: \"Insertion d'un client en précisant le nom de la machine\"\n      parameters: \n        - in: query\n          name: host\n          description: le nom de la machine\n          required: true\n          schema:\n            type: string\n        - in: query\n          name: tags\n          description: une liste de tags\n          required: false\n          schema:\n            type: string\n      responses:\n        '200':\n          description: OK\n  '/session/close':\n    post:\n      tags:\n        - sessions\n      summary: \"Fermeture d'une session\"\n      description: \"Fermeture d'une session\"\n      parameters: \n        - in: query\n          name: id\n          description: id de session\n          required: true\n          schema:\n            type: integer\n      responses:\n        '200':\n          description: OK\n  '/session/cleanUnused':\n    delete:\n      tags:\n        - sessions\n      summary: \"Supprime les sessions inutiles\"\n      description: \"Supprime les sessions dont le statut est 'closed' est qui ne sont pas intervenues dans les calculs\"\n      responses:\n        '200':\n          description: OK\n  '/client':\n    get:\n      tags:\n        - client\n      summary: Renvoie le client Python\n      description: Permet de télécharger le client GPAO écrit en Python ainsi que tous les fichiers utiles à son execution sous forme de zip\n      responses:\n        '200':\n          description: OK\n          headers:\n            Content-Disposition:\n              schema:\n                type: string\n                example: attachment; filename=\"client.zip\"\n          content:\n            application/octet-stream:\n              schema:\n                type: string\n                format: binary\n  '/maintenance/cleanDatabase':\n    get:\n      tags:\n        - maintenance\n      summary: \"Nettoie la base\"\n      description: \"Nettoie le contenu de toutes les tables de la base GPAO pour ne garder que la structure\"\n      responses:\n        '200':\n          description: OK\ncomponents:\n  schemas:\n    projects:\n      properties:\n        name:\n          type: string\n        jobs:\n          type: array\n          items:\n            $ref: '#/components/schemas/jobs'\n        deps:\n          type: array\n          items:\n            $ref: '#/components/schemas/dependency'\n    jobs:\n      properties:\n        name:\n          type: string\n        command:\n          type: string\n        deps:\n          type: array\n          items:\n            $ref: '#/components/schemas/dependency'\n        tags:\n          type: array\n          items:\n            type: string\n    dependency:\n      properties:\n        id:\n          type: integer\n",
			"canonicalURL": "/github.com/arnaudbirk/ign-gpao@6256ccf733decc36a278fb3bf299abeee42a5ae3/-/blob/api/doc/swagger.yml",
			"externalURLs": [
				{
					"url": "https://github.com/arnaudbirk/ign-gpao/blob/6256ccf733decc36a278fb3bf299abeee42a5ae3/api/doc/swagger.yml",
					"serviceKind": "GITHUB"
				}
			]
		}
	}
}