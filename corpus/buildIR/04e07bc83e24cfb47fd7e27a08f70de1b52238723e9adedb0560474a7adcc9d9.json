{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/ProjectEKA/hip-service"
		},
		"file": {
			"name": "openapi.yaml",
			"size": 0,
			"path": "src/In.ProjectEKA.HipService/wwwroot/openapi.yaml",
			"byteSize": 24626,
			"content": "openapi: 3.0.0\ninfo:\n  version: 0.0.1\n  title: Health Information Provider\n  description: \u003e\n    Clinical establishments which generate or store customer data in digital form. \n    These include hospitals, primary or secondary health care centres, nursing homes, \n    diagnostic centres, clinics, medical device companies and other such entities \n    as may be identified by regulatory authorities from time to time.\nservers:\n  - url: https://ncg-dev.projecteka.in/hip\n    description: Dev\n\ntags:\n  - name: discovery\n  - name: link\n  - name: data flow\n  - name: consents\n\npaths:\n  /patients/discover/carecontexts:\n    post:\n      tags:\n        - discovery\n      summary: Discover patient's accounts\n      description: \u003e\n        Return only one patient record with (potentially masked) associated care contexts\n          1. **At least one of the verified identifier matches.**\n          2. **Filter out records using unverified, firstName, secondName, gender and dob\n          if there are more than one patient records found from step 1.**\n          3. **Store the discover request entry with transactionId and care contexts discovered for a given request**\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/PatientDiscoveryRequest'\n          application/xml:\n            schema:\n              $ref: '#/components/schemas/PatientDiscoveryRequest'\n      responses:\n        '200':\n          description: A patient record with one or more care contexts\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/PatientDiscoveryResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/PatientDiscoveryResponse'\n        '400':\n          description: \u003e\n            **Causes:**\n              * Empty verified identifiers.\n              * Format mismatch of any of attributes.\n                | type   | Format/Allowed Values|\n                | ------- | ----------------    |\n                | dateOfBirth     | dd-mm-yyyy  |\n                | gender  | M/F/O |\n                | MOBILE  | valid mobile number with proper country code |\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '404':\n          description: \u003e\n            **Causes:**\n              * No matching patient record found for the given identifiers.\n              * There are more than one definitive match for a given request.\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '500':\n          description: \u003e\n            **Causes:**\n              * Downstream system(s) is down.\n              * Unhandled exceptions.\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /patients/link:\n    post:\n      tags:\n        - link\n      summary: Link patient's care contexts\n      description: \u003e\n        Links care contexts associated with only one patient\n          1. **Validate account reference number and care context reference number**\n          2. **Validate transactionId in the request with discovery request entry to check whether there was a discovery\n              and were these care contexts discovered or not for a given patient**\n          3. **Before linking, HIP needs to authenticate the request with the patient(Ex: OTP verification)**\n          4. **Communicate the mode of authentication of a successful request with Consent Manager**\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/PatientLinkReferenceRequest'\n          application/xml:\n            schema:\n              $ref: '#/components/schemas/PatientLinkReferenceRequest'\n      responses:\n        '200':\n          description: A successful link request\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/PatientLinkReferenceResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/PatientLinkReferenceResponse'\n        '400':\n          description: \u003e\n            **Causes:**\n              * Account reference number is invalid\n              * Care context reference numbers are invalid\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '401':\n          description: \u003e\n            **Causes:**\n              * Unauthorized request\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '500':\n          description: \u003e\n            **Causes:**\n              * Downstream system(s) is down.\n              * Unhandled exceptions.\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /patients/link/{linkRefNumber}:\n    post:\n      tags:\n        - link\n      parameters:\n        - $ref: '#/components/parameters/LinkRefNumber'\n      summary: Authenticates the token submitted by Consent Manager and links the account if authentication is successful.\n      description: \u003e\n        Returns a list of linked care contexts with patient reference number.\n          1. **Validate linked account reference number**\n          2. **Validate if the token sent from Consent Manager is same as the one generated by HIP**\n          3. **Verify whether same Consent Manager which made the link request is sending the token**\n          4. **Returns a list of unmasked linked care contexts with patient reference number**\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/PatientLinkRequest'\n          application/xml:\n            schema:\n              $ref: '#/components/schemas/PatientLinkRequest'\n      responses:\n        '200':\n          description: List of linked care contexts of a patient with patient reference number\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/PatientLinkResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/PatientLinkResponse'\n        '400':\n          description: \u003e\n            **Causes:**\n              * Link reference number is invalid\n              * Token is invalid\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '401':\n          description: \u003e\n            **Causes:**\n              * Unauthorized request\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '500':\n          description: \u003e\n            **Causes:**\n              * Downstream system(s) is down.\n              * Unhandled exceptions.\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n\n  /health-information/request:\n    post:\n      tags:\n        - data flow\n      summary: Health information data request\n\n      description: \u003e\n        Acknowledge data request for Health information\n          1. **Validate consent artefact id**\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/HealthInformationRequest'\n          application/xml:\n            schema:\n              $ref: '#/components/schemas/HealthInformationRequest'\n      responses:\n        '200':\n          description: An Acknowledged data transfer request\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/HealthInformationRequestResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/HealthInformationRequestResponse'\n        '400':\n          description: \u003e\n            **Causes:**\n              * Bad request\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '403':\n          description: \u003e\n            **Causes:**\n              * Token is invalid or Link has expired\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '500':\n          description: \u003e\n            **Causes:**\n              * Downstream system(s) is down.\n              * Unhandled exceptions.\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n  /health-information/{informationId}:\n    post:\n      tags:\n        - data flow\n      summary: Health information link data request\n\n      description: \u003e\n        Return data respective to the link\n      parameters:\n        - $ref: '#/components/parameters/InformationId'\n        - $ref: '#/components/parameters/Token'\n        - $ref: '#/components/parameters/TransactionId'\n      responses:\n        '200':\n          description: An Acknowledged data transfer request\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/HealthInformationLinkResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/HealthInformationLinkResponse'\n        '400':\n          description: \u003e\n            **Causes:**\n              * Bad request\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '403':\n          description: \u003e\n            **Causes:**\n              * Token is invalid or Link has expired\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n        '500':\n          description: \u003e\n            **Causes:**\n              * Downstream system(s) is down.\n              * Unhandled exceptions.\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n            application/xml:\n              schema:\n                $ref: '#/components/schemas/ErrorResponse'\n  /consent/notification:\n    post:\n      tags:\n        - consents\n      summary: Notify HIP on consent update\n      description: \u003e\n        Handles the notification of the consent based on its status:\n          1. **IF status is GRANTED, both consent-artefact and signature are available**\n          2. **ELSE both of these fields will be empty**\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/ConsentArtefact'\n          application/xml:\n            schema:\n              $ref: '#/components/schemas/ConsentArtefact'\n      responses:\n        '204':\n          description: An acknowledged consent notification\ncomponents:\n  parameters:\n    LinkRefNumber:\n      name: linkRefNumber\n      in: path\n      required: true\n      description: Reference number for the link request made earlier.\n      schema:\n        $ref: '#/components/schemas/UuidSchema'\n    InformationId:\n      name: informationId\n      in: path\n      required: true\n      description: Information Id for which the link was created\n      schema:\n        $ref: '#/components/schemas/UuidSchema'\n    Token:\n      name: token\n      in: query\n      required: true\n      description: token that was generated for the link\n      schema:\n        $ref: '#/components/schemas/UuidSchema'\n    TransactionId:\n      name: transactionId\n      in: query\n      required: true\n      description: Data flow transaction id\n      schema:\n        $ref: '#/components/schemas/UuidSchema'\n  schemas:\n    UuidSchema:\n      type: string\n      format: uuid\n      example: a1s2c932-2f70-3ds3-a3b5-2sfd46b12a18d\n    PatientDiscoveryRequest:\n      type: object\n      properties:\n        requestId:\n          type: string\n          format: uuid\n        patient:\n          type: object\n          properties:\n            id:\n              type: string\n              example: \u003cpatient-id\u003e@\u003cconsent-manager-id\u003e\n              description: Identifier of patient at consent manager\n            verifiedIdentifiers:\n              type: array\n              items:\n                $ref: '#/components/schemas/Identifier'\n              xml:\n                name: verifiedIdentifiers\n                wrapped: true\n            unverifiedIdentifiers:\n              type: array\n              items:\n                $ref: '#/components/schemas/Identifier'\n              xml:\n                name: unverifiedIdentifiers\n                wrapped: true\n            name:\n              type: string\n              example: \"chandler bing\"\n            gender:\n              type: string\n              enum: [M, F, O]\n            yearOfBirth:\n              type: integer\n              example: 2000\n      xml:\n        name: PatientDiscoveryRequest\n\n    ErrorResponse:\n      type: object\n      properties:\n        error:\n          $ref: '#/components/schemas/Error'\n\n    Identifier:\n      type: object\n      properties:\n        type:\n          $ref: '#/components/schemas/IdentifierType'\n        value:\n          type: string\n          example: \"+919800083232\"\n      xml:\n        name: Identifier\n\n    IdentifierType:\n      type: string\n      enum: [MOBILE, MR]\n\n    PatientDiscoveryResponse:\n      type: object\n      properties:\n        patient:\n          $ref: '#/components/schemas/PatientRepresentation'\n      xml:\n        name: PatientDiscoveryResponse\n\n    PatientRepresentation:\n      type: object\n      properties:\n        referenceNumber:\n          type: string\n        display:\n          type: string\n        careContexts:\n          type: array\n          items:\n            $ref: '#/components/schemas/CareContextRepresentation'\n        matchedBy:\n          type: array\n          items:\n            $ref: '#/components/schemas/IdentifierType'\n      xml:\n        name: Patient\n\n    CareContext:\n      type: object\n      properties:\n        referenceNumber:\n          type: string\n      xml:\n        name: Tag\n\n    CareContextRepresentation:\n      type: object\n      required:\n        - referenceNumber\n        - display\n      properties:\n        referenceNumber:\n          type: string\n        display:\n          type: string\n      xml:\n        name: Tag\n\n    PatientLinkReferenceRequest:\n      type: object\n      properties:\n        requestId:\n          type: string\n          format: uuid\n        transcationId:\n          type: string\n          format: uuid\n        patient:\n          type: object\n          properties:\n            consentManagerUserID:\n              type: string\n            referenceNumber:\n              type: string\n            careContexts:\n              type: array\n              items:\n                $ref: '#/components/schemas/CareContext'\n              xml:\n                name: careContexts\n                wrapped: true\n          xml:\n            name: PatientLinkReferenceRequest\n\n    PatientLinkRequest:\n      type: object\n      properties:\n        token:\n          type: string\n\n    PatientLinkReferenceResponse:\n      type: object\n      properties:\n        link:\n          type: object\n          properties:\n            referenceNumber:\n              type: string\n            authenticationType:\n              type: string\n              enum: ['DIRECT', 'MEDIATED']\n            meta:\n              $ref: '#/components/schemas/Meta'\n\n    Meta:\n      type: object\n      required:\n        - mode\n        - value\n      properties:\n        communicationMedium:\n          type: string\n          enum: ['M0BILE', 'EMAIL']\n        communicationHint:\n          type: string\n        communicationExpiry:\n          type: string\n          example: \"2019-12-30T12:01:55Z\"\n      xml:\n        name: Meta\n\n    Error:\n      type: object\n      properties:\n        code:\n          type: integer\n          enum: [1000, 10001]\n          description: \u003e\n            1. Error code 1000 : No patient found\n            2. Error code 1001: Multiple patients found\n        message:\n          type: string\n      xml:\n        name: Error\n\n    PatientLinkResponse:\n      type: object\n      properties:\n        patient:\n          type: object\n          properties:\n            referenceNumber:\n              type: string\n            display:\n              type: string\n            careContexts:\n              type: array\n              items:\n                $ref: '#/components/schemas/CareContextRepresentation'\n\n    HealthInformationRequest:\n      type: object\n      required:\n        - transactionId\n        - consent\n        - dataPushUrl\n        - keyMaterial\n        - dateRange\n      properties:\n        transactionId:\n          $ref: '#/components/schemas/UuidSchema'\n        consent:\n          $ref: '#/components/schemas/consent'\n        dateRange:\n          $ref: '#/components/schemas/dateRange'\n        dataPushUrl:\n          type: string\n        keyMaterial:\n          $ref: '#/components/schemas/keyMaterial'\n\n    HealthInformationRequestResponse:\n      type: object\n      required:\n        - acknowledgementId\n      properties:\n        acknowledgementId:\n          type: string\n    HealthInformationLinkResponse:\n      type: object\n      required:\n        - transactionId\n        - content\n      properties:\n        transactionId:\n          $ref: '#/components/schemas/UuidSchema'\n        content:\n          type: string\n          description: Encrypted content\n          example: Encrypted content of data packaged in FHIR bundle\n    consent:\n      type: object\n      required:\n        - id\n      properties:\n        id:\n          type: string\n    dateRange:\n      type: object\n      required:\n        - from\n        - to\n      properties:\n        from:\n          type: string\n          format: date-time\n        to:\n          type: string\n          format: date-time\n    ConsentArtefact:\n      type: object\n      required:\n        - status\n        - consentId\n      properties:\n        status:\n          $ref: '#/components/schemas/ConsentStatus'\n        consentId:\n          type: string\n          format: uuid\n        consentDetail:\n          type: object\n          properties:\n            schemaVersion:\n              type: string\n              format: string\n            consentId:\n              type: string\n              format: uuid\n            createdAt:\n              type: string\n              format: date-time\n            patient:\n              $ref: '#/components/schemas/ConsentManagerPatientID'\n            careContexts:\n              type: array\n              items:\n                type: object\n                required:\n                  - patientReference\n                  - careContextReference\n                properties:\n                  patientReference:\n                    type: string\n                    example: batman@tmh\n                  careContextReference:\n                    type: string\n                    example: Episode1\n            purpose:\n              $ref: '#/components/schemas/UsePurpose'\n            hip:\n              type: object\n              allOf:\n                - $ref: '#/components/schemas/OrganizationRepresentation'\n                - xml:\n                    name: hip\n            consentManager:\n              type: object\n              allOf:\n                - $ref: '#/components/schemas/OrganizationReference'\n                - xml:\n                    name: consentManager\n            hiTypes:\n              type: array\n              items:\n                $ref: '#/components/schemas/HITypeEnum'\n            permission:\n              $ref: '#/components/schemas/Permission'\n            signature:\n              type: string\n              example: Signature of CM as defined in W3C standards; Base64 encoded\n\n    HITypeEnum:\n      type: string\n      enum:\n        - Condition\n        - Observation\n        - MedicationRequest\n        - DiagnosticReport\n      xml:\n        name: HIType\n    ConsentStatus:\n      type: string\n      enum:\n        - GRANTED\n        - EXPIRED\n        - DENIED\n        - REQUESTED\n        - REVOKED\n      example: REQUESTED | GRANTED | DENIED | REVOKED | EXPIRED\n    ConsentManagerPatientID:\n      type: object\n      properties:\n        id:\n          type: string\n          xml:\n            attribute: true\n          format: \u003cuser-id\u003e@\u003cncg-id\u003e\n          example: batman@ncg\n    UsePurpose:\n      type: object\n      required:\n        - text\n        - code\n      properties:\n        text:\n          type: string\n        code:\n          type: string\n          description: From the fixed set, documented at refUri\n        refUri:\n          type: string\n          format: uri\n    Permission:\n      type: object\n      properties:\n        accessMode:\n          type: string\n          enum: [VIEW, STORE, QUERY, STREAM]\n        dateRange:\n          type: object\n          properties:\n            from:\n              type: string\n              format: date-time\n            to:\n              type: string\n              format: date-time\n        dataEraseAt:\n          type: string\n          format: date-time\n        frequency:\n          type: object\n          properties:\n            unit:\n              type: string\n              enum: [HOUR, WEEK, DAY, MONTH, YEAR]\n            value:\n              type: integer\n            repeats:\n              type: integer\n      xml:\n        name: Permission\n    OrganizationRepresentation:\n      type: object\n      required:\n        - id\n      properties:\n        id:\n          type: string\n          xml:\n            attribute: true\n        name:\n          type: string\n          xml:\n            attribute: true\n      xml:\n        name: OrganizationResponse\n    OrganizationReference:\n      type: object\n      required:\n        - id\n      properties:\n        id:\n          type: string\n          xml:\n            attribute: true\n      xml:\n        name: OrganizationReference\n    keyMaterial:\n      type: object\n      required:\n        - cryptoAlg\n        - curve\n        - DHPublicKey\n        - nonce\n      properties:\n        cryptoAlg:\n          type: string\n          format: string\n          example: ECDH\n        curve:\n          type: string\n          format: string\n          example: Curve25519\n        dhPublicKey:\n          $ref: '#/components/schemas/keyObject'\n        nonce:\n          type: string\n          format: 32 byte string\n          example: 3fa85f64-5717-4562-b3fc-2c963f66afa6\n    keyObject:\n      type: object\n      required:\n        - expiry\n        - parameters\n        - keyValue\n      properties:\n        expiry:\n          type: string\n          format: date-time\n        parameters:\n          type: string\n          format: string\n          example: Curve25519/32byte random key\n        keyValue:\n          type: string\n          format: string"
		}
	},
	"Error": "buildIR: make ir: path \"/consent/notification\": post: requestBody: contents: application/json: generate schema: field consentDetail: field consentManager: allOf: schema type mismatch: object and "
}