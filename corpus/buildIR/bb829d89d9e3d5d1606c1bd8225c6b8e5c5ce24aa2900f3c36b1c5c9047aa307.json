{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/epilot-dev/sdk-js"
		},
		"file": {
			"name": "openapi.json",
			"size": 0,
			"path": "clients/file-client/src/openapi.json",
			"byteSize": 16977,
			"content": "{\n  \"openapi\": \"3.0.3\",\n  \"info\": {\n    \"title\": \"File API\",\n    \"version\": \"0.1.0\",\n    \"description\": \"Upload and manage all files stored in epilot\"\n  },\n  \"tags\": [\n    {\n      \"name\": \"files\",\n      \"description\": \"Files\"\n    }\n  ],\n  \"security\": [\n    {\n      \"EpilotAuth\": []\n    }\n  ],\n  \"paths\": {\n    \"/v1/files/public/upload\": {\n      \"post\": {\n        \"operationId\": \"uploadFilePublic\",\n        \"summary\": \"uploadFilePublic\",\n        \"security\": [],\n        \"description\": \"Create pre-signed S3 URL to upload a file to keep temporarily (one week).\\n\\nUse the createFile operation to store file file permanently.\\n\",\n        \"tags\": [\n          \"files\"\n        ],\n        \"requestBody\": {\n          \"content\": {\n            \"application/json\": {\n              \"schema\": {\n                \"$ref\": \"#/components/schemas/UploadFilePayload\"\n              }\n            }\n          }\n        },\n        \"responses\": {\n          \"201\": {\n            \"description\": \"Pre-signed URL for POST / PUT upload\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"s3ref\": {\n                      \"allOf\": [\n                        {\n                          \"$ref\": \"#/components/schemas/S3Reference\"\n                        },\n                        {\n                          \"example\": {\n                            \"bucket\": \"epilot-files-prod\",\n                            \"key\": \"123/temp/4d689aeb-1497-4410-a9fe-b36ca9ac4389/document.pdf\"\n                          }\n                        }\n                      ]\n                    },\n                    \"upload_url\": {\n                      \"type\": \"string\",\n                      \"format\": \"url\",\n                      \"example\": \"https://epilot-files-prod.s3.eu-central-1.amazonaws.com/123/temp/4d689aeb-1497-4410-a9fe-b36ca9ac4389/document.pdf?AWSParams=123\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/v1/files/upload\": {\n      \"post\": {\n        \"operationId\": \"uploadFile\",\n        \"summary\": \"uploadFile\",\n        \"description\": \"Create pre-signed S3 URL to upload a file to keep temporarily (one week).\\n\\nUse the createFile operation to store file file permanently.\\n\",\n        \"tags\": [\n          \"files\"\n        ],\n        \"parameters\": [\n          {\n            \"name\": \"file_entity_id\",\n            \"in\": \"query\",\n            \"description\": \"file entity id\",\n            \"schema\": {\n              \"$ref\": \"#/components/schemas/FileEntityId\"\n            }\n          }\n        ],\n        \"requestBody\": {\n          \"content\": {\n            \"application/json\": {\n              \"schema\": {\n                \"$ref\": \"#/components/schemas/UploadFilePayload\",\n                \"type\": \"object\"\n              }\n            }\n          }\n        },\n        \"responses\": {\n          \"201\": {\n            \"description\": \"Pre-signed URL for POST / PUT upload\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"s3ref\": {\n                      \"allOf\": [\n                        {\n                          \"$ref\": \"#/components/schemas/S3Reference\"\n                        },\n                        {\n                          \"example\": {\n                            \"bucket\": \"epilot-files-prod\",\n                            \"key\": \"123/temp/4d689aeb-1497-4410-a9fe-b36ca9ac4389/document.pdf\"\n                          }\n                        }\n                      ]\n                    },\n                    \"upload_url\": {\n                      \"type\": \"string\",\n                      \"format\": \"url\",\n                      \"example\": \"https://epilot-files-prod.s3.eu-central-1.amazonaws.com/123/temp/4d689aeb-1497-4410-a9fe-b36ca9ac4389/document.pdf?AWSParams=123\"\n                    },\n                    \"public_url\": {\n                      \"description\": \"Returned only if file is permanent i.e. file_entity_id is passed\",\n                      \"type\": \"string\",\n                      \"format\": \"url\",\n                      \"example\": \"https://epilot-files-prod.s3.eu-central-1.amazonaws.com/123/4d689aeb-1497-4410-a9fe-b36ca9ac4389/document.pdf\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/v1/files\": {\n      \"post\": {\n        \"operationId\": \"saveFile\",\n        \"summary\": \"saveFile\",\n        \"description\": \"Create / Update a permanent File entity\\n\\nMakes file object permanent\\n\\nSaves metadata to file entity\\n\",\n        \"tags\": [\n          \"files\"\n        ],\n        \"requestBody\": {\n          \"content\": {\n            \"application/json\": {\n              \"schema\": {\n                \"$ref\": \"#/components/schemas/SaveFilePayload\"\n              }\n            }\n          }\n        },\n        \"responses\": {\n          \"201\": {\n            \"description\": \"Created File Entity\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"$ref\": \"#/components/schemas/FileEntity\"\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/v1/files/{id}/download\": {\n      \"get\": {\n        \"operationId\": \"downloadFile\",\n        \"summary\": \"downloadFile\",\n        \"description\": \"Generate pre-signed download S3 url for a file\",\n        \"tags\": [\n          \"files\"\n        ],\n        \"parameters\": [\n          {\n            \"name\": \"id\",\n            \"in\": \"path\",\n            \"required\": true,\n            \"schema\": {\n              \"$ref\": \"#/components/schemas/FileEntityId\"\n            }\n          },\n          {\n            \"name\": \"version\",\n            \"in\": \"query\",\n            \"description\": \"index of file version\",\n            \"schema\": {\n              \"type\": \"integer\",\n              \"default\": 0\n            }\n          },\n          {\n            \"name\": \"attachment\",\n            \"in\": \"query\",\n            \"description\": \"Controls the Content-Disposition header to control browser behaviour. Set to true to trigger download.\",\n            \"schema\": {\n              \"type\": \"boolean\",\n              \"default\": true\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Generated thumbnail image\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"download_url\": {\n                      \"type\": \"string\",\n                      \"format\": \"uri\",\n                      \"example\": \"https://epilot-files-prod.s3.eu-central-1.amazonaws.com/123/temp/4d689aeb-1497-4410-a9fe-b36ca9ac4389/document.pdf?AWSParams=123\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/v1/files:downloadS3\": {\n      \"post\": {\n        \"operationId\": \"downloadS3File\",\n        \"summary\": \"downloadS3File\",\n        \"description\": \"Generate pre-signed download S3 url for a file\",\n        \"tags\": [\n          \"files\"\n        ],\n        \"parameters\": [\n          {\n            \"name\": \"s3_key\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"schema\": {\n              \"type\": \"string\"\n            }\n          },\n          {\n            \"name\": \"s3_bucket\",\n            \"in\": \"query\",\n            \"required\": true,\n            \"schema\": {\n              \"type\": \"string\"\n            }\n          },\n          {\n            \"name\": \"attachment\",\n            \"in\": \"query\",\n            \"description\": \"Controls the Content-Disposition header to control browser behaviour. Set to true to trigger download.\",\n            \"schema\": {\n              \"type\": \"boolean\",\n              \"default\": true\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Generated thumbnail image\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"download_url\": {\n                      \"type\": \"string\",\n                      \"format\": \"uri\",\n                      \"example\": \"https://epilot-files-prod.s3.eu-central-1.amazonaws.com/123/temp/4d689aeb-1497-4410-a9fe-b36ca9ac4389/document.pdf?AWSParams=123\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/v1/files/{id}/preview\": {\n      \"get\": {\n        \"operationId\": \"previewFile\",\n        \"summary\": \"previewFile\",\n        \"description\": \"Generate thumbnail preview for a file entity\",\n        \"tags\": [\n          \"files\"\n        ],\n        \"parameters\": [\n          {\n            \"name\": \"id\",\n            \"in\": \"path\",\n            \"required\": true,\n            \"schema\": {\n              \"$ref\": \"#/components/schemas/FileEntityId\"\n            }\n          },\n          {\n            \"name\": \"version\",\n            \"in\": \"query\",\n            \"description\": \"index of file version\",\n            \"schema\": {\n              \"type\": \"integer\",\n              \"default\": 0\n            }\n          },\n          {\n            \"name\": \"w\",\n            \"in\": \"query\",\n            \"description\": \"width\",\n            \"schema\": {\n              \"type\": \"integer\"\n            }\n          },\n          {\n            \"name\": \"h\",\n            \"in\": \"query\",\n            \"description\": \"height\",\n            \"schema\": {\n              \"type\": \"integer\"\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Generated thumbnail image\",\n            \"content\": {\n              \"image/png\": {},\n              \"image/jpeg\": {}\n            }\n          }\n        }\n      }\n    },\n    \"/v1/files:previewS3\": {\n      \"post\": {\n        \"operationId\": \"previewS3File\",\n        \"summary\": \"previewS3File\",\n        \"description\": \"Generate thumbnail preview from an s3 reference for a file entity\",\n        \"tags\": [\n          \"files\"\n        ],\n        \"parameters\": [\n          {\n            \"name\": \"w\",\n            \"in\": \"query\",\n            \"description\": \"width\",\n            \"schema\": {\n              \"type\": \"integer\"\n            }\n          },\n          {\n            \"name\": \"h\",\n            \"in\": \"query\",\n            \"description\": \"height\",\n            \"schema\": {\n              \"type\": \"integer\"\n            }\n          }\n        ],\n        \"requestBody\": {\n          \"content\": {\n            \"application/json\": {\n              \"schema\": {\n                \"$ref\": \"#/components/schemas/S3Reference\"\n              }\n            }\n          }\n        },\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Generated thumbnail image\",\n            \"content\": {\n              \"image/png\": {},\n              \"image/jpeg\": {}\n            }\n          }\n        }\n      }\n    },\n    \"/v1/files/delete\": {\n      \"delete\": {\n        \"operationId\": \"deleteFile\",\n        \"summary\": \"deleteFile\",\n        \"description\": \"Delete file entity\",\n        \"tags\": [\n          \"files\"\n        ],\n        \"requestBody\": {\n          \"content\": {\n            \"application/json\": {\n              \"schema\": {\n                \"$ref\": \"#/components/schemas/DeleteFilePayload\"\n              }\n            }\n          }\n        },\n        \"responses\": {\n          \"200\": {\n            \"description\": \"File delete response\"\n          }\n        }\n      }\n    }\n  },\n  \"components\": {\n    \"securitySchemes\": {\n      \"EpilotAuth\": {\n        \"type\": \"http\",\n        \"scheme\": \"bearer\",\n        \"description\": \"Authorization header with epilot OAuth2 bearer token\",\n        \"bearerFormat\": \"JWT\"\n      }\n    },\n    \"schemas\": {\n      \"FileEntityId\": {\n        \"type\": \"string\",\n        \"example\": \"ef7d985c-2385-44f4-9c71-ae06a52264f8\"\n      },\n      \"FileEntity\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"_id\": {\n            \"$ref\": \"#/components/schemas/FileEntityId\"\n          },\n          \"filename\": {\n            \"type\": \"string\",\n            \"example\": \"document.pdf\"\n          },\n          \"access_control\": {\n            \"type\": \"string\",\n            \"default\": \"private\",\n            \"enum\": [\n              \"private\",\n              \"public-read\"\n            ]\n          },\n          \"public_url\": {\n            \"description\": \"Direct URL for file (public only if file access control is public-read)\",\n            \"type\": \"string\",\n            \"format\": \"url\",\n            \"example\": \"https://epilot-files-prod.s3.eu-central-1.amazonaws.com/123/4d689aeb-1497-4410-a9fe-b36ca9ac4389/document.pdf\"\n          },\n          \"type\": {\n            \"description\": \"Human readable type for file\",\n            \"type\": \"string\",\n            \"enum\": [\n              \"document\",\n              \"document_template\",\n              \"text\",\n              \"image\",\n              \"video\",\n              \"audio\",\n              \"spreadsheet\",\n              \"presentation\",\n              \"font\",\n              \"archive\",\n              \"application\",\n              \"unknown\"\n            ]\n          },\n          \"mime_type\": {\n            \"type\": \"string\",\n            \"description\": \"MIME type of the file\",\n            \"example\": \"application/pdf\"\n          },\n          \"size_bytes\": {\n            \"type\": \"integer\",\n            \"minimum\": 0,\n            \"description\": \"File size in bytes\"\n          },\n          \"versions\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"type\": \"object\",\n              \"properties\": {\n                \"s3ref\": {\n                  \"$ref\": \"#/components/schemas/S3Reference\"\n                }\n              }\n            }\n          }\n        }\n      },\n      \"UploadFilePayload\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"filename\": {\n            \"type\": \"string\",\n            \"example\": \"document.pdf\"\n          },\n          \"mime_type\": {\n            \"description\": \"MIME type of file\",\n            \"type\": \"string\",\n            \"example\": \"application/pdf\",\n            \"default\": \"application/octet-stream\"\n          }\n        },\n        \"required\": [\n          \"filename\"\n        ]\n      },\n      \"SaveFilePayload\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"s3ref\": {\n            \"$ref\": \"#/components/schemas/S3Reference\"\n          },\n          \"file_entity_id\": {\n            \"type\": \"string\",\n            \"description\": \"if passed, adds a new version to existing file entity\"\n          },\n          \"document_type\": {\n            \"type\": \"string\",\n            \"enum\": [\n              \"document\",\n              \"document_template\",\n              \"text\",\n              \"image\",\n              \"video\",\n              \"audio\",\n              \"spreadsheet\",\n              \"presentation\",\n              \"font\",\n              \"archive\",\n              \"application\",\n              \"unknown\"\n            ]\n          },\n          \"filename\": {\n            \"type\": \"string\",\n            \"example\": \"document.pdf\"\n          },\n          \"_tags\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"type\": \"string\"\n            }\n          },\n          \"access_control\": {\n            \"type\": \"string\",\n            \"default\": \"private\",\n            \"enum\": [\n              \"private\",\n              \"public-read\"\n            ]\n          }\n        },\n        \"required\": [\n          \"s3ref\"\n        ]\n      },\n      \"DeleteFilePayload\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"s3ref\": {\n            \"$ref\": \"#/components/schemas/S3Reference\"\n          }\n        },\n        \"required\": [\n          \"s3ref\"\n        ]\n      },\n      \"S3Reference\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"bucket\": {\n            \"type\": \"string\",\n            \"example\": \"epilot-files-prod\"\n          },\n          \"key\": {\n            \"type\": \"string\",\n            \"example\": \"123/4d689aeb-1497-4410-a9fe-b36ca9ac4389/document.pdf\"\n          }\n        },\n        \"required\": [\n          \"bucket\",\n          \"key\"\n        ]\n      },\n      \"FileItem\": {\n        \"allOf\": [\n          {\n            \"$ref\": \"#/components/schemas/S3Reference\"\n          },\n          {\n            \"type\": \"object\",\n            \"properties\": {\n              \"filename\": {\n                \"type\": \"string\",\n                \"example\": \"document.pdf\"\n              },\n              \"size_bytes\": {\n                \"type\": \"integer\",\n                \"example\": 1234\n              },\n              \"mime_type\": {\n                \"type\": \"string\",\n                \"example\": \"image/jpeg\"\n              }\n            }\n          }\n        ]\n      }\n    }\n  },\n  \"servers\": [\n    {\n      \"url\": \"https://file.sls.epilot.io\"\n    },\n    {\n      \"url\": \"https://file.sls.epilot.io\"\n    }\n  ]\n}\n"
		}
	},
	"Error": "buildIR: make ir: path \"/v1/files/public/upload\": post: responses: 201: contents: application/json: generate schema: field s3ref: allOf: schema type mismatch: object and ",
	"NotImplemented": [
		"unsupported content types"
	]
}