{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/dod-ccpo/atat-csp-orchestration"
		},
		"file": {
			"name": "atat_provisioning.yaml",
			"size": 0,
			"path": "provisioning/atat_provisioning.yaml",
			"byteSize": 24373,
			"content": "openapi: 3.0.2\ninfo:\n  description: \u003e-\n    This API is meant for provisioning resources in a target Cloud Environment in a vendor-agnostic fashion. By\n    implementing this API, vendors make it possible to automatically provision accounts via ATAT.\n\n    ## Portfolios\n\n    Portfolios represent a logical container for a set of cloud resources which are paid for by a Task Order and its\n    CLIN(s). The term is meant to be agnostic across CSPs. A Portfolio can be thought of as an account at the root of a \n    hierarchy. ATAT does not dictate structure within a Portfolio. Once a Portfolio has been provisioned a Mission Owner \n    is free to organize and secure resources to satisfy mission requirements.\n\n    ## Task Orders\n\n    Portfolios contain one or more *Task Orders* (TO), which in turn contain or more or *Contract Line Item Number*\n    (CLINs). Each have separate Periods of Performance (PoP) dates; CLIN PoP dates will be within the time frames of\n    the Task Order in which they belong.\n\n    ## Cost reporting\n\n    Provisioned resources incur costs with participating CSPs. Costs related to provisioned resources can\n    be attributed to specific CLINs. Actual and forecasted CSP costs can be reported by CLIN.\n  version: 0.3.0\n  title: ATAT CSP API\n  contact:\n    email: atat-dev+provisioning_api@ccpo.mil\ntags:\n  - name: access\n    description: \u003e-\n      Operations to manage access to provisioned Portfolios\n  - name: cost\n    description: \u003e-\n      Operations to query for actual and forecasted costs\n  - name: provisioning\n    description: \u003e-\n      Operations to manage provisioned Portfolios\npaths:\n  '/portfolios':\n    post:\n      tags:\n        - provisioning\n      summary: Adds a new Portfolio\n      security:\n        - oidc: [atat/write-portfolio]\n      description: Adds a new Portfolio to be provisioned, including Task Orders and Operators. Once provisioned, Operators can log in to the CSP and begin using provisioned resources and services, funded by the provided Task Order(s). See [#/info/description](#/info/description) and [#/components/schemas](#/components/schemas) for details of these constructs.\n      operationId: addPortfolio\n      parameters:\n        - name: X-Target-Impact-Level\n          description: \u003e-\n            Target Impact Level for this request. Optional header which allows an ATAT implementation to route a request to a\n            more specific environment if more than one is available at a given endpoint.\n          in: header\n          schema:\n            $ref: '#/components/schemas/ImpactLevel'\n        - name: X-Provision-Deadline\n          description: \u003e-\n            Deadline by which the ATAT client expects the Portfolio provisioning process to be complete. Actual values will not be dictated\n            by this specification.\n          in: header\n          schema:\n            type: string\n            format: date-time\n      requestBody:\n        description: A new Portfolio\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/Portfolio'\n      responses:\n        '200':\n          description: Portfolio fully provisioned\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Portfolio'\n        '202':\n          description: Provisioning request has been accepted\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ProvisioningStatus'\n          headers:\n            Location:\n              description: \u003e-\n                Endpoint which ATAT should poll to receive status updates for this provisioning job.\n                Data at this endpoint must be a valid ProvisioningStatus response.\n              schema:\n                type: string\n                example: \"https://csp.com/atat/provisioning/123456789/status\"\n        '400':\n          description: Invalid input\n  '/portfolios/{portfolioId}':\n    get:\n      tags:\n        - provisioning\n      summary: Gets an existing Portfolio\n      security:\n        - oidc: [atat/read-portfolio]\n      description: Returns a single existing Portfolio, including Task Orders and Operators\n      operationId: getPortfolioById\n      parameters:\n        - name: portfolioId\n          in: path\n          description: ID of the Portfolio\n          required: true\n          schema:\n            type: string\n        - name: X-Target-Impact-Level\n          description: \u003e-\n            Target Impact Level for this request. Optional header which allows an ATAT implementation to route a request to a\n            more specific environment if more than one is available at a given endpoint.\n          in: header\n          schema:\n            $ref: '#/components/schemas/ImpactLevel'\n      responses:\n        '200':\n          description: Portfolio successfully retrieved\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Portfolio'\n        '400':\n          description: Invalid ID supplied\n        '404':\n          description: Portfolio not found\n    patch:\n      tags:\n        - access\n      security:\n        - oidc: [atat/write-portfolio]\n      description: \u003e-\n        Updates an existing Portfolio. Currently limited to the `administrators` attribute which will add\n        administrators to an existing Portfolio. Note that this is a strictly additive operation; invitations\n        should be sent to all email addresses included in a request. It is expected that removal of access\n        will occur through native CSP mechanisms rather than via ATAT.\n\n        When an Operator included in this operation does not already have access to the Portfolio in the target\n        Cloud Environment and an invitation should be sent to that Operator's email address. ATAT clients should\n        not specify the `needs_reset` flag for Operators that do not already have access; however, ATAT\n        implementations must ignore the flag for such Operators who do not already have access.\n\n        When an Operator included in this operator already has access to the Portfolio in the target Cloud\n        Environment and the `needs_reset` attribute is set to `true`, their access should be reset (whether\n        via a token, password, or other vendor-specific means). When an Operator already has access to the\n        Portfolio in the target Cloud Environment and the `needs_reset` attribute is unspecified or `false`,\n        ATAT implementations must not make changes to the user's access nor perform any resets.\n      operationId: patchPortfolio\n      parameters:\n        - name: portfolioId\n          in: path\n          description: ID of the Portfolio\n          required: true\n          schema:\n            type: string\n        - name: X-Target-Impact-Level\n          description: \u003e-\n            Target Impact Level for this request. Optional header which allows an ATAT implementation to route a request to a\n            more specific environment if more than one is available at a given endpoint.\n          in: header\n          schema:\n            $ref: '#/components/schemas/ImpactLevel'\n        - name: X-Provision-Deadline\n          description: \u003e-\n            Deadline by which the ATAT client expects the Portfolio provisioning process to be complete. Actual values will not be dictated\n            by this specification.\n          in: header\n          schema:\n            type: string\n            format: date-time\n      requestBody:\n        description: A PortfolioPatch object\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/PortfolioPatch'\n      responses:\n        '200':\n          description: Portfolio successfully updated\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/PortfolioPatch'\n        '202':\n          description: Provisioning request has been accepted\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ProvisioningStatus'\n          headers:\n            Location:\n              description: \u003e-\n                Endpoint which ATAT should poll to receive status updates for this provisioning job.\n                Data at this endpoint must be a valid ProvisioningStatus response.\n              schema:\n                type: string\n                example: \"https://csp.com/atat/provisioning/123456789/status\"\n        '400':\n          description: Invalid ID supplied\n        '404':\n          description: Portfolio not found\n  '/portfolios/{portfolioId}/cost':\n    get:\n      tags:\n        - cost\n      summary: Returns cost data for a Portfolio, broken down by Task Order \u0026 CLINs\n      security:\n        - oidc: [atat/read-cost]\n      description: Queries CSP for actual or forecasted cost data across a Portfolio\n      operationId: getCostsByPortfolio\n      parameters:\n        - name: portfolioId\n          in: path\n          description: ID of the Portfolio\n          required: true\n          schema:\n            type: string\n        - name: start_date\n          in: query\n          description: Start date of the cost data request\n          required: true\n          schema:\n            type: string\n            format: date\n            example: \"2021-12-31\"\n        - name: end_date\n          in: query\n          description: End date of the cost data request\n          required: true\n          schema:\n            type: string\n            format: date\n            example: \"2026-12-31\"\n        - name: X-Target-Impact-Level\n          description: \u003e-\n            Target Impact Level for this request. Optional header which allows an ATAT implementation to route a request to a\n            more specific environment if more than one is available at a given endpoint.\n          in: header\n          schema:\n            $ref: '#/components/schemas/ImpactLevel'\n      responses:\n        '200':\n          description: Cost operation successful\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/CostResponseByPortfolio'\n              examples:\n                CostResponseActual:\n                  $ref: '#/components/examples/CostResponseByPortfolio'\n        '400':\n          description: Invalid ID or query parameters\n        '404':\n          description: Portfolio not found\n  '/portfolios/{portfolioId}/task-orders':\n    post:\n      tags:\n        - provisioning\n      summary: Adds a new Task Order (TO)\n      security:\n        - oidc: [atat/write-portfolio]\n      description: Adds a new Task Order to an existng Portfolio\n      operationId: addTaskOrder\n      parameters:\n        - name: portfolioId\n          in: path\n          description: ID of the Portfolio\n          required: true\n          schema:\n            type: string\n        - name: X-Target-Impact-Level\n          description: \u003e-\n            Target Impact Level for this request. Optional header which allows an ATAT implementation to route a request to a\n            more specific environment if more than one is available at a given endpoint.\n          in: header\n          schema:\n            $ref: '#/components/schemas/ImpactLevel'\n        - name: X-Provision-Deadline\n          description: \u003e-\n            Deadline by which the ATAT client expects the Portfolio provisioning process to be complete. Actual values will not be dictated\n            by this specification.\n          in: header\n          schema:\n            type: string\n            format: date-time\n      responses:\n        '200':\n          description: Successful operation\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/TaskOrder'\n        '202':\n          description: Provisioning request has been accepted\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/ProvisioningStatus'\n          headers:\n            Location:\n              description: \u003e-\n                Endpoint which ATAT should poll to receive status updates for this provisioning job.\n                Data at this endpoint must be a valid ProvisioningStatus response.\n              schema:\n                type: string\n                example: \"https://csp.com/atat/provisioning/123456789/status\"\n        '400':\n          description: Invalid ID supplied\n        '404':\n          description: Portfolio not found\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/TaskOrder'\n  '/portfolios/{portfolioId}/task-orders/{taskOrderNumber}/clins/{clin}/cost':\n    get:\n      tags:\n        - cost\n      summary: Returns cost data by Clin\n      security:\n        - oidc: [atat/read-cost]\n      description: Queries CSP for actual or forecasted cost data by Clin\n      operationId: getCostsByClin\n      parameters:\n        - name: portfolioId\n          in: path\n          description: ID of the Portfolio\n          required: true\n          schema:\n            type: string\n        - name: taskOrderNumber\n          in: path\n          description: task order number\n          required: true\n          schema:\n            type: string\n        - name: clin\n          in: path\n          description: contract line item number\n          required: true\n          schema:\n            type: string\n        - name: start_date\n          in: query\n          description: Start date of the cost data request\n          required: true\n          schema:\n            type: string\n            format: date\n            example: \"2021-12-31\"\n        - name: end_date\n          in: query\n          description: End date of the cost data request\n          required: true\n          schema:\n            type: string\n            format: date\n            example: \"2026-12-31\"\n        - name: X-Target-Impact-Level\n          description: \u003e-\n            Target Impact Level for this request. Optional header which allows an ATAT implementation to route a request to a\n            more specific environment if more than one is available at a given endpoint.\n          in: header\n          schema:\n            $ref: '#/components/schemas/ImpactLevel'\n      responses:\n        '200':\n          description: Cost operation successful\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/CostResponseByClin'\n              examples:\n                CostResponseActual:\n                  $ref: '#/components/examples/CostResponseByClin'\n        '400':\n          description: Invalid ID or query parameters\n        '404':\n          description: Portfolio not found\ncomponents:\n  schemas:\n    ProvisioningStatus:\n      type: object\n      description: \u003e-\n        Represents the status of a provisioning job submitted via POST /portfolios\n      properties:\n        provisioning_job_id:\n          type: string\n          description: The ID of the Provisioning job; used for retrieving status to inform end user\n          example: \"123456789\"\n        portfolio_id:\n            type: string\n            description: The ID of the Portfolio for which status is being returned\n        status:\n          type: string\n          enum:\n            - \"NOT_STARTED\"\n            - \"IN_PROGRESS\"\n            - \"COMPLETE\"\n            - \"FAILED\"\n    PortfolioPatch:\n      properties:\n        administrators:\n          type: array\n          items:\n            $ref: '#/components/schemas/Operator'\n    Portfolio:\n      allOf:\n        - $ref: '#/components/schemas/PortfolioPatch'\n      description: \u003e-\n        Logical container for a set of cloud resources which are paid for by a Task Order \u0026 its CLINS.\n      required:\n        - name\n        - task_orders\n        - administrators\n      properties:\n        name:\n          type: string\n          example: \"Sample Portfolio name\"\n        task_orders:\n          type: array\n          items:\n            allOf:\n              - $ref: '#/components/schemas/TaskOrder'\n        id:\n          description: \u003e-\n            Represents the unqiue ID of the Portfolio created by the vendor. In order to enable the ATAT UI to construct links back to the\n            provisioned environment, this should be the same ID generated internally for the vendor's Portfolio-equivalent construct.\n          type: string\n          readOnly: true\n          example: \"csp-portfolio-id-123\"\n        dashboard_link:\n          description: \u003e-\n            Represents a deep link to the Portfolio as represented in the vendor's dashboard. Allows ATAT to provide direct links to\n            a Mission Owner's Portfolio within the vendor's environment.\n          type: string\n          format: uri\n          example: \"https://vendor.com/account/csp-portfolio-id-123\"\n    TaskOrder:\n      type: object\n      description: \u003e-\n        A Task Order and CLINs used to pay for provisioned resources and services\n      required:\n        - task_order_number\n        - clins\n        - pop_start_date\n        - pop_end_date\n      properties:\n        task_order_number:\n          type: string\n          example: \"1234567891234\"\n        clins:\n          type: array\n          items:\n            $ref: '#/components/schemas/Clin'\n        pop_start_date:\n          description: Start of period of performance (for this Task Order)\n          type: string\n          format: date\n          example: \"2021-07-01\"\n        pop_end_date:\n          description: End of period of performance (for this Task Order)\n          type: string\n          format: date\n          example: \"2026-07-01\"\n    Clin:\n      description: Represents a CLIN in a Task Order\n      additionalProperties: false\n      properties:\n        clin_number:\n          description: Contract Line Item Number (CLIN), 0001 through 9999\n          type: string\n          pattern: '(?!^0{4}$)^\\d{4}$'\n        pop_start_date:\n          description: Start of period of performance (for this CLIN)\n          type: string\n          format: date\n          example: \"2021-07-01\"\n        pop_end_date:\n          description: End of period of performance (for this CLIN)\n          type: string\n          format: date\n          example: \"2022-07-01\"\n    Operator:\n      description: \u003e-\n        Represents an individual who should have access to a Portfolio in a target Cloud Environment.\n      properties:\n        email:\n          type: string\n          format: email\n          example: \"portfolio.admin@mail.mil\"\n        dod_id:\n          type: string\n          minLength: 10\n          maxLength: 10\n        needs_reset:\n          description: \u003e-\n            Flag which denotes whether the given Operator's access should be updated (password/token reset or other vendor-specific process)\n          type: boolean\n          default: false\n    ImpactLevel:\n      description: List of available Impact Levels for target Cloud Environments\n      type: string\n      enum:\n        - IL2\n        - IL4\n        - IL5\n        - IL6\n    CostResponseByClin:\n      description: \u003e-\n        Provides cost data in a format in accordance with the provided CostRequest. For any time periods for which\n        cost data has been generated, actual amounts should be provided. Otherwise, forecast data should be used\n        instead.\n      properties:\n        actual:\n          type: array\n          items:\n            $ref: '#/components/schemas/CostData'\n        forecast:\n          type: array\n          items:\n            $ref: '#/components/schemas/CostData'\n    CostResponseByPortfolio:\n      description: \u003e-\n        Provides cost data in a format in accordance with the provided CostRequest. For any time periods for which\n        cost data has been generated, actual amounts should be provided. Otherwise, forecast data should be used\n        instead. Broken down by each CLIN within each Task Order within the given Portfolio.\n      properties:\n        task_orders:\n          type: array\n          items:\n            properties:\n              task_order_number:\n                type: string\n              clins:\n                type: array\n                items:\n                  properties:\n                    clin_number:\n                      type: string\n                    actual:\n                      type: array\n                      items:\n                        $ref: '#/components/schemas/CostData'\n                    forecast:\n                      type: array\n                      items:\n                        $ref: '#/components/schemas/CostData'\n    CostData:\n      properties:\n        total:\n          type: string\n          description: Total cost (ACTUAL or FORECAST) for all included months in USD\n          example: \"12345.67\"\n        results:\n          type: array\n          items:\n            properties:\n              month:\n                type: string\n                example: \"2022-12\"\n              value:\n                type: string\n                description: Cost (ACTUAL or FORECAST) for the given months in USD\n  examples:\n    CostResponseByClin:\n      value:\n        actual:\n          total: \"50.00\"\n          results:\n            - month: \"2021-10\"\n              value: \"20.00\"\n            - month: \"2021-11\"\n              value: \"30.00\"\n    CostResponseByPortfolio:\n      value:\n        task_orders:\n          - task_order_number: \"1234567891234\"\n            clins:\n              - clin_number: \"0001\"\n                actual:\n                  - total: \"50.00\"\n                    results:\n                      - month: \"2021-12\"\n                        value: \"20.00\"\n                      - month: \"2022-01\"\n                        value: \"30.00\"\n                forecast:\n                  - total: \"100.00\"\n                    results:\n                      - month: \"2022-02\"\n                        value: \"100.00\"\n              - clin_number: \"0002\"\n                actual:\n                  - total: \"750.00\"\n                    results:\n                      - month: \"2021-12\"\n                        value: \"50.00\"\n                      - month: \"2022-01\"\n                        value: \"700.00\"\n                forecast:\n                  - total: \"1000.00\"\n                    results:\n                      - month: \"2022-02\"\n                        value: \"100.00\"\n                      - month: \"2022-03\"\n                        value: \"900.00\"\n  securitySchemes:\n    oidc:\n      description: \u003e-\n        Represents an OIDC configuration for an Identity Provider which will be managed by the ATAT client. ATAT\n        implementations should be configured to accept and validate tokens issued by it. Tokens will not contain\n        information or assertions about end-user identity and should purely be used as a means for authentication\n        of the ATAT client implementation and for authorization of that client's actions. ATAT servers must not\n        assume that any user identities specified in request bodies (such as Mission Owners or administrators)\n        can be authenticated using this identity provider and must only use this Identity Provider for the ATAT\n        CSP API.\n\n        ATAT implementations must leverage the OIDC discovery protocol using the provided URL and must handle\n        key rotation automatically.\n\n        ## Validation\n\n        Tokens may include an Audience and if present, ATAT servers must reject any token with an incorrect Audience;\n        however, ATAT servers must accept tokens without an Audience if otherwise valid. ATAT implementations must\n        not limit access to specific subjects and must accept a request from a client presenting valid, unexpired,\n        properly-scoped token. ATAT servers must ignore unrecognized attributes.\n\n        ## Discovery Configuration\n\n        The openIdConnectUrl below is meant for integration testing purposes only. It is expected to remain stable\n        but may change occasionally. When this occurs, the ATAT Team will coordinate with the community and update this\n        document as quickly as possible.\n      type: openIdConnect\n      openIdConnectUrl: https://cognito-idp-fips.us-gov-west-1.amazonaws.com/us-gov-west-1_2e6R3aYgi/.well-known/openid-configuration\nsecurity:\n  - oidc:\n      - atat/read-cost\n      - atat/read-portfolio\n      - atat/write-portfolio",
			"canonicalURL": "/github.com/dod-ccpo/atat-csp-orchestration@a5749abadf0620662d85c3af5bac4e5bf43a8b92/-/blob/provisioning/atat_provisioning.yaml",
			"externalURLs": [
				{
					"url": "https://github.com/dod-ccpo/atat-csp-orchestration/blob/a5749abadf0620662d85c3af5bac4e5bf43a8b92/provisioning/atat_provisioning.yaml",
					"serviceKind": "GITHUB"
				}
			]
		}
	},
	"Error": "buildIR: make ir: path \"/portfolios/{portfolioId}/task-orders\": post: requestBody: contents: media: \"application/json\": generate schema: field clins: item: field clin_number: string validator: pattern: error parsing regexp: invalid or unsupported Perl syntax: `(?!`",
	"NotImplemented": [
		"openIdConnect security"
	]
}