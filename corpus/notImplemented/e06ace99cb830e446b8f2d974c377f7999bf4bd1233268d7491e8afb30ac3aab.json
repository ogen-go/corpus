{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/NUAA-Open-Source/safeu-backend"
		},
		"file": {
			"name": "openapi.yaml",
			"size": 0,
			"path": "api/openapi.yaml",
			"byteSize": 28538,
			"content": "#   Copyright 2019 A2OS SafeU Dev Team\n#\n#   Licensed under the Apache License, Version 2.0 (the \"License\");\n#   you may not use this file except in compliance with the License.\n#   You may obtain a copy of the License at\n#\n#       http://www.apache.org/licenses/LICENSE-2.0\n#\n#   Unless required by applicable law or agreed to in writing, software\n#   distributed under the License is distributed on an \"AS IS\" BASIS,\n#   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n#   See the License for the specific language governing permissions and\n#   limitations under the License.\n\nopenapi: 3.0.0\ninfo:\n  title: A2OS SafeU\n  description: |\n    A2OS SafeU 项目 API 文档。\n  contact:\n    email: a2os-general@googlegroups.com\n  license:\n    name: Apache 2.0\n    url: http://www.apache.org/licenses/LICENSE-2.0.html\n  version: \"1.0.0-beta\"\nexternalDocs:\n  description: Find out more about A2OS SafeU backend\n  url: https://api.safeu.a2os.club\ntags:\n  - name: upload\n    description: Upload item(s) operations\n  - name: update\n    description: Update item(s) operations\n  - name: delete\n    description: delete item(s) operations\n  - name: download\n    description: Download item(s) operations\n  - name: validation\n    description: Validation operations\n  - name: miscellaneous\n    description: Miscellaneous operations\npaths:\n  /ping:\n    get:\n      tags:\n        - miscellaneous\n      summary: PING-PONG\n      operationId: ping\n      responses:\n        \"200\":\n          description: 节点正常\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  message:\n                    type: string\n                    description: 返回信息\n                    example: pong\n\n  /csrf:\n    get:\n      tags:\n        - miscellaneous\n      summary: CSRF 口令获得接口\n      operationId: getCSRFToken\n      responses:\n        \"200\":\n          description: 获得 CSRF 口令\n          headers:\n            X-CSRF-TOKEN:\n              description: CSRF 口令\n              schema:\n                type: string\n          content:\n            \"text/plain\":\n              schema:\n                type: string\n                description: 返回信息\n                example: IN HEADER\n\n  /v1/info/{retrieveCode}:\n    post:\n      tags:\n        - miscellaneous\n      summary: 文件（组）信息获取接口\n      operationId: getFileInfo\n      parameters:\n        - name: retrieveCode\n          in: path\n          description: 提取码\n          required: true\n          schema:\n            type: string\n        - name: X-CSRF-TOKEN\n          in: header\n          description: CSRF 口令\n          required: true\n          schema: \n            type: string\n      requestBody:\n        content:\n          \"application/json\":\n            schema:\n              type: object\n              properties:\n                user_token:\n                  type: string\n                  description: 文件所有者信息\n      responses:\n        \"200\":\n          description: 获得文件信息\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  down_count:\n                    type: integer\n                    format: int64\n                    description: 可下载次数\n                  expired_at:\n                    type: string\n                    format: date-time\n                    description: 文件到期时间\n                  is_public:\n                    type: boolean\n                    description: 文件是否加密\n        \"400\":\n          description: 无法获得请求参数\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"401\":\n          description: 认证失败\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n\n  /v1/upload/policy:\n    get:\n      tags:\n        - upload\n      summary: 上传策略请求\n      responses:\n        \"200\":\n          description: 成功获得上传策略\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  accessid:\n                    type: string\n                    description: 用户请求的accessid\n                  host:\n                    type: string\n                    description: 用户要往哪个域名发送上传请求\n                  expire:\n                    type: string\n                    description: 上传策略Policy失效时间，在服务端指定。失效时间之前都可以利用此Policy上传文件，无需每次上传都去服务端获取签名\n                  signature:\n                    type: string\n                    description: 对变量policy签名后的字符串\n                  policy:\n                    type: string\n                    description: 用户表单上传的策略（Policy），是经过base64编码过的字符串\n                  dir:\n                    type: string\n                    description: 上传路径\n                  callback:\n                    type: string\n                    description: 回调设置代码，采用base64编码\n\n  /v1/upload/callback:\n    post:\n      tags:\n        - upload\n      summary: 阿里云OSS回调用户文件信息，鉴权后返回结果由OSS转发给用户\n      responses:\n        \"200\":\n          description: authorization验证通过\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  uuid:\n                    type: string\n                    description: 文件uuid\n  \n  /v1/upload/finish:\n    post:\n      tags:\n        - upload\n      summary: 结束所有上传文件的上传操作\n      parameters:\n        - name: X-CSRF-TOKEN\n          in: header\n          description: CSRF 口令\n          required: true\n          schema: \n            type: string\n      requestBody:\n        content:\n          \"application/json\":\n            schema:\n              type: object\n              properties:\n                files:\n                  type: array\n                  items:\n                    type: string\n                    example: fe5305b4-e0c8-490b-b3dc-eb523e699a07\n                  description: 文件列表\n      responses:\n        \"200\":\n          description: 结束文件上传成功\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  owner:\n                    type: string\n                    description: 文件所有者信息\n                  recode:\n                    type: string\n                    description: 文件提取码\n\n  /v1/password/{retrieveCode}:\n    post:\n      tags:\n        - update\n      summary: 修改文件密码\n      operationId: changeFilePassword\n      parameters:\n        - name: retrieveCode\n          in: path\n          description: 提取码\n          required: true\n          schema:\n            type: string\n        - name: X-CSRF-TOKEN\n          in: header\n          description: CSRF 口令\n          required: true\n          schema: \n            type: string\n      requestBody:\n        content:\n          \"application/json\":\n            schema:\n              type: object\n              properties:\n                user_token:\n                  type: string\n                  description: 文件所有者信息\n                auth:\n                  type: string\n                  description: 哈希后的密码 如果为空 则取消设置密码\n\n      responses:\n        \"200\":\n          description: 成功修改文件密码\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  message:\n                    type: \"string\"\n                    example: ok\n                    description: 修改成功\n        \"401\":\n          description: 文件所有者信息不存在\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"500\":\n          description: 服务器错误\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n\n  /v1/recode/{retrieveCode}:\n    post:\n      tags:\n        - update\n      summary: 修改文件提取码\n      operationId: changeFileRetrieveCode\n      parameters:\n        - name: X-CSRF-TOKEN\n          in: header\n          description: CSRF 口令\n          required: true\n          schema: \n            type: string\n        - name: retrieveCode\n          in: path\n          description: 提取码\n          required: true\n          schema:\n            type: string\n      requestBody:\n        content:\n          \"application/json\":\n            schema:\n              type: object\n              properties:\n                user_token:\n                  type: string\n                  description: 文件所有者信息\n                new_re_code:\n                  type: string\n                  description: 新的提取码\n                auth:\n                  type: string\n                  description: 新的哈希过的密码 如果修改的文件此前有密码需要提供此字段\n      responses:\n        \"200\":\n          description: 成功修改文件提取码\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  message:\n                    type: \"string\"\n                    example: ok\n                    description: 修改成功\n        \"400\":\n          description: 提供字段不正确\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"401\":\n          description: 文件所有者信息不存在\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"500\":\n          description: 服务器错误\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n\n  /v1/expireTime/{retrieveCode}:\n    post:\n      tags:\n        - update\n      summary: 修改文件过期时间\n      operationId: changeFileExpireTime\n      parameters:\n        - name: X-CSRF-TOKEN\n          in: header\n          description: CSRF 口令\n          required: true\n          schema: \n            type: string\n        - name: retrieveCode\n          in: path\n          description: 提取码\n          required: true\n          schema:\n            type: string\n      requestBody:\n        content:\n          \"application/json\":\n            schema:\n              type: object\n              properties:\n                user_token:\n                  type: string\n                  description: 文件所有者信息\n                new_expire_time:\n                  type: number\n                  example: 1-24\n                  description: 文件新过期时间\n      responses:\n        \"200\":\n          description: 成功修改文件过期时间\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  message:\n                    type: \"string\"\n                    example: 2019-02-19T19:28:32+08:00\n                    description: 修改成功返回新的过期时间\n        \"400\":\n          description: 新的文件过期时间不正确\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"401\":\n          description: 文件所有者信息不存在\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"500\":\n          description: 服务器错误\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n\n  /v1/delete/{retrieveCode}:\n    post:\n      tags:\n        - delete\n      summary: 手动删除文件接口\n      operationId: deleteFileManual\n      parameters:\n        - name: X-CSRF-TOKEN\n          in: header\n          description: CSRF 口令\n          required: true\n          schema: \n            type: string\n        - name: retrieveCode\n          in: path\n          description: 提取码\n          required: true\n          schema:\n            type: string\n      requestBody:\n        content:\n          \"application/json\":\n            schema:\n              type: object\n              properties:\n                user_token:\n                  type: string\n                  description: 文件所有者信息\n      responses:\n        \"200\":\n          description: 成功修改删除文件\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  message:\n                    type: \"string\"\n                    example: ok\n                    description: 删除成功\n        \"401\":\n          description: 文件所有者信息不存在\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"500\":\n          description: 服务器错误\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n\n  /v1/downCount/{retrieveCode}:\n    post:\n      tags:\n        - update\n      summary: 修改文件下载次数\n      operationId: changeFileDownCount\n      parameters:\n        - name: X-CSRF-TOKEN\n          in: header\n          description: CSRF 口令\n          required: true\n          schema: \n            type: string\n        - name: retrieveCode\n          in: path\n          description: 提取码\n          required: true\n          schema:\n            type: string\n      requestBody:\n        content:\n          \"application/json\":\n            schema:\n              type: object\n              properties:\n                user_token:\n                  type: string\n                  description: 文件所有者信息\n                new_down_count:\n                  type: string\n                  description: 新的下载次数\n      responses:\n        \"200\":\n          description: 成功修改文件下载次数\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  message:\n                    type: \"string\"\n                    example: ok\n                    description: 修改成功\n        \"401\":\n          description: 文件所有者信息不存在\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"500\":\n          description: 服务器错误\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n  \n  /v1/minusDownCount/{retrieveCode}:\n    post:\n      tags:\n        - download\n      summary: 下载感知接口\n      operationId: downloadAwareness\n      parameters:\n        - name: X-CSRF-TOKEN\n          in: header\n          description: CSRF 口令\n          required: true\n          schema: \n            type: string\n        - name: retrieveCode\n          in: path\n          description: 提取码\n          required: true\n          schema:\n            type: string\n      requestBody:\n        content:\n          \"application/json\":\n            schema:\n              type: object\n              properties:\n                bucket:\n                  description: 文件所在 OSS 桶名\n                  type: string\n                path:\n                  description: 文件所在 OSS 桶中的绝对路径\n                  type: string\n      responses:\n        \"200\":\n          description: 成功接收下载信息\n          content:\n            \"text/plain\":\n              schema:\n                type: string\n                description: 数据操作（OK，MINUS，DELETED）\n        \"404\":\n          description: 无法找到资源\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"500\":\n          description: 服务器错误\n          content:\n            \"text/plain\":\n              schema:\n                type: string\n                description: 未知错误\n\n  /v1/item/{retrieveCode}:\n    post:\n      tags:\n        - download\n      summary: 获取下载/打包文件连接\n      operationId: downloadItem\n      parameters:\n        - name: X-CSRF-TOKEN\n          in: header\n          description: CSRF 口令\n          required: true\n          schema: \n            type: string\n        - name: Token\n          in: header\n          description: 临时认证口令\n          style: simple\n          required: true\n          schema:\n            type: string\n        - name: retrieveCode\n          in: path\n          description: 提取码\n          required: true\n          schema:\n            type: string\n      requestBody:\n        content:\n          \"application/json\":\n            schema:\n              $ref: \"#/components/schemas/PackRequest\"\n      responses:\n        \"200\":\n          description: 成功获取文件（组）下载链接\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  url:\n                    type: string\n                    description: 文件（组）下载链接\n        \"400\":\n          description: 无法获得文件列表\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"401\":\n          description: 认证失败\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"404\":\n          description: 无法找到资源/认证口令\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"410\":\n          description: 下载次数耗尽\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"500\":\n          description: 无法获取签名下载链接\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"503\":\n          description: 无法提供服务\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n\n  /v1/validation/{retrieveCode}:\n    post:\n      tags:\n        - validation\n      summary: 提取码认证接口\n      operationId: validateRC\n      parameters:\n        - name: X-CSRF-TOKEN\n          in: header\n          description: CSRF 口令\n          required: true\n          schema: \n            type: string\n        - name: retrieveCode\n          in: path\n          description: 提取码\n          required: true\n          schema:\n            type: string\n      requestBody:\n        content:\n          \"application/json\":\n            schema:\n              type: object\n              properties:\n                password:\n                  type: string\n                  description: 文件提取密码\n      responses:\n        \"200\":\n          description: 认证成功\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  token:\n                    type: string\n                    description: 临时认证口令\n                  items:\n                    $ref: \"#/components/schemas/ResponseItemGroup\"\n        \"401\":\n          description: 需要密码 / 密码认证失败\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"404\":\n          description: 无法通过该提取码找到文件\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n        \"500\":\n          description: 资源不可用\n          content:\n            \"application/json\":\n              schema:\n                type: object\n                properties:\n                  err_code:\n                    type: integer\n                    format: int64\n                    description: 错误码\n                  message:\n                    type: string\n                    description: 错误原因\n\ncomponents:\n  schemas:\n    ResponseItem:\n      type: object\n      description: 文件\n      properties:\n        name:\n          type: string\n          description: 存储单位 UUID 值\n        original_name:\n          type: string\n          description: 文件原名\n        down_count:\n          type: integer\n          format: int32\n          description: 可下载次数\n        type:\n          type: string\n          description: 文件类型\n        protocol:\n          type: string\n          description: OSS 下载协议\n        bucket:\n          type: string\n          description: 文件所在 OSS 桶名\n        endpoint:\n          type: string\n          description: OSS 地域路径\n        path:\n          type: string\n          description: 文件所在 OSS 桶中的绝对路径\n        expired_at:\n          type: string\n          format: date-time\n          description: 文件到期时间\n    ResponseItemGroup:\n      type: array\n      items:\n        $ref: \"#/components/schemas/ResponseItem\"\n      description: 文件组\n    ZipItem:\n      type: object\n      description: 待下载文件\n      properties:\n        protocol:\n          type: string\n          description: OSS 下载协议\n        bucket:\n          type: string\n          description: 文件所在 OSS 桶名\n        endpoint:\n          type: string\n          description: OSS 地域路径\n        path:\n          type: string\n          description: 文件所在 OSS 桶中的绝对路径\n        original_name:\n          type: string\n          description: 文件原名\n    PackRequest:\n      type: object\n      description: 打包/下载链接请求\n      properties:\n        full:\n          type: boolean\n          description: 是否为该提取码下的全部文件\n        items:\n          type: array\n          description: 待打包/下载文件\n          items:\n            $ref: \"#/components/schemas/ZipItem\"\n",
			"canonicalURL": "/github.com/NUAA-Open-Source/safeu-backend@1df8ff0ce8e88fdbd60657cf6acacae02ae890a0/-/blob/api/openapi.yaml",
			"externalURLs": [
				{
					"url": "https://github.com/NUAA-Open-Source/safeu-backend/blob/1df8ff0ce8e88fdbd60657cf6acacae02ae890a0/api/openapi.yaml",
					"serviceKind": "GITHUB"
				}
			]
		}
	},
	"Error": "notImplemented: path \"/csrf\": get: responses: 200: contents: unsupported content types: [text/plain]",
	"NotImplemented": [
		"unsupported content types"
	]
}