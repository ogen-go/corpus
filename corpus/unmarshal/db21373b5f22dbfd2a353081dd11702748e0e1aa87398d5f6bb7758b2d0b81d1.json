{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/tenzir/vast"
		},
		"file": {
			"name": "openapi.yaml",
			"size": 0,
			"path": "web/openapi/openapi.yaml",
			"byteSize": 10122,
			"content": "---\nopenapi: 3.0.0\ninfo:\n  title: VAST Rest API\n  version: 0.1\n  description: \"\\nThis API can be used to interact with a VAST Node in a RESTful manner.\\n\\nAll API requests must be authenticated with a valid token, which must be\\nsupplied in the `X-VAST-Token` request header. The token can be generated\\non the command-line using the `vast rest generate-token` command.\"\nservers:\n  - url: https://vast.example.com/api/v0\nsecurity:\n  - VastToken:\n      []\ncomponents:\n  securitySchemes:\n    VastToken:\n      type: apiKey\n      in: header\n      name: X-VAST-Token\npaths:\n  /export:\n    get:\n      summary: Export data\n      description: Export data from VAST according to a query. The query must be a valid expression in the VAST Query Language. (see https://vast.io/docs/understand/query-language)\n      parameters:\n        - in: query\n          name: expression\n          schema:\n            type: string\n          required: true\n          default: A query matching every event.\n          description: The query expression to execute.\n          example: :addr in 10.42.0.0/16\n        - in: query\n          name: limit\n          schema:\n            type: integer\n          required: false\n          default: 50\n          description: Maximum number of returned events\n          example: 3\n      responses:\n        200:\n          description: The result data.\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  num_events:\n                    type: integer\n                  version:\n                    type: string\n                  events:\n                    type: array\n                    items: object\n                example:\n                  version: v2.3.0-169-ge42a9652e5-dirty\n                  events:\n                    - \"{\\\"timestamp\\\": \\\"2011-08-14T05:38:55.549713\\\", \\\"flow_id\\\": 929669869939483, \\\"pcap_cnt\\\": null, \\\"vlan\\\": null, \\\"in_iface\\\": null, \\\"src_ip\\\": \\\"147.32.84.165\\\", \\\"src_port\\\": 138, \\\"dest_ip\\\": \\\"147.32.84.255\\\", \\\"dest_port\\\": 138, \\\"proto\\\": \\\"UDP\\\", \\\"event_type\\\": \\\"netflow\\\", \\\"community_id\\\": null, \\\"netflow\\\": {\\\"pkts\\\": 2, \\\"bytes\\\": 486, \\\"start\\\": \\\"2011-08-12T12:53:47.928539\\\", \\\"end\\\": \\\"2011-08-12T12:53:47.928552\\\", \\\"age\\\": 0}, \\\"app_proto\\\": \\\"failed\\\"}\"\n                    - \"{\\\"timestamp\\\": \\\"2011-08-12T13:00:36.378914\\\", \\\"flow_id\\\": 269421754201300, \\\"pcap_cnt\\\": 22569, \\\"vlan\\\": null, \\\"in_iface\\\": null, \\\"src_ip\\\": \\\"147.32.84.165\\\", \\\"src_port\\\": 1027, \\\"dest_ip\\\": \\\"74.125.232.202\\\", \\\"dest_port\\\": 80, \\\"proto\\\": \\\"TCP\\\", \\\"event_type\\\": \\\"http\\\", \\\"community_id\\\": null, \\\"http\\\": {\\\"hostname\\\": \\\"cr-tools.clients.google.com\\\", \\\"url\\\": \\\"/service/check2?appid=%7B430FD4D0-B729-4F61-AA34-91526481799D%7D\u0026appversion=1.3.21.65\u0026applang=\u0026machine=0\u0026version=1.3.21.65\u0026osversion=5.1\u0026servicepack=Service%20Pack%202\\\", \\\"http_port\\\": null, \\\"http_user_agent\\\": \\\"Google Update/1.3.21.65;winhttp\\\", \\\"http_content_type\\\": null, \\\"http_method\\\": \\\"GET\\\", \\\"http_refer\\\": null, \\\"protocol\\\": \\\"HTTP/1.1\\\", \\\"status\\\": null, \\\"redirect\\\": null, \\\"length\\\": 0}, \\\"tx_id\\\": 0}\"\n                    - \"{\\\"timestamp\\\": \\\"2011-08-14T05:38:55.549713\\\", \\\"flow_id\\\": 929669869939483, \\\"pcap_cnt\\\": null, \\\"vlan\\\": null, \\\"in_iface\\\": null, \\\"src_ip\\\": \\\"147.32.84.165\\\", \\\"src_port\\\": 138, \\\"dest_ip\\\": \\\"147.32.84.255\\\", \\\"dest_port\\\": 138, \\\"proto\\\": \\\"UDP\\\", \\\"event_type\\\": \\\"netflow\\\", \\\"community_id\\\": null, \\\"netflow\\\": {\\\"pkts\\\": 2, \\\"bytes\\\": 486, \\\"start\\\": \\\"2011-08-12T12:53:47.928539\\\", \\\"end\\\": \\\"2011-08-12T12:53:47.928552\\\", \\\"age\\\": 0}, \\\"app_proto\\\": \\\"failed\\\"}\"\n                  num_events: 3\n        401:\n          description: Not authenticated.\n        422:\n          description: Invalid query string or invalid limit.\n    post:\n      summary: Export data\n      description: Export data from VAST according to a query. The query must be a valid expression in the VAST Query Language. (see https://vast.io/docs/understand/query-language)\n      requestBody:\n        description: Request parameters\n        required: false\n        content:\n          application/json:\n            schema:\n              type: object\n              properties:\n                expression:\n                  type: string\n                limit:\n                  type: integer\n      responses:\n        200:\n          description: The result data.\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  num_events:\n                    type: integer\n                  version:\n                    type: string\n                  events:\n                    type: array\n                    items: object\n                example:\n                  version: v2.3.0-169-ge42a9652e5-dirty\n                  events:\n                    - \"{\\\"timestamp\\\": \\\"2011-08-14T05:38:55.549713\\\", \\\"flow_id\\\": 929669869939483, \\\"pcap_cnt\\\": null, \\\"vlan\\\": null, \\\"in_iface\\\": null, \\\"src_ip\\\": \\\"147.32.84.165\\\", \\\"src_port\\\": 138, \\\"dest_ip\\\": \\\"147.32.84.255\\\", \\\"dest_port\\\": 138, \\\"proto\\\": \\\"UDP\\\", \\\"event_type\\\": \\\"netflow\\\", \\\"community_id\\\": null, \\\"netflow\\\": {\\\"pkts\\\": 2, \\\"bytes\\\": 486, \\\"start\\\": \\\"2011-08-12T12:53:47.928539\\\", \\\"end\\\": \\\"2011-08-12T12:53:47.928552\\\", \\\"age\\\": 0}, \\\"app_proto\\\": \\\"failed\\\"}\"\n                    - \"{\\\"timestamp\\\": \\\"2011-08-12T13:00:36.378914\\\", \\\"flow_id\\\": 269421754201300, \\\"pcap_cnt\\\": 22569, \\\"vlan\\\": null, \\\"in_iface\\\": null, \\\"src_ip\\\": \\\"147.32.84.165\\\", \\\"src_port\\\": 1027, \\\"dest_ip\\\": \\\"74.125.232.202\\\", \\\"dest_port\\\": 80, \\\"proto\\\": \\\"TCP\\\", \\\"event_type\\\": \\\"http\\\", \\\"community_id\\\": null, \\\"http\\\": {\\\"hostname\\\": \\\"cr-tools.clients.google.com\\\", \\\"url\\\": \\\"/service/check2?appid=%7B430FD4D0-B729-4F61-AA34-91526481799D%7D\u0026appversion=1.3.21.65\u0026applang=\u0026machine=0\u0026version=1.3.21.65\u0026osversion=5.1\u0026servicepack=Service%20Pack%202\\\", \\\"http_port\\\": null, \\\"http_user_agent\\\": \\\"Google Update/1.3.21.65;winhttp\\\", \\\"http_content_type\\\": null, \\\"http_method\\\": \\\"GET\\\", \\\"http_refer\\\": null, \\\"protocol\\\": \\\"HTTP/1.1\\\", \\\"status\\\": null, \\\"redirect\\\": null, \\\"length\\\": 0}, \\\"tx_id\\\": 0}\"\n                    - \"{\\\"timestamp\\\": \\\"2011-08-14T05:38:55.549713\\\", \\\"flow_id\\\": 929669869939483, \\\"pcap_cnt\\\": null, \\\"vlan\\\": null, \\\"in_iface\\\": null, \\\"src_ip\\\": \\\"147.32.84.165\\\", \\\"src_port\\\": 138, \\\"dest_ip\\\": \\\"147.32.84.255\\\", \\\"dest_port\\\": 138, \\\"proto\\\": \\\"UDP\\\", \\\"event_type\\\": \\\"netflow\\\", \\\"community_id\\\": null, \\\"netflow\\\": {\\\"pkts\\\": 2, \\\"bytes\\\": 486, \\\"start\\\": \\\"2011-08-12T12:53:47.928539\\\", \\\"end\\\": \\\"2011-08-12T12:53:47.928552\\\", \\\"age\\\": 0}, \\\"app_proto\\\": \\\"failed\\\"}\"\n                  num_events: 3\n        401:\n          description: Not authenticated.\n        422:\n          description: Invalid query string or invalid limit.\n  /query/new:\n    post:\n      summary: Create new query\n      description: Create a new export query in VAST\n      parameters:\n        - in: query\n          name: expression\n          schema:\n            type: string\n            example: :addr in 10.42.0.0/16\n          required: true\n          description: Query string.\n      responses:\n        200:\n          description: Success.\n          content: application/json\n          schema:\n            type: object\n            example:\n              id: c91019bf-21fe-4999-8323-4d28aeb111ab\n            properties:\n              id:\n                type: string\n        401:\n          description: Not authenticated.\n        422:\n          description: Invalid expression or invalid lifetime.\n  /query/{id}/next:\n    get:\n      summary: Get additional query results\n      description: Return `n` additional results from the specified query.\n      parameters:\n        - in: path\n          name: id\n          schema:\n            type: string\n          required: true\n          example: e84308a2-1ba4-4559-9e0f-597dfea4fd3e\n          description: The query ID.\n        - in: query\n          name: n\n          schema:\n            type: integer\n          required: false\n          example: 10\n          description: Maximum number of returned events\n      responses:\n        200:\n          description: Success.\n          content: application/json\n          schema:\n            type: object\n            properties:\n              position:\n                type: integer\n                description: The total number of events that has been returned by previous calls to this endpoint.\n              events:\n                type: array\n                items: object\n                description: The returned events.\n            example:\n              position: 20\n              events:\n                - ts: 2009-11-18T22:11:04.011822\n                  uid: iKxhjl8i1n3\n                  id.orig_h: 192.168.1.103\n                - ts: 2009-11-18T22:13:38.992072\n                  uid: wsB2v2jcIXa\n                  id.orig_h: 192.168.1.103\n        401:\n          description: Not authenticated.\n        422:\n          description: Invalid arguments.\n  /status:\n    get:\n      summary: Return current status\n      description: Returns the current status of the whole node.\n      parameters:\n        - in: query\n          name: component\n          schema:\n            type: string\n          required: false\n          description: If specified, return the status for that component only.\n          example: index\n        - in: query\n          name: verbosity\n          schema:\n            type: string\n            enum:\n              - info\n              - detailed\n              - debug\n          default: info\n          required: false\n          description: The verbosity level of the status response.\n          example: detailed\n      responses:\n        200:\n          description: OK.\n          content:\n            application/json:\n              schema:\n                type: dict\n              example:\n                catalog:\n                  num-partitions: 7092\n                  memory-usage: 52781901584\n                version:\n                  VAST: v2.3.0-rc3-32-g8529a6c43f\n        401:\n          description: Not authenticated.\n",
			"canonicalURL": "/github.com/tenzir/vast@2e320bf830fa1dbde97569205c7122c7e79ee94c/-/blob/web/openapi/openapi.yaml",
			"externalURLs": [
				{
					"url": "https://github.com/tenzir/vast/blob/2e320bf830fa1dbde97569205c7122c7e79ee94c/web/openapi/openapi.yaml",
					"serviceKind": "GITHUB"
				}
			]
		}
	},
	"Error": "unmarshal: yaml: unmarshal errors:\n  yaml: line 54: cannot unmarshal !!str `object` into ogen.Schema; yaml: line 95: cannot unmarshal !!str `object` into ogen.Schema; yaml: line 122: cannot unmarshal !!str `applica...` into map[string]ogen.Media; yaml: line 156: cannot unmarshal !!str `applica...` into map[string]ogen.Media"
}