{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/JHUAPL/PINE"
		},
		"file": {
			"name": "openapi.yaml",
			"size": 0,
			"path": "backend/pine/backend/pipelines/openapi.yaml",
			"byteSize": 23456,
			"content": "# (C) 2021 The Johns Hopkins University Applied Physics Laboratory LLC.\n\nopenapi: \"3.0.2\"\n\nsecurity:\n  - cookieAuth: []\n  - eveBasicAuth: []\n  - vegasBearerAuth: []\n\ntags:\n  - name: pipelines\n    description: Operations in the \"pipelines\" blueprint.\n\ncomponents:\n\n  schemas:\n\n    Classifier:\n      allOf:\n        - $ref: \"../api/components.yaml#/schemas/EveBaseWithVersion\"\n        - type: object\n          properties:\n            _id:\n              type: string\n            _created:\n              type: string\n              format: date-time\n            _updated:\n              type: string\n              format: date-time\n            annotated_document_count:\n              type: integer\n            collection_id:\n              type: string\n            labels:\n              type: array\n              items:\n                type: string\n            overlap:\n              type: number\n              format: double\n            parameters:\n              type: object\n              additionalProperties: {}\n            pipeline_id:\n              type: string\n            train_every:\n              type: integer\n\n    PipelineJobRequest:\n      description: The job request data submitted to pipelines.\n      type: object\n      properties:\n        job_id:\n          description: The ID of this pipeline job.\n          type: string\n        job_queue:\n          type: string\n        job_type:\n          type: string\n        job_data:\n          type: object\n          properties:\n            framework:\n              type: string\n            type:\n              description: The type of job.\n              type: string\n            classifier_id:\n              type: string\n              nullable: true\n          additionalProperties:\n            description: Any additional job parameters.\n\n    PipelineJob:\n      type: object\n      properties:\n        job_id:\n          type: string\n        job_request:\n          $ref: \"#/components/schemas/PipelineJobRequest\"\n\n    PipelineOrClassifierStatus:\n      allOf:\n        - $ref: \"#/components/schemas/PipelineJob\"\n        - type: object\n          properties:\n            service_details:\n              description: Information about the pipeline service.\n              type: object\n              properties:\n                channel:\n                  type: string\n                framework:\n                  type: string\n                framework_types:\n                  type: array\n                  items:\n                    type: string\n                name:\n                  type: string\n                version:\n                  type: string\n                  format: version\n            job_response:\n              description: The job request data received from pipelines.\n              type: object\n              properties:\n                pipeline_name:\n                  type: string\n                eve_entry_point:\n                  type: string\n                model_dir:\n                  type: string\n                  format: path\n                classifier:\n                  description: Status of the classifier.\n                  type: object\n                has_trained:\n                  description: Whether the classifier has trained.\n                  type: boolean\n                classifier_id:\n                  description: Will not be present for pipeline status.\n                  type: string\n                  nullable: true\n                classifier_class:\n                  description: Python class for this classifier.\n                  type: string\n\n    PipelineTrainParameters:\n      type: object\n      properties:\n        model_name:\n          description: Optional name to save the model for future reference.\n          type: string\n          default: auto-trained\n        async:\n          description: \u003e\n            Whether this job should be asynchronous or not.  If asynchronous, the job response will\n            not be returned and the caller will have to query for running jobs and then get the\n            job results when it is finished.\n          type: boolean\n          default: false\n        timeout_in_s:\n          description: \u003e\n            For _synchronous_ requests: this is the amount of time, in seconds,  that this call will\n            wait before giving up.  For _asynchronous_ requests: this is the amount of time, in\n            seconds,  that the job results will be available for querying after completion of the\n            job before being removed.  If a value is not provided, a default value of 36000 seconds\n            will be used.  0 will wait indefinitely/not expire.\n          type: integer\n          default: 36000\n\n    PipelinePredictParameters:\n      description: Either document_ids or texts must be given and non-empty.\n      type: object\n      properties:\n        document_ids:\n          description: IDs of documents to predict annotations for.\n          type: array\n          items:\n            type: string\n          default: []\n        texts:\n          description: Text of documents to predict annotations for.\n          type: array\n          items:\n            type: string\n          default: []\n        async:\n          description: \u003e\n            Whether this job should be asynchronous or not.  If asynchronous, the job response will\n            not be returned and the caller will have to query for running jobs and then get the\n            job results when it is finished.\n          type: boolean\n          default: false\n        timeout_in_s:\n          description: \u003e\n            For _synchronous_ requests: this is the amount of time, in seconds,  that this call will\n            wait before giving up.  For _asynchronous_ requests: this is the amount of time, in\n            seconds,  that the job results will be available for querying after completion of the\n            job before being removed.  If a value is not provided, a default value of 36000 seconds\n            will be used.  0 will wait indefinitely/not expire.\n          type: integer\n          default: 36000\n\n    PipelineDocumentPredictions:\n      type: object\n      properties:\n        doc:\n          description: Document-level annotations.\n          type: array\n          items:\n            description: Annotation label.\n            type: string\n          example: [label1, label2]\n        ner:\n          description: NER annotations. [startIndex, endIndex, label].\n          type: array\n          items:\n            type: array\n            items:\n              oneOf:\n                - type: string\n                - type: integer\n          example: [5, 10, label1]\n\n    PipelinePredictions:\n      allOf:\n        - $ref: \"#/components/schemas/PipelineJob\"\n        - description: Pipeline predictions and other job information.\n          type: object\n          properties:\n            job_response:\n              description: \u003e\n                For _synchronous_ requests: this will hold the prediction job results.  For\n                _asynchronous_ requests: this will be null and can later be retrieved by getting\n                the job results..\n              type: object\n              properties:\n                documents_by_id:\n                  description: Predictions in a mapping from document ID to annotations.\n                  type: object\n                  additionalProperties:\n                    $ref: \"#/components/schemas/PipelineDocumentPredictions\"\n                texts:\n                  description: Predictions for manual texts in the same order as they were in the input.\n                  type: array\n                  items:\n                    $ref: \"#/components/schemas/PipelineDocumentPredictions\"\n\npaths:\n\n  /pipelines:\n    get:\n      summary: Get Pipelines\n      description: |\n        Get all pipelines.\n        \n        Example: `curl -X GET http://localhost:5000/pipelines/\n                  --cookie session.cookie`\n      operationId: pipelines_get_all\n      tags: [pipelines]\n      responses:\n        \"200\":\n          description: Successfully got pipelines.\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  _items:\n                    type: array\n                    items:\n                      $ref: \"../api/components.yaml#/schemas/Pipeline\"\n                  _links:\n                    $ref: \"../api/components.yaml#/schemas/EveLinks\"\n        \"401\":\n          $ref: \"../api/components.yaml#/responses/NotAuthorized\"\n        default:\n          $ref: \"../api/components.yaml#/responses/UnexpectedServerError\"\n\n  /pipelines/by_id/{pipeline_id}:\n    get:\n      summary: Get Pipeline\n      description: |\n        Get the pipeline with the given ID.\n        \n        Example: `curl -X GET http://localhost:5000/pipelines/by_id/5babb6ee4eb7dd2c39b9671f\n                  --cookie session.cookie -v`\n      operationId: pipelines_get\n      tags: [pipelines]\n      parameters:\n        - $ref: \"../api/components.yaml#/parameters/pipelineIdParam\"\n      responses:\n        \"200\":\n          description: Successfully got specified pipeline.\n          content:\n            application/json:\n              schema:\n                $ref: \"../api/components.yaml#/schemas/Pipeline\"\n        \"401\":\n          $ref: \"../api/components.yaml#/responses/NotAuthorized\"\n        \"404\":\n          $ref: \"../api/components.yaml#/responses/PipelineNotFound\"\n        default:\n          $ref: \"../api/components.yaml#/responses/UnexpectedServerError\"\n\n  /pipelines/classifiers/by_collection_id/{collection_id}:\n    get:\n      summary: Get Collection Classifier\n      description: |\n        Get the classifier information for a collection.\n        \n        Example: `curl -X GET http://localhost:5000/pipelines/classifiers/by_collection_id/60db2cacdbfddb3ca87c845d\n                  --cookie session.cookie`\n      operationId: pipelines_get_collection_classifier\n      tags: [pipelines]\n      parameters:\n        - $ref: \"../api/components.yaml#/parameters/collectionIdParam\"\n      responses:\n        \"200\":\n          description: Successfully found collection and got information.\n          content:\n            application/json:\n              schema:\n                $ref: \"#/components/schemas/Classifier\"\n        \"401\":\n          $ref: \"../api/components.yaml#/responses/NotAuthorized\"\n        \"404\":\n          $ref: \"../api/components.yaml#/responses/CollectionNotFound\"\n        default:\n          $ref: \"../api/components.yaml#/responses/UnexpectedServerError\"\n\n  /pipelines/metrics:\n    get:\n      summary: Get Collection Metrics\n      description: |\n        Get metrics for all available collections.\n        \n        Example: `curl -X GET http://localhost:5000/pipelines/metrics\n                  --cookie session.cookie`\n      operationId: pipelines_get_metrics\n      tags: [pipelines]\n      responses:\n        \"200\":\n          description: Successfully got metrics.\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  _items:\n                    type: array\n                    items:\n                      $ref: \"../api/components.yaml#/schemas/CollectionMetric\"\n                  _links:\n                    $ref: \"../api/components.yaml#/schemas/EveLinks\"\n        \"401\":\n          $ref: \"../api/components.yaml#/responses/NotAuthorized\"\n        default:\n          $ref: \"../api/components.yaml#/responses/UnexpectedServerError\"\n\n  /pipelines/metrics/by_classifier_id/{classifier_id}:\n    get:\n      summary: Get Classifier Metrics\n      description: |\n        Get metric by classifier id.\n        \n        Example: `curl -X GET http://localhost:5000/pipelines/metrics/by_classifier_id/60df138b3f8fa7b2e1445bd8\n                  --cookie session.cookie`\n      operationId: pipelines_get_classifier_metrics\n      tags: [pipelines]\n      parameters:\n        - $ref: \"../api/components.yaml#/parameters/classifierIdParam\"\n      responses:\n        \"200\":\n          description: Successfully got metric(s).\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  _items:\n                    type: array\n                    items:\n                      $ref: \"../api/components.yaml#/schemas/CollectionMetric\"\n                  _links:\n                    $ref: \"../api/components.yaml#/schemas/EveLinks\"\n        \"401\":\n          $ref: \"../api/components.yaml#/responses/NotAuthorized\"\n        \"404\":\n          $ref: \"../api/components.yaml#/responses/ClassifierNotFound\"\n        default:\n          $ref: \"../api/components.yaml#/responses/UnexpectedServerError\"\n\n  /pipelines/next_document/by_classifier_id/{classifier_id}:\n    get:\n      summary: Get Next Document to Annotate\n      description: |\n        Get the next document id to annotate based on classifier id (or null if no un-annotated\n        documents).\n        \n        Example: `curl -X GET http://localhost:5000/pipelines/next_document/by_classifier_id/60df138b3f8fa7b2e1445bd8\n                  --cookie session.cookie`\n      operationId: pipelines_get_next_document\n      tags: [pipelines]\n      parameters:\n        - $ref: \"../api/components.yaml#/parameters/classifierIdParam\"\n      responses:\n        \"200\":\n          description: Got ID of next document to annotate, or null if all are complete.\n          content:\n            application/json:\n              schema:\n                type: string\n                nullable: true\n        \"401\":\n          $ref: \"../api/components.yaml#/responses/NotAuthorized\"\n        \"404\":\n          $ref: \"../api/components.yaml#/responses/ClassifierNotFound\"\n        default:\n          $ref: \"../api/components.yaml#/responses/UnexpectedServerError\"\n\n  /pipelines/next_document/by_classifier_id/{classifier_id}/{doc_id}:\n    post:\n      summary: Advance Next Document\n      description: |\n        Advance to next document by marking the given one as annotated.\n        \n        Example: `curl -X POST http://localhost:5000/pipelines/next_document/by_classifier_id/60df138b3f8fa7b2e1445bd8/60df13d73f8fa7b2e1445bdd\n                  --cookie session.cookie`\n      \n        This will still give you a valid response with an invalid document ID.\n      operationId: pipelines_advance_next_document\n      tags: [pipelines]\n      parameters:\n        - $ref: \"../api/components.yaml#/parameters/classifierIdParam\"\n        - $ref: \"../api/components.yaml#/parameters/docIdParam\"\n      responses:\n        \"200\":\n          description: Complete annotations on document.\n          content:\n            application/json:\n              schema:\n                type: object\n                properties:\n                  body:\n                    type: object\n                    nullable: true\n                  success:\n                    type: boolean\n                  trained:\n                    type: boolean\n        \"401\":\n          $ref: \"../api/components.yaml#/responses/NotAuthorized\"\n        \"404\":\n          $ref: \"../api/components.yaml#/responses/ClassifierNotFound\"\n        default:\n          $ref: \"../api/components.yaml#/responses/UnexpectedServerError\"\n\n  /pipelines/status/{pipeline_id}:\n    get:\n      summary: Get Pipeline Status\n      description: |\n        Get the status of the pipeline with the given ID.\n        \n        Example: `curl -X GET http://localhost:5000/pipelines/status/60df138b3f8fa7b2e1445bd8\n                  --cookie session.cookie`\n      operationId: pipelines_get_status\n      tags: [pipelines]\n      parameters:\n        - $ref: \"../api/components.yaml#/parameters/pipelineIdParam\"\n      responses:\n        \"200\":\n          description: Returns the status for the given pipeline.\n          content:\n            application/json:\n              schema:\n                $ref: \"#/components/schemas/PipelineOrClassifierStatus\"\n        \"401\":\n          $ref: \"../api/components.yaml#/responses/NotAuthorized\"\n        \"404\":\n          $ref: \"../api/components.yaml#/responses/PipelineNotFound\"\n        default:\n          $ref: \"../api/components.yaml#/responses/UnexpectedServerError\"\n\n  /pipelines/classifiers/status/{classifier_id}:\n    get:\n      summary: Get Classifier Status\n      description: |\n        Get the status of the classifier with the given ID.\n        \n        Example: `curl -X GET http://localhost:5000/pipelines/classifiers/status/60df138b3f8fa7b2e1445bd8\n                  --cookie session.cookie`\n      operationId: pipelines_get_classifier_status\n      tags: [pipelines]\n      parameters:\n        - $ref: \"../api/components.yaml#/parameters/classifierIdParam\"\n      responses:\n        \"200\":\n          description: Returns the status for the given classifier.\n          content:\n            application/json:\n              schema:\n                $ref: \"#/components/schemas/PipelineOrClassifierStatus\"\n        \"401\":\n          $ref: \"../api/components.yaml#/responses/NotAuthorized\"\n        \"404\":\n          $ref: \"../api/components.yaml#/responses/ClassifierNotFound\"\n        default:\n          $ref: \"../api/components.yaml#/responses/UnexpectedServerError\"\n\n  /pipelines/running_jobs/{classifier_id}:\n    get:\n      summary: Get Classifier Running Jobs\n      description: |\n        Get any currently running jobs of the classifier with the given ID.\n        \n        Example: `curl -X GET http://localhost:5000/pipelines/running_jobs/60df138b3f8fa7b2e1445bd8\n                  --cookie session.cookie`\n      operationId: pipelines_get_running_jobs\n      tags: [pipelines]\n      parameters:\n        - $ref: \"../api/components.yaml#/parameters/classifierIdParam\"\n      responses:\n        \"200\":\n          description: Returns the all currently running jobs for the classifier.\n          content:\n            application/json:\n              schema:\n                type: array\n                items:\n                  type: string\n        \"401\":\n          $ref: \"../api/components.yaml#/responses/NotAuthorized\"\n        \"404\":\n          $ref: \"../api/components.yaml#/responses/ClassifierNotFound\"\n        default:\n          $ref: \"../api/components.yaml#/responses/UnexpectedServerError\"\n\n  /pipelines/job_results/{classifier_id}/{job_id}:\n    get:\n      summary: Get Classifier Job Results\n      description: |\n        Gets the results of a job that ran and completed.\n        \n        Results can only be returned once and then are removed from the internal list of results.\n        Also, the results expire after an amount of time, configured when the job was submitted, and\n        will expire and be removed after that time.\n        \n        Example: `curl -X GET http://localhost:5000/pipelines/job_results/60df138b3f8fa7b2e1445bd8\n                  --cookie session.cookie`\n      operationId: pipelines_get_job_results\n      tags: [pipelines]\n      parameters:\n        - $ref: \"../api/components.yaml#/parameters/classifierIdParam\"\n        - name: job_id\n          in: path\n          description: The ID of the job to get the results for.\n          required: true\n          schema:\n            type: string\n        - name: timeout_in_s\n          in: query\n          description: How long to wait to get results before giving up.  0 will wait indefinitely.\n          required: false\n          schema:\n            type: integer\n            default: 1\n      responses:\n        \"200\":\n          description: Returns the results for the indicated job.\n          content:\n            application/json:\n              schema:\n                type: object\n        \"401\":\n          $ref: \"../api/components.yaml#/responses/NotAuthorized\"\n        \"404\":\n          $ref: \"../api/components.yaml#/responses/ClassifierOrJobNotFound\"\n        default:\n          $ref: \"../api/components.yaml#/responses/UnexpectedServerError\"\n\n  /pipelines/train/{classifier_id}:\n    post:\n      summary: Train Classifier\n      description: |\n        Trains the classifier based on currently annotated documents in the collection.\n        \n        This endpoint can either be _SYNCHRONOUS_ (blocking until job completion) or\n        _ASYNCHRONOUS_ (returns immediately).  For asynchronous requests, the caller is responsible\n        for querying for running jobs using the returned job ID to check for completion.  Once\n        completed, the caller is responsible for getting the job results before the indicated\n        timeout.\n        \n        The default mode is _ASYNCHRONOUS_ but can be controlled via input parameter.\n        \n        Example: `curl -X POST http://localhost:5000/pipelines/train/60df138b3f8fa7b2e1445bd8\n                  --cookie session.cookie\n                  --header 'Content-Type: application/json'\n                  --data '{\"model_name\":\"mymodel\"}'`\n      operationId: pipelines_train\n      tags: [pipelines]\n      parameters:\n        - $ref: \"../api/components.yaml#/parameters/classifierIdParam\"\n      requestBody:\n        content:\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/PipelineTrainParameters\"\n      responses:\n        \"200\":\n          description: Returns the job information.\n          content:\n            application/json:\n              schema:\n                $ref: \"#/components/schemas/PipelineJob\"\n        \"401\":\n          $ref: \"../api/components.yaml#/responses/NotAuthorized\"\n        \"404\":\n          $ref: \"../api/components.yaml#/responses/ClassifierNotFound\"\n        default:\n          $ref: \"../api/components.yaml#/responses/UnexpectedServerError\"\n\n  /pipelines/predict/{classifier_id}:\n    post:\n      summary: Predict Using Classifier\n      description: |\n        Uses the given classifier to predict annotations for the given document(s).\n        \n        Note that this will use the _last-trained_ model for this classifier.\n        \n        This endpoint can either be _SYNCHRONOUS_ (blocking until job completion) or\n        _ASYNCHRONOUS_ (returns immediately).  For asynchronous requests, the caller is responsible\n        for querying for running jobs using the returned job ID to check for completion.  Once\n        completed, the caller is responsible for getting the job results before the indicated\n        timeout.\n        \n        The default mode is _SYNCHRONOUS_ but can be controlled via input parameter.\n        \n        Example: `curl -X POST http://localhost:5000/pipelines/predict/60df138b3f8fa7b2e1445bd8\n                  --cookie session.cookie\n                  --header 'Content-Type: application/json'\n                  --data '{\"document_ids\":[], \"texts\":[], \"async\": false}'`\n      operationId: pipelines_predict\n      tags: [pipelines]\n      parameters:\n        - $ref: \"../api/components.yaml#/parameters/classifierIdParam\"\n      requestBody:\n        content:\n          application/json:\n            schema:\n              $ref: \"#/components/schemas/PipelinePredictParameters\"\n      responses:\n        \"200\":\n          description: Returns the predictions and other job information.\n          content:\n            application/json:\n              schema:\n                $ref: \"#/components/schemas/PipelinePredictions\"\n        \"400\":\n          $ref: \"../api/components.yaml#/responses/InvalidInputParameters\"\n        \"401\":\n          $ref: \"../api/components.yaml#/responses/NotAuthorized\"\n        \"404\":\n          $ref: \"../api/components.yaml#/responses/ClassifierNotFound\"\n        default:\n          $ref: \"../api/components.yaml#/responses/UnexpectedServerError\"\n"
		}
	},
	"Error": "parse: parse spec: paths: /pipelines/train/{classifier_id}: post: operation \"pipelines_train\": parameters: parse parameter \"\": resolve \"../api/components.yaml#/parameters/classifierIdParam\" reference: invalid parameter reference: \"../api/components.yaml#/parameters/classifierIdParam\""
}