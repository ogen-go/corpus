{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/awslabs/amazon-s3-find-and-forget"
		},
		"file": {
			"name": "api.yaml",
			"size": 0,
			"path": "templates/api.yaml",
			"byteSize": 49518,
			"content": "AWSTemplateFormatVersion: \"2010-09-09\"\nTransform: AWS::Serverless-2016-10-31\nDescription: Amazon S3 Find and Forget API\n\nGlobals:\n  Function:\n    Runtime: python3.9\n    Timeout: 180\n    MemorySize: !Ref LambdaAPIMemorySize\n    Layers: !Ref CommonLayers\n    Environment:\n      Variables:\n        AllowOrigin: !If\n          - DefaultAccessControlOrigin\n          - !Ref WebUIOrigin\n          - !Ref AccessControlAllowOriginOverride\n        ConfigParam: !Ref ConfigParameter\n        DeletionQueueTable: !Ref DeletionQueueTableName\n        DataMapperTable: !Ref DataMapperTableName\n        GSIBucketCount: \"1\"\n        JobTable: !Ref JobTableName\n        JobTableDateGSI: !Ref JobTableDateGSI\n        LogLevel: !Ref LogLevel\n\nMetadata:\n  cfn-lint:\n    config:\n      ignore_checks:\n        - W8001 # Bug in cfn-lint not detecting that the Condition is actually in use.\n\nParameters:\n  AccessControlAllowOriginOverride:\n    Type: String\n  ConfigParameter:\n    Type: String\n  CognitoUserPoolArn:\n    Type: String\n  CommonLayers:\n    Type: CommaDelimitedList\n    Description: Common layers supplied to all functions\n  DataMapperTableName:\n    Description: Table name for DataMapper Table\n    Type: String\n  DeletionQueueTableName:\n    Description: Table name for Deletion Queue Table\n    Type: String\n  EnableAccessLogging:\n    Description: Whether to enable access logs\n    Type: String\n  JobTableDateGSI:\n    Description: Date ordered GSI for Jobs Table\n    Type: String\n  JobTableName:\n    Description: Table name for Jobs Table\n    Type: String\n  LambdaAPIMemorySize:\n    Type: Number\n    MinValue: 128\n    MaxValue: 10240\n  LogLevel:\n    Type: String\n    Default: INFO\n    AllowedValues:\n      - CRITICAL\n      - FATAL\n      - ERROR\n      - WARNING\n      - INFO\n      - DEBUG\n      - NOTSET\n  WebUIOrigin:\n    Type: String\n  DeployCognito:\n    Type: String\n\nConditions:\n  EnableAccessLogging: !Equals [!Ref EnableAccessLogging, \"true\"]\n  DefaultAccessControlOrigin: !Equals [!Ref AccessControlAllowOriginOverride, \"false\"]\n  ShouldDeployCognito: !Equals [!Ref DeployCognito, \"true\"]\n\nResources:\n  Api:\n    Type: AWS::Serverless::Api\n    Properties:\n      OpenApiVersion: '3.0.1'\n      StageName: Prod\n      MethodSettings:\n        !If\n        - EnableAccessLogging\n        - - LoggingLevel: INFO\n            DataTraceEnabled: false\n            ResourcePath: '/*'\n            HttpMethod: '*'\n        - !Ref AWS::NoValue\n      DefinitionBody:\n        openapi: \"3.0.1\"\n        info:\n          title: \"Amazon S3 Find And Forget API\"\n          version: \"1.0\"\n        servers:\n          - url: \"https://your-apigw-id.execute-api.region.amazonaws.com/{basePath}\"\n            variables:\n              basePath:\n                default: \"Prod\"\n        tags:\n          - name: DataMapper\n            description: Operations related to data mappers\n          - name: DeletionQueue\n            description: Operations related to the deletion queue\n          - name: Jobs\n            description: Operations related to jobs\n          - name: Settings\n            description: Operations related to solution settings\n        paths:\n          /v1/queue:\n            get:\n              summary: Lists deletion queue items\n              tags:\n                - DeletionQueue\n              operationId: \"listDeletionQueueMatches\"\n              security:\n                - Authorizer: []\n              parameters:\n                - '$ref': '#/components/parameters/StartAtQS'\n                - '$ref': '#/components/parameters/PageSizeQS'\n              responses:\n                '200':\n                  description: OK\n                  content:\n                    application/json:\n                      schema:\n                        type: \"object\"\n                        title: \"DeletionQueue\"\n                        properties:\n                          MatchIds:\n                            type: \"array\"\n                            description: \"The list of Match IDs currently in the queue\"\n                            items:\n                              $ref: '#/components/schemas/DeletionQueueItem'\n                          NextStart:\n                            type: \"string\"\n                            nullable: true\n                            default: \"\"\n                            description: \"The watermark to use when requesting the next page of results\"\n              x-amazon-apigateway-integration:\n                uri:\n                  Fn::Sub: \"arn:${AWS::Partition}:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetDeletionQueue.Arn}/invocations\"\n                passthroughBehavior: \"when_no_match\"\n                httpMethod: \"POST\"\n                type: \"aws_proxy\"\n            delete:\n              summary: Starts a job for the items in the deletion queue\n              tags:\n                - DeletionQueue\n              operationId: \"startDeletionJob\"\n              security:\n                - Authorizer: []\n              responses:\n                '202':\n                  description: \"Job Started\"\n                  content:\n                    application/json:\n                      schema:\n                        $ref: '#/components/schemas/Job'\n                '422':\n                  $ref: '#/components/responses/InvalidRequest'\n              x-amazon-apigateway-integration:\n                uri:\n                  Fn::Sub: \"arn:${AWS::Partition}:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${ProcessQueue.Arn}/invocations\"\n                passthroughBehavior: \"when_no_match\"\n                httpMethod: \"POST\"\n                type: \"aws_proxy\"\n            patch:\n              summary: \"Adds an item to the deletion queue (Deprecated: use PATCH /v1/queue/matches)\"\n              deprecated: true\n              tags:\n                - DeletionQueue\n              operationId: \"addItemToDeletionQueue\"\n              security:\n                - Authorizer: []\n              responses:\n                '201':\n                  description: \"Created\"\n                  content:\n                    application/json:\n                      schema:\n                        $ref: '#/components/schemas/DeletionQueueItem'\n                '422':\n                  $ref: '#/components/responses/InvalidRequest'\n              requestBody:\n                description: \"Request body containing details of the Match to add to the Deletion Queue\"\n                content:\n                  application/json:\n                    schema:\n                      $ref: '#/components/schemas/CreateDeletionQueueItem'\n                required: true\n              x-amazon-apigateway-integration:\n                uri:\n                  Fn::Sub: \"arn:${AWS::Partition}:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${EnqueueDeletion.Arn}/invocations\"\n                passthroughBehavior: \"when_no_match\"\n                httpMethod: \"POST\"\n                type: \"aws_proxy\"\n          /v1/queue/matches:\n            delete:\n              summary: Removes one or more items from the deletion queue\n              tags:\n                - DeletionQueue\n              operationId: \"deleteMatches\"\n              security:\n                - Authorizer: []\n              responses:\n                '204':\n                  description: OK\n              requestBody:\n                description: \"Request body containing a list of Matches to be deleted\"\n                content:\n                  application/json:\n                    schema:\n                      title: \"ListOfMatchDeletions\"\n                      required:\n                        - \"Matches\"\n                      type: \"object\"\n                      properties:\n                        Matches:\n                          type: \"array\"\n                          description: \"The list of Match IDs to remove from the deletion queue\"\n                          items:\n                            title: \"MatchDeletion\"\n                            required:\n                              - \"DeletionQueueItemId\"\n                            type: \"object\"\n                            properties:\n                              DeletionQueueItemId:\n                                type: \"string\"\n                                description: \"The Deletion Queue Item ID to remove from the deletion queue\"\n                required: true\n              x-amazon-apigateway-integration:\n                uri:\n                  Fn::Sub: \"arn:${AWS::Partition}:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${CancelDeletion.Arn}/invocations\"\n                passthroughBehavior: \"when_no_match\"\n                httpMethod: \"POST\"\n                type: \"aws_proxy\"\n            patch:\n              summary: Adds one or more items to the deletion queue\n              tags:\n                - DeletionQueue\n              operationId: \"addItemsToDeletionQueue\"\n              security:\n                - Authorizer: []\n              responses:\n                '201':\n                  description: \"Created\"\n                  content:\n                    application/json:\n                      schema:\n                        title: \"ListOfDeletionQueueItem\"\n                        required:\n                          - \"Matches\"\n                        type: \"object\"\n                        properties:\n                          Matches:\n                            type: \"array\"\n                            description: \"List of Deletion Queue Item objects\"\n                            items:\n                              $ref: '#/components/schemas/DeletionQueueItem'\n                '422':\n                  $ref: '#/components/responses/InvalidRequest'\n              requestBody:\n                description: \"Request body containing details of the Matches to add to the Deletion Queue\"\n                content:\n                  application/json:\n                    schema:\n                      title: \"ListOfCreateDeletionQueueItems\"\n                      required:\n                        - \"Matches\"\n                      type: \"object\"\n                      properties:\n                        Matches:\n                          type: \"array\"\n                          description: \"List of Deletion Queue Items\"\n                          items:\n                            $ref: '#/components/schemas/CreateDeletionQueueItem'\n                required: true\n              x-amazon-apigateway-integration:\n                uri:\n                  Fn::Sub: \"arn:${AWS::Partition}:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${EnqueueDeletions.Arn}/invocations\"\n                passthroughBehavior: \"when_no_match\"\n                httpMethod: \"POST\"\n                type: \"aws_proxy\"\n          /v1/jobs:\n            get:\n              summary: Lists all jobs\n              tags:\n                - Job\n              operationId: \"listJobs\"\n              security:\n                - Authorizer: []\n              parameters:\n                - '$ref': '#/components/parameters/StartAtQS'\n                - '$ref': '#/components/parameters/PageSizeQS'\n              responses:\n                '200':\n                  description: \"OK\"\n                  content:\n                    application/json:\n                      schema:\n                        title: \"ListOfJobs\"\n                        type: \"object\"\n                        properties:\n                          Jobs:\n                            type: \"array\"\n                            description: \"The list of jobs\"\n                            items:\n                              $ref: '#/components/schemas/JobSummary'\n                          NextStart:\n                            type: \"integer\"\n                            nullable: true\n                            default: 0\n                            description: \"The watermark to use when requesting the next page of results\"\n              x-amazon-apigateway-integration:\n                uri:\n                  Fn::Sub: \"arn:${AWS::Partition}:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${ListJobs.Arn}/invocations\"\n                passthroughBehavior: \"when_no_match\"\n                httpMethod: \"POST\"\n                type: \"aws_proxy\"\n          /v1/jobs/{job_id}:\n            parameters:\n              - '$ref': '#/components/parameters/JobId'\n            get:\n              summary: Returns the details of a job\n              tags:\n                - Job\n              operationId: \"getJob\"\n              security:\n                - Authorizer: []\n              responses:\n                '200':\n                  description: \"OK\"\n                  content:\n                    application/json:\n                      schema:\n                        $ref: '#/components/schemas/Job'\n              x-amazon-apigateway-integration:\n                uri:\n                  Fn::Sub: \"arn:${AWS::Partition}:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetJob.Arn}/invocations\"\n                passthroughBehavior: \"when_no_match\"\n                httpMethod: \"POST\"\n                type: \"aws_proxy\"\n          /v1/jobs/{job_id}/events:\n            parameters:\n              - '$ref': '#/components/parameters/JobId'\n            get:\n              summary: Lists all events for a job\n              tags:\n                - Job\n              operationId: \"getJobEvents\"\n              security:\n                - Authorizer: []\n              parameters:\n                - '$ref': '#/components/parameters/StartAtQS'\n                - '$ref': '#/components/parameters/PageSizeQS'\n                - in: \"query\"\n                  name: \"filter\"\n                  required: \"false\"\n                  schema:\n                    oneOf:\n                      - type: \"string\"\n                      - type: \"array\"\n                        items:\n                          type: \"string\"\n                          pattern: \"^(EventName)([=])([a-zA-Z0-9]+)$\"\n                    pattern: \"^(EventName)([=])([a-zA-Z0-9]+)$\"\n                  description: \u003e\n                    Filters to apply in the format [key][operator][value]. If multiple\n                    filters are supplied, they will applied on an **AND** basis.\n                    Supported keys: EventName. Supported Operators: =\n              responses:\n                '200':\n                  description: \"OK\"\n                  content:\n                    application/json:\n                      schema:\n                        title: \"ListOfJobEvents\"\n                        type: \"object\"\n                        properties:\n                          JobEvents:\n                            type: \"array\"\n                            description: \"The list of job events\"\n                            items:\n                              $ref: '#/components/schemas/JobEvent'\n                          NextStart:\n                            type: \"integer\"\n                            nullable: true\n                            default: 0\n                            description: \"The watermark to use when requesting the next page of results\"\n              x-amazon-apigateway-integration:\n                uri:\n                  Fn::Sub: \"arn:${AWS::Partition}:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${ListJobEvents.Arn}/invocations\"\n                passthroughBehavior: \"when_no_match\"\n                httpMethod: \"POST\"\n                type: \"aws_proxy\"\n          /v1/data_mappers:\n            get:\n              summary: Lists data mappers\n              tags:\n                - DataMapper\n              operationId: \"listDataMappers\"\n              security:\n                - Authorizer: []\n              parameters:\n                - '$ref': '#/components/parameters/StartAtQS'\n                - '$ref': '#/components/parameters/PageSizeQS'\n              responses:\n                '200':\n                  description: OK\n                  content:\n                    application/json:\n                      schema:\n                        title: \"ListOfDataMappers\"\n                        type: \"object\"\n                        properties:\n                          DataMappers:\n                            type: \"array\"\n                            description: \"The list of data mappers\"\n                            items:\n                              $ref: '#/components/schemas/DataMapper'\n                          NextStart:\n                            type: \"string\"\n                            nullable: true\n                            default: \"\"\n                            description: \"The watermark to use when requesting the next page of results\"\n              x-amazon-apigateway-integration:\n                uri:\n                  Fn::Sub: \"arn:${AWS::Partition}:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetDataMappers.Arn}/invocations\"\n                passthroughBehavior: \"when_no_match\"\n                httpMethod: \"POST\"\n                type: \"aws_proxy\"\n          /v1/data_mappers/{data_mapper_id}:\n            parameters:\n              - '$ref': '#/components/parameters/DataMapperId'\n            get:\n              summary: Returns the details of a data mapper\n              tags:\n                - DataMapper\n              operationId: \"getDataMapper\"\n              security:\n                - Authorizer: []\n              responses:\n                '200':\n                  description: \"OK\"\n                  content:\n                    application/json:\n                      schema:\n                        $ref: '#/components/schemas/DataMapper'\n              x-amazon-apigateway-integration:\n                uri:\n                  Fn::Sub: \"arn:${AWS::Partition}:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${GetDataMapper.Arn}/invocations\"\n                passthroughBehavior: \"when_no_match\"\n                httpMethod: \"POST\"\n                type: \"aws_proxy\"\n            put:\n              summary: Creates or modifies a data mapper\n              tags:\n                - DataMapper\n              operationId: \"putDataMapper\"\n              security:\n                - Authorizer: []\n              responses:\n                '201':\n                  description: \"OK\"\n                  content:\n                    application/json:\n                      schema:\n                        $ref: '#/components/schemas/DataMapper'\n              requestBody:\n                description: \"Request body containing details of the Data Mapper to create or modify\"\n                content:\n                  application/json:\n                    schema:\n                      $ref: '#/components/schemas/DataMapper'\n                required: true\n              x-amazon-apigateway-integration:\n                uri:\n                  Fn::Sub: \"arn:${AWS::Partition}:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${PutDataMapper.Arn}/invocations\"\n                passthroughBehavior: \"when_no_match\"\n                httpMethod: \"POST\"\n                type: \"aws_proxy\"\n            delete:\n              summary: Removes a data mapper\n              tags:\n                - DataMapper\n              operationId: \"deleteDataMapper\"\n              security:\n                - Authorizer: []\n              responses:\n                '204':\n                  description: OK\n              x-amazon-apigateway-integration:\n                uri:\n                  Fn::Sub: \"arn:${AWS::Partition}:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${DeleteDataMapper.Arn}/invocations\"\n                passthroughBehavior: \"when_no_match\"\n                httpMethod: \"POST\"\n                type: \"aws_proxy\"\n          /v1/settings:\n            get:\n              summary: Gets the solution settings\n              tags:\n                - Settings\n              operationId: \"getSettings\"\n              security:\n                - Authorizer: []\n              responses:\n                '200':\n                  description: \"OK\"\n                  content:\n                    application/json:\n                      schema:\n                        $ref: '#/components/schemas/Settings'\n              x-amazon-apigateway-integration:\n                uri:\n                  Fn::Sub: \"arn:${AWS::Partition}:apigateway:${AWS::Region}:lambda:path/2015-03-31/functions/${ListSettings.Arn}/invocations\"\n                passthroughBehavior: \"when_no_match\"\n                httpMethod: \"POST\"\n                type: \"aws_proxy\"\n        components:\n          parameters:\n            DataMapperId:\n              in: \"path\"\n              name: \"data_mapper_id\"\n              required: \"true\"\n              schema:\n                type: \"string\"\n              description: \"Data Mapper ID path parameter\"\n            JobId:\n              in: \"path\"\n              name: \"job_id\"\n              required: \"true\"\n              schema:\n                type: \"string\"\n              description: \"Job ID path parameter\"\n            PageSizeQS:\n              in: \"query\"\n              name: \"page_size\"\n              required: \"false\"\n              schema:\n                type: \"integer\"\n                minimum: 1\n                maximum: 1000\n              description: \"Page size query string parameter. Min: 1. Max: 1000\"\n            StartAtQS:\n              in: \"query\"\n              name: \"start_at\"\n              required: \"false\"\n              schema:\n                type: \"string\"\n                default: 0\n              description: \"Start at watermark query string parameter\"\n          schemas:\n            DataMapper:\n              description: \"A Data Mapper object\"\n              required:\n                - \"Columns\"\n                - \"QueryExecutor\"\n                - \"QueryExecutorParameters\"\n                - \"RoleArn\"\n              type: \"object\"\n              properties:\n                DataMapperId:\n                  type: \"string\"\n                  description: \"The ID of the data mapper\"\n                Format:\n                  type: \"string\"\n                  description: \"The format of the dataset\"\n                  enum:\n                    - \"json\"\n                    - \"parquet\"\n                  default: \"parquet\"\n                QueryExecutor:\n                  type: \"string\"\n                  description: \"The query executor used to query your dataset\"\n                  enum:\n                    - \"athena\"\n                Columns:\n                  minItems: 1\n                  type: \"array\"\n                  description: \"Columns to query for MatchIds the dataset\"\n                  items:\n                    type: \"string\"\n                QueryExecutorParameters:\n                  type: \"object\"\n                  description: \"Details of the query executor parameters to use when the QueryExecutor is set to 'athena'\"\n                  properties:\n                    DataCatalogProvider:\n                      description: \"The data catalog provider which contains the database table with metadata about your S3 data lake\"\n                      enum:\n                        - \"glue\"\n                      type: \"string\"\n                    Database:\n                      description: \"The database in the data catalog which contains the metatadata table\"\n                      type: \"string\"\n                    Table:\n                      description: \"The table in the data catalog database containing the metatadata for your data lake\"\n                      type: \"string\"\n                    PartitionKeys:\n                      description: \"The partition keys to use on each query. This allows to control the number and the size of the queries. When omitted, all the table partitions are used.\"\n                      type: \"array\"\n                      items:\n                        type: \"string\"\n                  required:\n                    - \"Database\"\n                    - \"Table\"\n                RoleArn:\n                  type: \"string\"\n                  description: \"Role ARN to assume when performing operations in S3 for this data mapper. The role must have the exact name 'S3F2DataAccessRole'.\"\n                  pattern: '^arn:(aws[a-zA-Z-]*)?:iam::\\d{12}:role\\/S3F2DataAccessRole$'\n                DeleteOldVersions:\n                  type: \"boolean\"\n                  description: \"Toggles deleting all non-latest versions of an object after a new redacted version is created\"\n                  default: \"true\"\n                IgnoreObjectNotFoundExceptions:\n                  type: \"boolean\"\n                  description: \"Toggles ignoring Object Not Found errors during deletion\"\n                  default: \"false\"\n            DeletionQueueItem:\n              description: \"A Deletion Queue Item object\"\n              type: \"object\"\n              required:\n                - \"DeletionQueueItemId\"\n                - \"Type\"\n                - \"MatchId\"\n                - \"CreatedAt\"\n                - \"DataMappers\"\n              properties:\n                DeletionQueueItemId:\n                  type: \"string\"\n                  description: \"The Deletion Queue Item unique identifier\"\n                Type:\n                  type: \"string\"\n                  description: \"MatchId Type\"\n                  default: \"Simple\"\n                  enum:\n                    - \"Simple\"\n                    - \"Composite\"\n                MatchId:\n                  oneOf:\n                    - type: \"string\"\n                    - type: \"array\"\n                      items:\n                        type: \"object\"\n                        required:\n                          - \"Column\"\n                          - \"Value\"\n                        properties:\n                          Column:\n                            type: \"string\"\n                            description: \"Column Identifier\"\n                          Value:\n                            type: \"string\"\n                            description: \"Value for the given column\"\n                  description: \"The Match ID to remove from the deletion queue\"\n                CreatedAt:\n                  type: \"integer\"\n                  description: \"Deletion queue item creation date as Epoch timestamp\"\n                DataMappers:\n                  type: \"array\"\n                  description: \"The list of data mappers to apply to this Match ID\"\n                  items:\n                    type: \"string\"\n            CreateDeletionQueueItem:\n              description: \"A request to create a Deletion Queue Item\"\n              required:\n                - \"MatchId\"\n              type: \"object\"\n              properties:\n                Type:\n                  type: \"string\"\n                  description: \"MatchId Type\"\n                  enum:\n                    - \"Simple\"\n                    - \"Composite\"\n                  default: \"Simple\"\n                MatchId:\n                  oneOf:\n                    - type: \"string\"\n                    - type: \"array\"\n                      items:\n                        type: \"object\"\n                        required:\n                          - \"Column\"\n                          - \"Value\"\n                        properties:\n                          Column:\n                            type: \"string\"\n                            description: \"Column Identifier\"\n                          Value:\n                            type: \"string\"\n                            description: \"Value for the given column\"\n                  description: \"The Match ID to remove from the deletion queue\"\n                DataMappers:\n                  type: \"array\"\n                  description: \"The list of data mappers to apply to this Match ID\"\n                  default: [\"*\"]\n                  items:\n                    type: \"string\"\n            JobSummary:\n              description: \"A Job summary object\"\n              type: \"object\"\n              required:\n                - \"Id\"\n                - \"JobStatus\"\n                - \"CreatedAt\"\n              properties:\n                Id:\n                  type: \"string\"\n                  description: \"The Job ID\"\n                JobStatus:\n                  type: \"string\"\n                  description: \"The Job status. When a job is first created, it will remain in queued till the workflow starts\"\n                  default: \"QUEUED\"\n                  enum:\n                    - \"QUEUED\"\n                    - \"RUNNING\"\n                    - \"FORGET_COMPLETED_CLEANUP_IN_PROGRESS\"\n                    - \"COMPLETED\"\n                    - \"COMPLETED_CLEANUP_FAILED\"\n                    - \"FAILED\"\n                    - \"FIND_FAILED\"\n                    - \"FORGET_FAILED\"\n                    - \"FORGET_PARTIALLY_FAILED\"\n                CreatedAt:\n                  type: \"integer\"\n                  description: \"Job creation date as Epoch timestamp\"\n                  default: \u003cthe current time\u003e\n                JobStartTime:\n                  type: \"integer\"\n                  description: \"Job start date as Epoch timestamp\"\n                JobFinishTime:\n                  type: \"integer\"\n                  description: \"Job finish date as Epoch timestamp\"\n                TotalObjectUpdatedCount:\n                  type: \"integer\"\n                  description: \"Total number of successfully updated objects\"\n                  default: 0\n                TotalObjectUpdateSkippedCount:\n                  type: \"integer\"\n                  description: \"Total number of skipped objects\"\n                  default: 0\n                TotalObjectUpdateFailedCount:\n                  type: \"integer\"\n                  description: \"Total number of objects which could not be successfully updated\"\n                  default: 0\n                TotalObjectRollbackFailedCount:\n                  type: \"integer\"\n                  description: \"Total number of objects which could not be successfully rolled back after detecting an integrity conflict\"\n                  default: 0\n                TotalQueryCount:\n                  type: \"integer\"\n                  description: \"Total number of queries executed during the find phase\"\n                  default: 0\n                TotalQueryFailedCount:\n                  type: \"integer\"\n                  description: \"Total number of unsuccessfully executed queries during the find phase\"\n                  default: 0\n                TotalQueryScannedInBytes:\n                  type: \"integer\"\n                  description: \"Total amount of data scanned during the find phase\"\n                  default: 0\n                TotalQuerySucceededCount:\n                  type: \"integer\"\n                  description: \"Total number of successfully executed queries during the find phase\"\n                  default: 0\n                TotalQueryTimeInMillis:\n                  type: \"integer\"\n                  description: \"Total time spent by the query executor for this job\"\n                  default: 0\n            Job:\n              description: \"A Job object\"\n              type: \"object\"\n              required:\n                - \"Id\"\n                - \"JobStatus\"\n                - \"CreatedAt\"\n                - \"AthenaConcurrencyLimit\"\n                - \"AthenaQueryMaxRetries\"\n                - \"DeletionTasksMaxNumber\"\n                - \"ForgetQueueWaitSeconds\"\n                - \"QueryExecutionWaitSeconds\"\n                - \"QueryQueueWaitSeconds\"\n                - \"Sk\"\n                - \"Type\"\n                - \"GSIBucket\"\n              properties:\n                Id:\n                  type: \"string\"\n                  description: \"The Job ID\"\n                JobStatus:\n                  type: \"string\"\n                  description: \"The Job status. When a job is first created, it will remain in queued till the workflow starts\"\n                  default: \"QUEUED\"\n                  enum:\n                    - \"QUEUED\"\n                    - \"RUNNING\"\n                    - \"FORGET_COMPLETED_CLEANUP_IN_PROGRESS\"\n                    - \"COMPLETED\"\n                    - \"COMPLETED_CLEANUP_FAILED\"\n                    - \"FAILED\"\n                    - \"FIND_FAILED\"\n                    - \"FORGET_FAILED\"\n                    - \"FORGET_PARTIALLY_FAILED\"\n                CreatedAt:\n                  type: \"integer\"\n                  description: \"Job creation date as Epoch timestamp\"\n                  default: \u003cthe current time\u003e\n                JobStartTime:\n                  type: \"integer\"\n                  description: \"Job start date as Epoch timestamp\"\n                JobFinishTime:\n                  type: \"integer\"\n                  description: \"Job finish date as Epoch timestamp\"\n                AthenaConcurrencyLimit:\n                  type: \"integer\"\n                  description: \"Athena concurrency setting for this job\"\n                AthenaQueryMaxRetries:\n                  type: \"integer\"\n                  description: \"Max number of retries to each Athena query after a failure\"\n                DeletionTasksMaxNumber:\n                  type: \"integer\"\n                  description: \"Max Fargate tasks setting for this job\"\n                ForgetQueueWaitSeconds:\n                  type: \"integer\"\n                  description: \"Forget queue wait setting for this job\"\n                QueryExecutionWaitSeconds:\n                  type: \"integer\"\n                  description: \"Query execution wait setting for this job\"\n                QueryQueueWaitSeconds:\n                  type: \"integer\"\n                  description: \"Query queue worker wait setting for this job\"\n                TotalObjectUpdatedCount:\n                  type: \"integer\"\n                  description: \"Total number of successfully updated objects\"\n                  default: 0\n                TotalObjectUpdateSkippedCount:\n                  type: \"integer\"\n                  description: \"Total number of skipped objects\"\n                  default: 0\n                TotalObjectUpdateFailedCount:\n                  type: \"integer\"\n                  description: \"Total number of objects which could not be successfully updated\"\n                  default: 0\n                TotalObjectRollbackFailedCount:\n                  type: \"integer\"\n                  description: \"Total number of objects which could not be successfully rolled back after detecting an integrity conflict\"\n                  default: 0\n                TotalQueryCount:\n                  type: \"integer\"\n                  description: \"Total number of queries executed during the find phase\"\n                  default: 0\n                TotalQueryFailedCount:\n                  type: \"integer\"\n                  description: \"Total number of unsuccessfully executed queries during the find phase\"\n                  default: 0\n                TotalQueryScannedInBytes:\n                  type: \"integer\"\n                  description: \"Total amount of data scanned during the find phase\"\n                  default: 0\n                TotalQuerySucceededCount:\n                  type: \"integer\"\n                  description: \"Total number of successfully executed queries during the find phase\"\n                  default: 0\n                TotalQueryTimeInMillis:\n                  type: \"integer\"\n                  description: \"Total time spent by the query executor for this job\"\n                  default: 0\n                Expires:\n                  type: \"integer\"\n                  description: \"Expiry date when the item will be deleted as Epoch time\"\n                Sk:\n                  type: \"string\"\n                  description: \"Internal field used as part of DynamoDB single table design\"\n                Type:\n                  type: \"string\"\n                  enum:\n                    - \"Job\"\n                  description: \"Internal field used as part of DynamoDB single table design\"\n                GSIBucket:\n                  type: \"string\"\n                  description: \"Internal field used as part of DynamoDB single table design\"\n            JobEvent:\n              description: \"A Job Event object\"\n              type: \"object\"\n              properties:\n                Id:\n                  type: \"string\"\n                  description: \"The Job ID\"\n                CreatedAt:\n                  type: \"integer\"\n                  description: \"Job creation date as Epoch timestamp\"\n                  default: \u003cthe current time\u003e\n                EventName:\n                  type: \"string\"\n                  description: \"The Job Event name\"\n                EventData:\n                  type: \"object\"\n                  description: \"Free form field containing data about the event. Structure varies based on the event\"\n                EmitterId:\n                  type: \"string\"\n                  description: \"The identifier for the service or service instance which emitted the event\"\n                  example: \"StepFunctions\"\n                Expires:\n                  type: \"integer\"\n                  description: \"Expiry date when the item will be deleted as Epoch time\"\n                Sk:\n                  type: \"string\"\n                  description: \"Internal field used as part of DynamoDB single table design\"\n                Type:\n                  type: \"string\"\n                  enum:\n                    - \"Job\"\n                  description: \"Internal field used as part of DynamoDB single table design\"\n            Settings:\n              description: \"A Settings object\"\n              type: \"object\"\n              properties:\n                AthenaConcurrencyLimit:\n                  type: \"integer\"\n                  description: \"Athena concurrency setting for this job\"\n                AthenaQueryMaxRetries:\n                  type: \"integer\"\n                  description: \"Max number of retries to each Athena query after a failure\"\n                DeletionTasksMaxNumber:\n                  type: \"integer\"\n                  description: \"Max Fargate tasks setting for this job\"\n                ForgetQueueWaitSeconds:\n                  type: \"integer\"\n                  description: \"Forget queue wait setting for this job\"\n                QueryExecutionWaitSeconds:\n                  type: \"integer\"\n                  description: \"Query execution wait setting for this job\"\n                QueryQueueWaitSeconds:\n                  type: \"integer\"\n                  description: \"Query queue worker wait setting for this job\"\n              required:\n                - \"AthenaConcurrencyLimit\"\n                - \"AthenaQueryMaxRetries\"\n                - \"DeletionTasksMaxNumber\"\n                - \"ForgetQueueWaitSeconds\"\n                - \"QueryExecutionWaitSeconds\"\n                - \"QueryQueueWaitSeconds\"\n            Error:\n              description: \"A standard error object\"\n              type: \"object\"\n              properties:\n                Message:\n                  description: \"Error message\"\n                  type: \"string\"\n              required:\n                - \"Message\"\n          responses:\n            InvalidRequest:\n              description: \"Error response for invalid requests\"\n              content:\n                application/json:\n                  schema:\n                    $ref: '#/components/schemas/Error'\n          securitySchemes:\n            Authorizer:\n              type: \"apiKey\"\n              name: \"Authorization\"\n              in: \"header\"\n              x-amazon-apigateway-authtype: !If [ShouldDeployCognito, \"cognito_user_pools\", \"awsSigv4\"]\n              x-amazon-apigateway-authorizer: !If \n                - ShouldDeployCognito\n                - providerARNs:\n                    - Ref: CognitoUserPoolArn\n                  type: \"cognito_user_pools\"\n                - !Ref AWS::NoValue\n        x-amazon-apigateway-request-validator: All\n        x-amazon-apigateway-request-validators:\n          All:\n            validateRequestParameters: true\n            validateRequestBody: true\n      EndpointConfiguration: REGIONAL\n      Cors:\n        AllowMethods: \"'*'\"\n        AllowHeaders: \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'\"\n        AllowOrigin: !If\n          - DefaultAccessControlOrigin\n          - !Sub \"'${WebUIOrigin}'\"\n          - !Sub \"'${AccessControlAllowOriginOverride}'\"\n      GatewayResponses:\n        DEFAULT_4XX:\n          ResponseTemplates:\n            \"application/json\": '{ \"Message\": $context.error.messageString }'\n          ResponseParameters:\n            Headers:\n              Access-Control-Allow-Methods: \"'*'\"\n              Access-Control-Allow-Headers: \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'\"\n              Access-Control-Allow-Origin: !If\n                - DefaultAccessControlOrigin\n                - !Sub \"'${WebUIOrigin}'\"\n                - !Sub \"'${AccessControlAllowOriginOverride}'\"\n        BAD_REQUEST_BODY:\n          StatusCode: 422\n          ResponseTemplates:\n            \"application/json\": '{ \"Message\": $context.error.messageString }'\n          ResponseParameters:\n            Headers:\n              Access-Control-Allow-Methods: \"'*'\"\n              Access-Control-Allow-Headers: \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'\"\n              Access-Control-Allow-Origin: !If\n                - DefaultAccessControlOrigin\n                - !Sub \"'${WebUIOrigin}'\"\n                - !Sub \"'${AccessControlAllowOriginOverride}'\"\n        BAD_REQUEST_PARAMETERS:\n          StatusCode: 422\n          ResponseTemplates:\n            \"application/json\": '{ \"Message\": $context.error.messageString }'\n          ResponseParameters:\n            Headers:\n              Access-Control-Allow-Methods: \"'*'\"\n              Access-Control-Allow-Headers: \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'\"\n              Access-Control-Allow-Origin: !If\n                - DefaultAccessControlOrigin\n                - !Sub \"'${WebUIOrigin}'\"\n                - !Sub \"'${AccessControlAllowOriginOverride}'\"\n        DEFAULT_5XX:\n          ResponseTemplates:\n            \"application/json\": '{ \"Message\": $context.error.messageString }'\n          ResponseParameters:\n            Headers:\n              Access-Control-Allow-Methods: \"'*'\"\n              Access-Control-Allow-Headers: \"'Content-Type,X-Amz-Date,Authorization,X-Api-Key,X-Amz-Security-Token'\"\n              Access-Control-Allow-Origin: !If\n                - DefaultAccessControlOrigin\n                - !Sub \"'${WebUIOrigin}'\"\n                - !Sub \"'${AccessControlAllowOriginOverride}'\"\n\n  ## Queue\n  EnqueueDeletion:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: handlers.enqueue_handler\n      CodeUri: ../backend/lambdas/queue/\n      Events:\n        Get:\n          Type: Api\n          Properties:\n            Path: /v1/queue\n            Method: PATCH\n            RestApiId: !Ref Api\n      Policies:\n      - DynamoDBCrudPolicy:\n          TableName: !Ref DeletionQueueTableName\n  EnqueueDeletions:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: handlers.enqueue_batch_handler\n      CodeUri: ../backend/lambdas/queue/\n      Events:\n        Get:\n          Type: Api\n          Properties:\n            Path: /v1/queue/matches\n            Method: PATCH\n            RestApiId: !Ref Api\n      Policies:\n      - DynamoDBCrudPolicy:\n          TableName: !Ref DeletionQueueTableName\n  GetDeletionQueue:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: handlers.get_handler\n      CodeUri: ../backend/lambdas/queue/\n      Events:\n        Get:\n          Type: Api\n          Properties:\n            Path: /v1/queue\n            Method: GET\n            RestApiId: !Ref Api\n      Policies:\n        - DynamoDBCrudPolicy:\n            TableName: !Ref DeletionQueueTableName\n  CancelDeletion:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: handlers.cancel_handler\n      CodeUri: ../backend/lambdas/queue/\n      Events:\n        Get:\n          Type: Api\n          Properties:\n            Path: /v1/queue/matches\n            Method: DELETE\n            RestApiId: !Ref Api\n      Policies:\n        - DynamoDBReadPolicy:\n            TableName: !Ref JobTableName\n        - DynamoDBCrudPolicy:\n            TableName: !Ref DeletionQueueTableName\n  ProcessQueue:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: handlers.process_handler\n      CodeUri: ../backend/lambdas/queue/\n      Events:\n        Get:\n          Type: Api\n          Properties:\n            Path: /v1/queue\n            Method: DELETE\n            RestApiId: !Ref Api\n      Policies:\n        - DynamoDBCrudPolicy:\n            TableName: !Ref DeletionQueueTableName\n        - DynamoDBCrudPolicy:\n            TableName: !Ref JobTableName\n        - Statement:\n          - Action: \"ssm:GetParameter\"\n            Effect: \"Allow\"\n            Resource: !Sub \"arn:${AWS::Partition}:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ConfigParameter}\"\n  # DataMappers\n  PutDataMapper:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: handlers.put_data_mapper_handler\n      CodeUri: ../backend/lambdas/data_mappers/\n      Events:\n        Put:\n          Type: Api\n          Properties:\n            Path: /v1/data_mappers/{data_mapper_id}\n            Method: PUT\n            RestApiId: !Ref Api\n      Policies:\n      - Statement:\n        - Action:\n            - \"glue:BatchGetPartition\"\n            - \"glue:GetDatabase*\"\n            - \"glue:GetPartition*\"\n            - \"glue:GetTable*\"\n          Effect: \"Allow\"\n          Resource:\n            - !Sub \"arn:${AWS::Partition}:glue:*:*:catalog*\"\n            - !Sub \"arn:${AWS::Partition}:glue:*:*:database*\"\n            - !Sub \"arn:${AWS::Partition}:glue:*:*:table*\"\n            - !Sub \"arn:${AWS::Partition}:glue:*:*:partition*\"\n      - DynamoDBCrudPolicy:\n          TableName: !Ref DataMapperTableName\n  GetDataMapper:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: handlers.get_data_mapper_handler\n      CodeUri: ../backend/lambdas/data_mappers/\n      Events:\n        Get:\n          Type: Api\n          Properties:\n            Path: /v1/data_mappers/{data_mapper_id}\n            Method: GET\n            RestApiId: !Ref Api\n      Policies:\n        - DynamoDBReadPolicy:\n            TableName: !Ref DataMapperTableName\n  GetDataMappers:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: handlers.get_data_mappers_handler\n      CodeUri: ../backend/lambdas/data_mappers/\n      Events:\n        Get:\n          Type: Api\n          Properties:\n            Path: /v1/data_mappers\n            Method: GET\n            RestApiId: !Ref Api\n      Policies:\n        - DynamoDBCrudPolicy:\n            TableName: !Ref DataMapperTableName\n  DeleteDataMapper:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: handlers.delete_data_mapper_handler\n      CodeUri: ../backend/lambdas/data_mappers/\n      Events:\n        Get:\n          Type: Api\n          Properties:\n            Path: /v1/data_mappers/{data_mapper_id}\n            Method: DELETE\n            RestApiId: !Ref Api\n      Policies:\n        - DynamoDBReadPolicy:\n            TableName: !Ref JobTableName\n        - DynamoDBCrudPolicy:\n            TableName: !Ref DataMapperTableName\n  # Jobs\n  GetJob:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: handlers.get_job_handler\n      CodeUri: ../backend/lambdas/jobs/\n      Events:\n        Get:\n          Type: Api\n          Properties:\n            Path: /v1/jobs/{job_id}\n            Method: GET\n            RestApiId: !Ref Api\n      Policies:\n        - DynamoDBReadPolicy:\n            TableName: !Ref JobTableName\n\n  ListJobs:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: handlers.list_jobs_handler\n      CodeUri: ../backend/lambdas/jobs/\n      Events:\n        List:\n          Type: Api\n          Properties:\n            Path: /v1/jobs\n            Method: GET\n            RestApiId: !Ref Api\n      Policies:\n        - DynamoDBReadPolicy:\n            TableName: !Ref JobTableName\n\n  ListJobEvents:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: handlers.list_job_events_handler\n      CodeUri: ../backend/lambdas/jobs/\n      Events:\n        List:\n          Type: Api\n          Properties:\n            Path: /v1/jobs/{job_id}/events\n            Method: GET\n            RestApiId: !Ref Api\n      Policies:\n        - DynamoDBReadPolicy:\n            TableName: !Ref JobTableName\n\n  # Settings\n  ListSettings:\n    Type: AWS::Serverless::Function\n    Properties:\n      Handler: handlers.list_settings_handler\n      CodeUri: ../backend/lambdas/settings/\n      Events:\n        List:\n          Type: Api\n          Properties:\n            Path: /v1/settings\n            Method: GET\n            RestApiId: !Ref Api\n      Policies:\n        - Statement:\n          - Action: \"ssm:GetParameter\"\n            Effect: \"Allow\"\n            Resource: !Sub \"arn:${AWS::Partition}:ssm:${AWS::Region}:${AWS::AccountId}:parameter${ConfigParameter}\"\n\nOutputs:\n  AccessControlAllowOriginHeader:\n    Description: Access-Control-Allow-Origin header sent from API endpoints\n    Value: !If\n      - DefaultAccessControlOrigin\n      - !Ref WebUIOrigin\n      - !Ref AccessControlAllowOriginOverride\n  ApiArn:\n    Value: !Sub arn:${AWS::Partition}:execute-api:${AWS::Region}:${AWS::AccountId}:${Api}/${Api.Stage}/*/*\n  ApiUrl:\n    Description: API endpoint URL for Prod environment\n    Value: !Sub https://${Api}.execute-api.${AWS::Region}.${AWS::URLSuffix}/${Api.Stage}/\n  PutDataMapperRole:\n    Description: Role used by the PutDataMapper API\n    Value: !Ref PutDataMapperRole\n",
			"canonicalURL": "/github.com/awslabs/amazon-s3-find-and-forget@42482635d4504bc19d4203084844797d7958ad93/-/blob/templates/api.yaml",
			"externalURLs": [
				{
					"url": "https://github.com/awslabs/amazon-s3-find-and-forget/blob/42482635d4504bc19d4203084844797d7958ad93/templates/api.yaml",
					"serviceKind": "GITHUB"
				}
			]
		}
	},
	"Error": "parse: parse spec: parse version: at templates/api.yaml:1:1: invalid version: invalid major version: strconv.Atoi: parsing \"\": invalid syntax"
}