{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/CDCgov/prime-reportstream"
		},
		"file": {
			"name": "settings.yml",
			"size": 0,
			"path": "prime-router/docs/api/settings.yml",
			"byteSize": 29614,
			"content": "openapi: 3.0.2\ninfo:\n  title: Prime ReportStream\n  description: A router of public health data from multiple senders and receivers\n  contact:\n    name: USDS at Centers for Disease Control and Prevention\n    url: https://reportstream.cdc.gov\n    email: reportstream@cdc.gov\n  version: 0.2.0-oas3\npaths:\n\n  # The setting end-point handles the settings for PRIME admins and PHD users\n  #\n  /settings/organizations:\n    get:\n      description: The settings for all organizations of the system. Must have admin access.\n      security:\n        - OAuth2: [ system_admin ]\n      responses:\n        '200':\n          description: OK\n          headers:\n            Last-Modified:\n              description: The date and time any setting was modified in GMT.\n              example: Wed, 21 Oct 2015 07:28:00 GMT\n              required: false\n              schema:\n                type: string\n          content:\n            application/json:\n              schema:\n                type: array\n                items:\n                  $ref: '#/components/schemas/Organization'\n    head:\n      description: Retrived the last modified for all settings of the system. Must have admin access.\n      security:\n        - OAuth2: [ system_admin ]\n      responses:\n        '200':\n          description: OK\n          headers:\n            Last-Modified:\n              description: The Last-Modified response HTTP header contains the date and time any setting was modified.\n              example: Wed, 21 Oct 2015 07:28:00 GMT\n              required: false\n              schema:\n                type: string\n\n  /settings/organizations/{organizationName}:\n    get:\n      description: A single organization settings\n      security:\n        - OAuth2: [ user ]\n      parameters:\n        - in: path\n          schema:\n            type: string\n          required: true\n          name: organizationName\n          description: The name of the organization\n      responses:\n        '200':\n          description: OK\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Organization'\n    put:\n      description: Create or update the direct settings associated with an organization\n      security:\n        - OAuth2: [ system_admin ]\n      parameters:\n        - in: path\n          required: true\n          schema:\n            type: string\n          name: organizationName\n          description: The name of the organization\n      requestBody:\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/Organization'\n      responses:\n        '200':\n          description: OK, the organization setting was updated\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Organization'\n        '201':\n          description: Created\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Organization'\n        '400':\n          description: Bad Request\n        '401':\n          description: Unauthorized\n    delete:\n      description: Delete an organization (and the associated receivers and senders)\n      security:\n        - OAuth2: [ system_admin ]\n      parameters:\n        - in: path\n          required: true\n          schema:\n            type: string\n          name: organizationName\n          description: The name of the organization\n      responses:\n        '200':\n          description: OK, the organization setting was deleted\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Organization'\n        '400':\n          description: Bad Request\n        '401':\n          description: Unauthorized\n\n  /settings/organizations/{organizationName}/receivers:\n    get:\n      description: A list of receivers and their current settings\n      security:\n          - OAuth2: [ user ]\n      parameters:\n        - in: path\n          name: organizationName\n          description: Fetch receivers with this organization name\n          schema:\n            type: string\n          required: true\n          example: az-phd\n      responses:\n        '200':\n          description: OK\n          content:\n            application/json:\n              schema:\n                type: array\n                items:\n                  $ref: '#/components/schemas/Receiver'\n        '400':\n          description: Bad Request\n        '401':\n          description: Unauthorized\n\n  /settings/organizations/{organizationName}/receivers/{receiverName}:\n    get:\n      description: The settings of a single of receiver\n      security:\n        - OAuth2: [ user ]\n      parameters:\n        - in: path\n          name: organizationName\n          description: Create receivers under this organization name\n          schema:\n            type: string\n          required: true\n          example: az-phd\n        - in: path\n          name: receiverName\n          description: The name of the receiver\n          schema:\n            type: string\n          required: true\n          example: elr\n      responses:\n        '200':\n          description: OK\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Receiver'\n        '400':\n          description: Bad Request\n        '401':\n          description: Unauthorized\n    put:\n      description: Update a single reciever\n      security:\n        - OAuth2: [ org_admin ]\n      parameters:\n        - in: path\n          name: organizationName\n          description: Create receivers under this organization name\n          schema:\n            type: string\n          required: true\n          example: az-phd\n        - in: path\n          name: receiverName\n          description: The name of the receiver\n          schema:\n            type: string\n          required: true\n          example: elr\n      requestBody:\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/Receiver'\n      responses:\n        '200':\n          description: OK, the receiver setting was updated\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Receiver'\n        '201':\n          description: Created\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Receiver'\n        '400':\n          description: Bad Request\n        '401':\n          description: Unauthorized\n    delete:\n      description: Delete a receiver\n      security:\n        - OAuth2: [ org_admin ]\n      parameters:\n        - in: path\n          name: organizationName\n          description: the organization name\n          schema:\n            type: string\n          required: true\n          example: az-phd\n        - in: path\n          name: receiverName\n          description: The name of the receiver\n          schema:\n            type: string\n          required: true\n          example: elr\n      responses:\n        '200':\n          description: OK, the receiver was deleted\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Receiver'\n        '400':\n          description: Bad Request\n        '401':\n          description: Unauthorized\n\n  /settings/organizations/{organizationName}/senders:\n    get:\n      description: A list of senders\n      security:\n        - OAuth2: [ user ]\n      parameters:\n        - in: path\n          name: organizationName\n          description: Fetch senders with this organization name\n          schema:\n            type: string\n          required: true\n          example: az-phd\n      responses:\n        '200':\n          description: OK\n          content:\n            application/json:\n              schema:\n                type: array\n                items:\n                  $ref: '#/components/schemas/Sender'\n        '400':\n          description: Bad Request\n        '401':\n          description: Unauthorized\n\n  /settings/organizations/{organizationName}/senders/{senderName}:\n    get:\n      description: The settings of a single of sender\n      security:\n        - OAuth2: [ user ]\n      parameters:\n        - in: path\n          name: organizationName\n          description: Fetch senders with this organization name\n          schema:\n            type: string\n          required: true\n          example: az-phd\n        - in: path\n          name: senderName\n          description: The name of a sender to the data hub\n          schema:\n            type: string\n          required: true\n          example: default\n      responses:\n        '200':\n          description: OK\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Sender'\n        '400':\n          description: Bad Request\n        '401':\n          description: Unauthorized\n    put:\n      description: Update a single sender\n      security:\n        - OAuth2: [ org_admin ]\n      parameters:\n        - in: path\n          name: organizationName\n          description: Fetch senders with this organization name\n          schema:\n            type: string\n          required: true\n          example: az-phd\n        - in: path\n          name: senderName\n          description: The name of a sender to the data hub\n          schema:\n            type: string\n          required: true\n          example: default\n      requestBody:\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/Sender'\n      responses:\n        '200':\n          description: OK\n          content:\n            application/json:\n              schema:\n                type: array\n                items:\n                  $ref: '#/components/schemas/Sender'\n        '201':\n          description: OK\n          content:\n            application/json:\n              schema:\n                type: array\n                items:\n                  $ref: '#/components/schemas/Sender'\n        '400':\n          description: Bad Request\n        '401':\n          description: Unauthorized\n    delete:\n      description: Delete a sender\n      security:\n        - OAuth2: [ org_admin ]\n      parameters:\n        - in: path\n          name: organizationName\n          description: the organization name\n          schema:\n            type: string\n          required: true\n          example: az-phd\n        - in: path\n          name: senderName\n          description: The name of a sender to the data hub\n          schema:\n            type: string\n          required: true\n          example: default\n      responses:\n        '200':\n          description: OK, the sender was deleted\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/Sender'\n        '400':\n          description: Bad Request\n        '401':\n          description: Unauthorized\n\n# Building\ncomponents:\n  schemas:\n    Report:\n      type: object\n      required: [\"id\"]\n      properties:\n        id:\n          description: the id for the report assigned by the Hub\n          type: string\n        timestamp:\n          description: the timestamp for this report submission\n          type: string\n          format: date-time\n        topic:\n          description: the topic configured for the client organization sender\n          type: string\n        reportItemCount:\n          description: total number of individual reports sent to the Hub (in a csv, the number of data lines sent)\n          type: integer\n        destinations:\n          description: where the report is being sent to\n          type: array\n          items:\n            $ref: '#/components/schemas/Destination'\n        destinationCount:\n          description: total destinations recieving the report(s)\n          type: integer\n        routing:\n          description: The receiver destination names for each item in the report. This is displayed when verbose=true is present on the query string.\n          type: array\n          items:\n            $ref: '#/components/schemas/ItemRouting'\n        errorCount:\n          description: total errors found during initial validation.  There may be multiple errors per item.\n          type: integer\n        warningCount:\n          description: total warnings found during initial validation.  There may be multiple warnings per item.\n          type: integer\n        errors:\n          description: a list of errors in the report\n          type: array\n          items:\n            $ref: '#/components/schemas/Detail'\n        warnings:\n          description: a list of warnings in the report\n          type: array\n          items:\n            $ref: '#/components/schemas/Detail'\n\n    Detail:\n      type: object\n      properties:\n        scope:\n          type: string\n          description: Does the error apply to one item\n          enum:\n            - Parameter\n            - Report\n            - Item\n        id:\n          type: string\n          description: Depends on scope, either the item's id (message_id) or the report's id\n        detail:\n          type: string\n          description: The details of the error\n\n    Destination:\n      type: object\n      properties:\n        organization:\n          type: string\n          description: The name of the organization reciving the report\n        organization_id:\n          type: string\n          description: The organization id (i.e. {state abbreviation}-phd)\n        service:\n          type: string\n          description: The service used for delivering the report\n        filteredReportRows:\n          type: array\n          description: \"Information about the rows filtered from the report due to quality.\"\n          items:\n            type: string\n        sending_at:\n          type: string\n          format: date-time\n          description: The time at which the report will be sent\n        itemCount:\n          type: integer\n          description: The number of reports being sent to this destination\n\n    History:\n      type: object\n      description: JSON response containing a list of paginated Submissions and the metadata required to point the next page of submissions.\n      properties:\n        metadata:\n          description: metadata containing `next_cursor`\n          type: string\n        submissions:\n          type: \"array\"\n          items: \n            $ref: '#/components/schemas/Submission'\n\n    ItemRouting:\n      type: object\n      properties:\n        reportIndex:\n          type: integer\n          description: the index of the item in the submitted report (0 based)\n        trackingId:\n          type: string\n          description: The tracking id provided by the sender defined in the schema, null otherwise\n        destinations:\n          description: The organization and service destinations\n          type: array\n          items:\n            type: string\n\n    SettingMetadata:\n      description: The metadata associated with an setting\n      type: object\n      properties:\n        version:\n          description: the version number of the object\n          type: number\n          readOnly: true\n          example: 11\n        createdAt:\n          description: the time that the particular revision was created\n          type: string\n          format: date-time\n          readOnly: true\n        createdBy:\n          description: the user who created the particular revision\n          type: string\n          readOnly: true\n          example: jj@phd.gov\n\n    Organization:\n      description: An organization connected to data hub\n      type: object\n      required: [\"name\", \"description\", \"jurisdiction\" ]\n      properties:\n        name:\n          description: the unique id for the organization\n          type: string\n          example: az-phd\n        description:\n          description: the displayable description of the organization\n          type: string\n          example: Arizona PHD\n        jurisdiction:\n          type: string\n          enum:\n            - National\n            - State\n            - County\n        stateCode:\n          description: the two letter code for the organization\n          type: string\n          example: AZ\n        countyName:\n          description: the county name (must match FIPS name)\n          type: string\n          example: Pima\n        meta:\n          $ref: '#/components/schemas/SettingMetadata'\n\n    Sender:\n      description: An sender of reports to the data hub\n      type: object\n      required:\n        - name\n        - description\n        - topic\n        - schema\n        - format\n      properties:\n        name:\n          description: Unique name for the senders, includes the orgninzation name\n          type: string\n          example: simple_report.default\n        description:\n          description: Display ready description of the sender\n          type: string\n        topic:\n          description: Topic of for this sender. Must match the supported topics.\n          type: string\n          example: covid-19\n        organizationName:\n          description: Name of the organization that this sender belongs to\n          type: string\n          example: az-phd\n          readOnly: true\n        schema:\n          description: the schema name for this sender\n          example: az-phd-covid-19\n          type: string\n        format:\n          description: the payload format\n          type: string\n          enum:\n            - CSV\n        meta:\n          $ref: '#/components/schemas/SettingMetadata'\n\n    Receiver:\n      description: A receiver of reports from the data hub\n      type: object\n      required:\n        - name\n        - description\n        - topic\n        - jurisdictionalFilter\n        - reportConfiguations\n        - timing\n      properties:\n        name:\n          description: The unique name for the receiver. Should include the organization name as a prefix.\n          type: string\n          example: az-phd.elr\n        description:\n          description: Display ready description of the receiver\n          type: string\n          example: Arizona PHD ELR feed\n        topic:\n          description: The topic of for this receiver. Must match the supported topics.\n          type: string\n          example: covid-19\n        organizationName:\n          description: The name of the organization that this receiver belongs to\n          type: string\n          example: az-phd\n          readOnly: true\n        jurisdictionalFilters:\n          description: What items to include in the report.\n          type: array\n          required:\n            - matchFields\n          items:\n            description: A single filter\n            type: object\n            properties:\n              matchFields:\n                description: What fields to match in the filter\n                type: string\n                enum:\n                  - FACILITY_OR_PATIENT_ADDRESS\n                  - FACILITY_ADDRESS\n                  - FACILITY_NAME\n                  - ABNORMAL_VALUE\n              matchValues:\n                description: What is the value to match against\n                type: array\n                items:\n                  type: string\n              doesNotMatch:\n                description: Ensure that the result does not match\n                type: boolean\n                default: false\n        translations:\n          description: How the report is translated from the sender. A report can be sent in multiple ways.\n          type: array\n          items:\n            anyOf:\n              - $ref: '#/components/schemas/CustomConfiguration'\n              - $ref: '#/components/schemas/StandardHL7Configuration'\n            discriminator:\n              propertyName: type\n        timing:\n          description: When the report is sent if not immediately\n          type: object\n          required: [frequency]\n          properties:\n            frequency:\n              description: How often send a report\n              type: string\n              enum:\n                - REAL_TIME\n                - HOURLY\n                - DAILY\n            dailyAt:\n              description: The UTC hour to send a daily batch\n              type: number\n        meta:\n          $ref: '#/components/schemas/SettingMetadata'\n\n    StandardHL7Configuration:\n      description: A standard HL7 configuration\n      type: object\n      required:\n        - type\n        - includeAOE\n        - useBatchHeaders\n        - transport\n      properties:\n        type:\n          description: The discrimenator\n          type: string\n          example: STANDARD_HL7\n        includeAOE:\n          description: Include the AOE\n          type: boolean\n        useBatchHeaders:\n          description: Use BHS and FHS header\n          type: boolean\n        useTestProcessingMode:\n          description: Set a test process mode flag\n          type: boolean\n          default: false\n        receivingApplicationName:\n          description: The receiving application name (needed for HL7 formats)\n          type: string\n          default: null\n        receivingApplicationOID:\n          description: The receiving application OID\n          type: string\n          default: null\n        receivingFacilityName:\n          description: The receiving facility name\n          type: string\n          default: null\n        receivingFacilityOID:\n          description: The receiving facility name\n          type: string\n          default: null\n        reportingFacilityName:\n          description: The reporting facility name (if different from CDC PRIME)\n          type: string\n          default: null\n        reportingFacilityId:\n          description: The reporting facility id (if different from CDC PRIME's OID)\n          type: string\n          default: null\n        reportingFacilityIdType:\n          description: The reporting facility id type (if different from OID)\n          type: string\n          default: null\n        suppressQstForAoe:\n          description: Suppress QST component is AOE OBX segments\n          type: boolean\n          default: false\n        suppressHl7Fields:\n          description: A comma delimited list of HL7 fields to suppress\n          type: string\n          default: null\n        suppressAoe:\n          description: Suppress the AOE OBX results\n          type: boolean\n          default: false\n        defaultAoeToUnknown:\n          description: Default the AOE result to UNK\n          type: boolean\n          default: false\n        useBlankInsteadOfUnknown:\n          description: A comma delimited list of element names that should use blank instead of unknown\n          type: string\n          default: null\n        truncateHDNamespaceIds:\n          description: Truncate the HD fields to HD_TRUNCATION_LIMIT\n          type: boolean\n          default: false\n        usePid14ForPatientEmail:\n          description: Use the PID-14 field for patient email instead of the standard PID-13 field\n          type: boolean\n          default: false\n        convertTimestampToDateTime:\n          description: A comma delimited list of HL7 fields to convert to the yyyMMddHHmmss format\n          type: string\n          default: null\n        phoneNumberFormatting:\n          description: How to format phone numbers (XTN fields)\n          type: string\n          enum:\n            - STANDARD\n            - ONLY_DIGITS_IN_COMPONENT_ONE\n            - AREA_LOCAL_IN_COMPONENT_ONE\n          default: STANDARD\n        nameFormat:\n          description: The format to use for the file name generated by the translation\n          type: string\n          default: standard\n        receivingOrganization:\n          description: The name of the receiving organization in the message\n          type: string\n          default: null\n        useOrderingFacilityName:\n          description: The value to use for the ORC-21 (ordering facility name) field\n          type: string\n          enum:\n            - STANDARD\n            - NCES\n            - ORGANIZATION_NAME\n          default: STANDARD\n        transport:\n          oneOf:\n            - $ref: '#/components/schemas/SFTPTransport'\n            - $ref: '#/components/schemas/AS2Transport'\n            - $ref: '#/components/schemas/BlobStoreTransport'\n            - $ref: '#/components/schemas/NullTransport'\n\n    Submission:\n      description: Individual Action ID result with data being populated from both `public.action` and `public.report_file` tables.\n      type: object\n      properties:\n        created_at:\n          description: Timestamp with timezone coming from the `created_at` row in the `public.action` table.\n          type: string\n        action_id:\n          description: Action ID for the object coming from the `created_at` row in the `public.action` table.\n          type: integer\n        errorCount:\n          description: total errors found during initial validation.  There may be multiple errors per item.\n          type: integer\n        warningCount:\n          description: total warnings found during initial validation.  There may be multiple warnings per item.\n          type: integer\n\n    CustomConfiguration:\n      description: A custom configuration for a custom schema\n      type: object\n      required:\n        - type\n        - schemaName\n        - format\n        - transport\n      properties:\n        type:\n          description: The discrimenator\n          type: string\n          example: CUSTOM\n        schemaName:\n          description: The name of the custom schema\n          type: string\n        format:\n          description: The format of the serializer\n          type: string\n          enum:\n            - CSV\n            - HL7\n        nameFormat:\n          description: The format to use for the file name generated by the translation\n          type: string\n          default: standard\n        receivingOrganization:\n          description: The name of the receiving organization in the message\n          type: string\n          default: null\n        transport:\n          description: The transport to use\n          oneOf:\n            - $ref: '#/components/schemas/SFTPTransport'\n            - $ref: '#/components/schemas/AS2Transport'\n            - $ref: '#/components/schemas/BlobStoreTransport'\n            - $ref: '#/components/schemas/NullTransport'\n\n    SFTPTransport:\n      description: Describes a single SFTP connection in all of it variations\n      type: object\n      required:\n        - type\n        - host\n        - port\n        - filePath\n      properties:\n        type:\n          description: The discriminator\n          type: string\n          example: SFTP\n        host:\n          description: Host name and domain\n          type: string\n          example: sftp.phd.gov\n        port:\n          description: The port to use\n          type: number\n          example: 22\n        filePath:\n          description: The file path to place the report\n          type: string\n          example: /in/test\n\n    BlobStoreTransport:\n      description: Moves results to a Azure Blob Store. Typcially used for HHS Protect interfaces.\n      type: object\n      required:\n        - type\n        - storageName\n        - containerName\n      properties:\n        type:\n          description: The discriminator\n          type: string\n          example: BLOBSTORE\n        storageName:\n          description: This looks for an env var with this name. env var value is the connection string\n          type: string\n        containerName:\n          description: This name of the Azure container\n          type: string\n          example: hhsprotect\n\n    AS2Transport:\n      description: Describes a single AS2 connection in all of it variations\n      type: object\n      required:\n        - type\n        - receiverUrl\n        - receiverId\n        - senderId\n      properties:\n        type:\n          description: The discriminator\n          type: string\n          example: AS2\n        receiverUrl:\n          description: The URL to the AS2 end-point\n          type: string\n          example: https://as2.example.com/receiver.aspx\n        receiverId:\n          description: The AS2 id of the receiver. Usually, the same for all senders.\n          type: string\n          example: exampleAS2Id\n        senderId:\n          description: The AS2 id of the sender. Usually, assigned by receiver to PRIME.\n          type: string\n          example: primeAS2Id\n        senderEmail:\n          description: The email address to contact someone about the message\n          type: string\n          default: reportstream@cdc.gov\n        mimeType:\n          description: The MIME type of the message\n          type: string\n          default: application/hl7-v2\n        contentDescription:\n          description: A description of the content of the message. Usually, the same for all messages.\n          type: string\n          default: SARS-CoV-2 Electronic Lab Results\n\n    NullTransport:\n      description: A transport type that does not do anything\n      type: object\n      required:\n        - type\n      properties:\n        type:\n          description: The discriminator\n          type: string\n          example: NULL\n        dummy:\n          description: A dummy value\n          type: string\n\n  securitySchemes:\n    ApiKeyAuth:\n      type: apiKey\n      in: header\n      name: x-functions-key\n    OAuth2:\n      type: oauth2\n      flows:\n        authorizationCode:\n          authorizationUrl: https://hhs-prime.okta.com/oauth/authorize\n          tokenUrl: https://hhs-prime.okta.com/oauth/token\n          scopes:\n            user: Grants read access\n            org_admin: Grants write access to single org\n            system_admin: Grants access to admin operations\n"
		}
	},
	"Error": "parse: parse spec: parse components: schemas: \"StandardHL7Configuration\": parse schema: property \"convertTimestampToDateTime\": unexpected default \"null\" value"
}