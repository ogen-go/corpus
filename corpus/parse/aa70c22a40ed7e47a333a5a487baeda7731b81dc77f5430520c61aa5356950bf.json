{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/oxidecomputer/ch-oxidase"
		},
		"file": {
			"name": "cloud-hypervisor.yaml",
			"size": 0,
			"path": "vmm/src/api/openapi/cloud-hypervisor.yaml",
			"byteSize": 13915,
			"content": "openapi: 3.0.1\ninfo:\n  title: Cloud Hypervisor API\n  description: Local HTTP based API for managing and inspecting a cloud-hypervisor virtual machine.\n  license:\n    name: Apache 2.0\n    url: http://www.apache.org/licenses/LICENSE-2.0.html\n  version: 0.3.0\n\nservers:\n- url: http://localhost/api/v1\n\npaths:\n\n  /vmm.ping:\n    get:\n      summary: Ping the VMM to check for API server availability\n      responses:\n        200:\n          description: The VMM information\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/VmmPingResponse'\n\n  /vmm.shutdown:\n    put:\n      summary: Shuts the cloud-hypervisor VMM.\n      operationId: shutdownVMM\n      responses:\n        204:\n          description: The VMM successfully shutdown.\n\n  /vm.info:\n    get:\n      summary: Returns general information about the cloud-hypervisor Virtual Machine (VM) instance.\n      responses:\n        200:\n          description: The VM information\n          content:\n            application/json:\n              schema:\n                $ref: '#/components/schemas/VmInfo'\n\n  /vm.create:\n    put:\n      summary: Create the cloud-hypervisor Virtual Machine (VM) instance. The instance is not booted, only created.\n      operationId: createVM\n      requestBody:\n        description: The VM configuration\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/VmConfig'\n        required: true\n      responses:\n        204:\n          description: The VM instance was successfully created.\n\n  /vm.delete:\n    put:\n      summary: Delete the cloud-hypervisor Virtual Machine (VM) instance.\n      operationId: deleteVM\n      responses:\n        204:\n          description: The VM instance was successfully deleted.\n\n  /vm.boot:\n    put:\n      summary: Boot the previously created VM instance.\n      operationId: bootVM\n      responses:\n        204:\n          description: The VM instance successfully booted.\n        404:\n          description: The VM instance could not boot because it is not created yet\n\n  /vm.shutdown:\n    put:\n      summary: Shut the VM instance down.\n      operationId: shutdownVM\n      responses:\n        204:\n          description: The VM instance successfully shut down.\n        404:\n          description: The VM instance could not shut down because is not created.\n        405:\n          description: The VM instance could not shut down because it is not started.\n\n  /vm.reboot:\n    put:\n      summary: Reboot the VM instance.\n      operationId: rebootVM\n      responses:\n        204:\n          description: The VM instance successfully rebooted.\n        404:\n          description: The VM instance could not reboot because it is not created.\n        405:\n          description: The VM instance could not reboot because it is not booted.\n\n  /vm.resize:\n    put:\n      summary: Resize the VM\n      requestBody:\n        description: The target size for the VM\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/VmResize'\n        required: true\n      responses:\n        204:\n          description: The VM instance was successfully resized.\n        404:\n          description: The VM instance could not be resized because it is not created.\n\n  /vm.add-device:\n    put:\n      summary: Add a new device to the VM\n      requestBody:\n        description: The path of the new device\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/VmAddDevice'\n        required: true\n      responses:\n        204:\n          description: The new device was successfully added to the VM instance.\n        404:\n          description: The new device could not be added to the VM instance.\n\n  /vm.remove-device:\n    put:\n      summary: Remove a device from the VM\n      requestBody:\n        description: The identifier of the device\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/VmRemoveDevice'\n        required: true\n      responses:\n        204:\n          description: The device was successfully removed from the VM instance.\n        404:\n          description: The device could not be removed from the VM instance.\n\n  /vm.add-disk:\n    put:\n      summary: Add a new disk to the VM\n      requestBody:\n        description: The details of the new disk\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/DiskConfig'\n        required: true\n      responses:\n        204:\n          description: The new disk was successfully added to the VM instance.\n        500:\n          description: The new disk could not be added to the VM instance.\n\n  /vm.add-fs:\n    put:\n      summary: Add a new virtio-fs device to the VM\n      requestBody:\n        description: The details of the new virtio-fs\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/FsConfig'\n        required: true\n      responses:\n        204:\n          description: The new device was successfully added to the VM instance.\n        500:\n          description: The new device could not be added to the VM instance.\n\n  /vm.add-pmem:\n    put:\n      summary: Add a new pmem device to the VM\n      requestBody:\n        description: The details of the new pmem device\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/PmemConfig'\n        required: true\n      responses:\n        204:\n          description: The new device was successfully added to the VM instance.\n        500:\n          description: The new device could not be added to the VM instance.\n\n  /vm.add-net:\n    put:\n      summary: Add a new network device to the VM\n      requestBody:\n        description: The details of the new network device\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/NetConfig'\n        required: true\n      responses:\n        204:\n          description: The new device was successfully added to the VM instance.\n        500:\n          description: The new device could not be added to the VM instance.\n\n  /vm.add-vsock:\n    put:\n      summary: Add a new vsock device to the VM\n      requestBody:\n        description: The details of the new vsock device\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/VsockConfig'\n        required: true\n      responses:\n        204:\n          description: The new device was successfully added to the VM instance.\n        500:\n          description: The new device could not be added to the VM instance.\n\n\n\ncomponents:\n  schemas:\n\n    VmmPingResponse:\n      required:\n      - version\n      type: object\n      properties:\n        version:\n          type: string\n      description: Virtual Machine Monitor information\n\n    VmInfo:\n      required:\n      - config\n      - state\n      type: object\n      properties:\n        config:\n          $ref: '#/components/schemas/VmConfig'\n        state:\n          type: string\n          enum: [Created, Running, Shutdown, Paused]\n      description: Virtual Machine information\n\n    VmConfig:\n      required:\n      - kernel\n      - cmdline\n      type: object\n      properties:\n        cpus:\n          $ref: '#/components/schemas/CpusConfig'\n        memory:\n          $ref: '#/components/schemas/MemoryConfig'\n        kernel:\n          $ref: '#/components/schemas/KernelConfig'\n        initramfs:\n          $ref: '#/components/schemas/InitramfsConfig'\n        cmdline:\n          $ref: '#/components/schemas/CmdLineConfig'\n        disks:\n          type: array\n          items:\n            $ref: '#/components/schemas/DiskConfig'\n        net:\n          type: array\n          items:\n            $ref: '#/components/schemas/NetConfig'\n        rng:\n          $ref: '#/components/schemas/RngConfig'\n        fs:\n          type: array\n          items:\n            $ref: '#/components/schemas/FsConfig'\n        pmem:\n          type: array\n          items:\n            $ref: '#/components/schemas/PmemConfig'\n        serial:\n          $ref: '#/components/schemas/ConsoleConfig'\n        console:\n          $ref: '#/components/schemas/ConsoleConfig'\n        devices:\n          type: array\n          items:\n            $ref: '#/components/schemas/DeviceConfig'\n        vsock:\n            $ref: '#/components/schemas/VsockConfig'\n        iommu:\n          type: boolean\n          default: false\n      description: Virtual machine configuration\n\n    CpusConfig:\n      required:\n      - boot_vcpus\n      - max_vcpus\n      type: object\n      properties:\n        boot_vcpus:\n          minimum: 1\n          default: 1\n          type: integer\n        max_vcpus:\n          minimum: 1\n          default: 1\n          type: integer\n\n    MemoryConfig:\n      required:\n      - size\n      type: object\n      properties:\n        size:\n          type: integer\n          format: int64\n          default: 512 MB\n        hotplug_size:\n          type: integer\n          format: int64\n        file:\n          type: string\n        mergeable:\n          type: boolean\n          default: false\n        hotplug_method:\n          type: string\n          default: \"acpi\"\n        shared:\n          type: boolean\n          default: false\n        hugepages:\n          type: boolean\n          default: false\n\n    KernelConfig:\n      required:\n      - path\n      type: object\n      properties:\n        path:\n          type: string\n\n    InitramfsConfig:\n      nullable: true\n      required:\n      - path\n      type: object\n      properties:\n        path:\n          type: string\n\n    CmdLineConfig:\n      required:\n      - args\n      type: object\n      properties:\n        args:\n          type: string\n\n    DiskConfig:\n      required:\n      - path\n      type: object\n      properties:\n        path:\n          type: string\n        readonly:\n          type: boolean\n          default: false\n        direct:\n          type: boolean\n          default: false\n        iommu:\n          type: boolean\n          default: false\n        num_queues:\n          type: integer\n          default: 1\n        queue_size:\n          type: integer\n          default: 128\n        vhost_user:\n          type: boolean\n          default: false\n        vhost_socket:\n          type: string\n        wce:\n          type: boolean\n          default: true\n        poll_queue:\n          type: boolean\n          default: true\n        id:\n          type: string\n\n    NetConfig:\n      type: object\n      properties:\n        tap:\n          type: string\n          default: \"\"\n        ip:\n          type: string\n          default: \"192.168.249.1\"\n        mask:\n          type: string\n          default: \"255.255.255.0\"\n        mac:\n          type: string\n        iommu:\n          type: boolean\n          default: false\n        num_queues:\n          type: integer\n          default: 2\n        queue_size:\n          type: integer\n          default: 256\n        vhost_user:\n          type: boolean\n          default: false\n        vhost_socket:\n          type: string\n        id:\n          type: string\n\n    RngConfig:\n      required:\n      - src\n      type: object\n      properties:\n        src:\n          type: string\n          default: \"/dev/urandom\"\n        iommu:\n          type: boolean\n          default: false\n\n    FsConfig:\n      required:\n      - tag\n      - sock\n      type: object\n      properties:\n        tag:\n          type: string\n        sock:\n          type: string\n        num_queues:\n          type: integer\n          default: 1\n        queue_size:\n          type: integer\n          default: 1024\n        dax:\n          type: boolean\n          default: true\n        cache_size:\n          type: integer\n          format: int64\n          default: 8589934592\n        id:\n          type: string\n\n    PmemConfig:\n      required:\n      - file\n      type: object\n      properties:\n        file:\n          type: string\n        size:\n          type: integer\n          format: int64\n        iommu:\n          type: boolean\n          default: false\n        mergeable:\n          type: boolean\n          default: false\n        discard_writes:\n          type: boolean\n          default: false\n        id:\n          type: string\n\n    ConsoleConfig:\n      required:\n      - mode\n      type: object\n      properties:\n        file:\n          type: string\n        mode:\n          type: string\n          enum: [Off, Tty, File, Null]\n        iommu:\n          type: boolean\n          default: false\n\n    DeviceConfig:\n      required:\n      - path\n      type: object\n      properties:\n        path:\n          type: string\n        iommu:\n          type: boolean\n          default: false\n        id:\n          type: string\n\n    VsockConfig:\n      required:\n      - cid\n      - sock\n      type: object\n      properties:\n        cid:\n          type: integer\n          format: int64\n          minimum: 3\n          description: Guest Vsock CID\n        sock:\n          type: string\n          description: Path to UNIX domain socket, used to proxy vsock connections.\n        iommu:\n          type: boolean\n          default: false\n        id:\n          type: string\n\n    VmResize:\n      type: object\n      properties:\n        desired_vcpus:\n          minimum: 1\n          type: integer\n        desired_ram:\n          description: desired memory ram in bytes\n          type: integer\n          format: int64\n\n    VmAddDevice:\n      type: object\n      properties:\n        path:\n          type: string\n\n    VmRemoveDevice:\n      type: object\n      properties:\n        id:\n          type: string\n\n    VmSnapshotConfig:\n      type: object\n      properties:\n        destination_url:\n          type: string\n\n    RestoreConfig:\n      required:\n      - source_url\n      type: object\n      properties:\n        source_url:\n          type: string\n        prefault:\n          type: boolean\n",
			"canonicalURL": "/github.com/oxidecomputer/ch-oxidase@67930d464b4baa5f00f5609aba705fdc91e1cc9f/-/blob/vmm/src/api/openapi/cloud-hypervisor.yaml",
			"externalURLs": [
				{
					"url": "https://github.com/oxidecomputer/ch-oxidase/blob/67930d464b4baa5f00f5609aba705fdc91e1cc9f/vmm/src/api/openapi/cloud-hypervisor.yaml",
					"serviceKind": "GITHUB"
				}
			]
		}
	},
	"Error": "parse: parse spec: parse components: at 1:15: schemas: \"VmInfo\": parse schema: property \"config\": at 1:4327: parse schema: resolve \"#/components/schemas/VmConfig\": parse schema: property \"console\": at 1:3363: parse schema: resolve \"#/components/schemas/ConsoleConfig\": parse schema: property \"mode\": at 1:227: parse enum values: parse value \"false\": expected type \"string\", got \"bool\""
}