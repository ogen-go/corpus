{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/OpenAnswers/panther-core"
		},
		"file": {
			"name": "swagger.json",
			"size": 0,
			"path": "packages/oa-event-console/docker.files/swagger.json",
			"byteSize": 40519,
			"content": "{\n  \"info\": {\n    \"title\": \"Panther Console API\",\n    \"version\": \"1.0.0\"\n  },\n  \"basePath\": \"/api\",\n  \"openapi\": \"3.0.0\",\n  \"components\": {\n    \"securitySchemes\": {\n      \"SessionCookie\": {\n        \"type\": \"apiKey\",\n        \"in\": \"cookie\",\n        \"name\": \"panther.sid\"\n      },\n      \"ApiKeyToken\": {\n        \"type\": \"apiKey\",\n        \"in\": \"header\",\n        \"name\": \"x-api-token\"\n      }\n    }\n  },\n  \"security\": [\n    {\n      \"SessionCookie\": []\n    }\n  ],\n  \"servers\": [\n    {\n      \"url\": \"/api\"\n    }\n  ],\n  \"paths\": {\n    \"/\": {\n      \"get\": {\n        \"summary\": \"api welcome\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"welcome message\",\n            \"content\": {\n              \"application/json\": {\n                \"example\": {\n                  \"name\": \"api\",\n                  \"data\": \"Hello there! I am the Panther api\",\n                  \"version\": 1\n                },\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"name\": {\n                      \"type\": \"string\",\n                      \"enum\": [\"api\"]\n                    },\n                    \"data\": {\n                      \"type\": \"string\"\n                    },\n                    \"version\": {\n                      \"type\": \"integer\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/filters\": {\n      \"get\": {\n        \"summary\": \"filters base path\",\n        \"responses\": {\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          },\n          \"405\": {\n            \"$ref\": \"#/responses/NotImplemented\"\n          }\n        }\n      }\n    },\n    \"/severities\": {\n      \"get\": {\n        \"summary\": \"severities base path\",\n        \"responses\": {\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          },\n          \"405\": {\n            \"$ref\": \"#/responses/NotImplemented\"\n          }\n        }\n      }\n    },\n    \"/rules/global\": {\n      \"get\": {\n        \"summary\": \"global rules base path\",\n        \"responses\": {\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          },\n          \"405\": {\n            \"$ref\": \"#/responses/NotImplemented\"\n          }\n        }\n      }\n    },\n    \"/rules/groups\": {\n      \"get\": {\n        \"summary\": \"group rules base path\",\n        \"responses\": {\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          },\n          \"405\": {\n            \"$ref\": \"#/responses/NotImplemented\"\n          }\n        }\n      }\n    },\n    \"/rules/group/{groupId}\": {\n      \"get\": {\n        \"summary\": \"retrieve one rule\",\n        \"parameters\": [\n          {\n            \"name\": \"groupId\",\n            \"in\": \"path\",\n            \"required\": true,\n            \"schema\": {\n              \"type\": \"string\"\n            },\n            \"example\": \"all\"\n          }\n        ],\n        \"responses\": {\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          },\n          \"404\": {\n            \"$ref\": \"#/responses/NotFound\"\n          },\n          \"405\": {\n            \"$ref\": \"#/responses/NotImplemented\"\n          }\n        }\n      }\n    },\n    \"/groups\": {\n      \"get\": {\n        \"summary\": \"API base path groups\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"List of Groups\",\n            \"content\": {\n              \"application/json\": {\n                \"example\": {\n                  \"name\": \"groups\",\n                  \"data\": [\"all\", \"some\", \"none\"]\n                },\n                \"schema\": {\n                  \"allOf\": [\n                    {\n                      \"$ref\": \"#/definitions/GeneralApiResponseArray\"\n                    },\n                    {\n                      \"type\": \"object\",\n                      \"properties\": {\n                        \"name\": {\n                          \"enum\": [\"groups\"]\n                        },\n                        \"data\": {\n                          \"type\": \"array\",\n                          \"items\": {\n                            \"$ref\": \"#/definitions/GroupName\"\n                          }\n                        }\n                      }\n                    }\n                  ]\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          }\n        }\n      }\n    },\n    \"/rules\": {\n      \"get\": {\n        \"summary\": \"list all rules\",\n        \"responses\": {\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          },\n          \"405\": {\n            \"$ref\": \"#/responses/NotImplemented\"\n          }\n        }\n      }\n    },\n    \"/actions\": {\n      \"get\": {\n        \"summary\": \"API actions list\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"List of action names\",\n            \"content\": {\n              \"application/json\": {\n                \"example\": {\n                  \"name\": \"actions\",\n                  \"data\": [\"discard\", \"replace\", \"set\", \"stop\", \"stop_rule_set\"]\n                },\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"name\": {\n                      \"type\": \"string\",\n                      \"enum\": [\"actions\"]\n                    },\n                    \"data\": {\n                      \"type\": \"array\",\n                      \"items\": {\n                        \"$ref\": \"#/definitions/ActionName\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          }\n        }\n      }\n    },\n    \"/actions_obj\": {\n      \"get\": {\n        \"summary\": \"API actions object format\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Action names\",\n            \"content\": {\n              \"application/json\": {\n                \"example\": {\n                  \"name\": \"actions_obj\",\n                  \"data\": {\n                    \"discard\": {\n                      \"name\": \"discard\",\n                      \"description\": \"Discards the event immediately, and applies no further processing.\",\n                      \"friendly_name\": \"Discard\",\n                      \"friendly_after\": \"this event\",\n                      \"input\": []\n                    }\n                  }\n                },\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"name\": {\n                      \"type\": \"string\",\n                      \"enum\": [\"actions_obj\"]\n                    },\n                    \"data\": {\n                      \"type\": \"object\",\n                      \"properties\": {\n                        \"discard\": {\n                          \"$ref\": \"#/definitions/ActionDiscard\"\n                        },\n                        \"replace\": {\n                          \"$ref\": \"#/definitions/ActionReplace\"\n                        },\n                        \"set\": {\n                          \"$ref\": \"#/definitions/ActionSet\"\n                        },\n                        \"stop\": {\n                          \"$ref\": \"#/definitions/ActionStop\"\n                        },\n                        \"stop_rule_set\": {\n                          \"$ref\": \"#/definitions/ActionStopRuleSet\"\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          }\n        }\n      }\n    },\n    \"/selects\": {\n      \"get\": {\n        \"summary\": \"API selections list\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"List of selection criterion\",\n            \"content\": {\n              \"application/json\": {\n                \"example\": {\n                  \"name\": \"selects\",\n                  \"data\": [\n                    \"all\",\n                    \"none\",\n                    \"match\",\n                    \"equals\",\n                    \"field_exists\",\n                    \"field_missing\",\n                    \"starts_with\",\n                    \"ends_with\",\n                    \"less_than\",\n                    \"greater_than\",\n                    \"schedule\"\n                  ]\n                },\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"name\": {\n                      \"type\": \"string\",\n                      \"enum\": [\"selects\"]\n                    },\n                    \"data\": {\n                      \"type\": \"array\",\n                      \"items\": {\n                        \"$ref\": \"#/definitions/SelectCriterion\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          }\n        }\n      }\n    },\n    \"/selects_obj\": {\n      \"get\": {\n        \"summary\": \"All selectors as object\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Selection names\",\n            \"content\": {\n              \"application/json\": {\n                \"example\": {\n                  \"name\": \"selects_obj\",\n                  \"data\": {\n                    \"all\": {\n                      \"name\": \"all\",\n                      \"input\": []\n                    }\n                  }\n                },\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"name\": {\n                      \"type\": \"string\",\n                      \"enum\": [\"selects_obj\"]\n                    },\n                    \"data\": {\n                      \"type\": \"object\",\n                      \"properties\": {\n                        \"all\": {\n                          \"type\": \"object\"\n                        },\n                        \"none\": {\n                          \"type\": \"object\"\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          }\n        }\n      }\n    },\n    \"/options\": {\n      \"get\": {\n        \"summary\": \"List of all rule options\",\n        \"responses\": {\n          \"200\": {\n            \"content\": {\n              \"application/json\": {\n                \"example\": {\n                  \"name\": \"options\",\n                  \"data\": [\"author\", \"debug\", \"original\", \"skip\", \"unless\"]\n                },\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"name\": {\n                      \"type\": \"string\",\n                      \"enum\": [\"options\"]\n                    },\n                    \"data\": {\n                      \"type\": \"array\",\n                      \"items\": {\n                        \"$ref\": \"#/definitions/RuleOption\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          }\n        }\n      }\n    },\n    \"/options_obj\": {\n      \"get\": {\n        \"summary\": \"Object of all rule options\",\n        \"responses\": {\n          \"200\": {\n            \"content\": {\n              \"application/json\": {\n                \"example\": {\n                  \"name\": \"otions_obj\",\n                  \"data\": {\n                    \"original\": {\n                      \"name\": \"original\",\n                      \"input\": []\n                    }\n                  }\n                },\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"name\": {\n                      \"type\": \"string\",\n                      \"enum\": [\"options_obj\"]\n                    },\n                    \"data\": {\n                      \"type\": \"object\"\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          }\n        }\n      }\n    },\n    \"/fields\": {\n      \"get\": {\n        \"summary\": \"list of available field names\",\n        \"responses\": {\n          \"200\": {\n            \"content\": {\n              \"application/json\": {\n                \"example\": {\n                  \"name\": \"fields\",\n                  \"data\": [\n                    \"acknowledged\",\n                    \"agent\",\n                    \"external_id\",\n                    \"first_occurrence\",\n                    \"group\",\n                    \"identifier\",\n                    \"node\",\n                    \"last_occurrence\",\n                    \"owner\",\n                    \"severity\",\n                    \"state_change\",\n                    \"summary\",\n                    \"tag\",\n                    \"tally\"\n                  ]\n                },\n                \"schema\": {\n                  \"allOf\": [\n                    {\n                      \"$ref\": \"#/definitions/GeneralApiResponseArray\"\n                    },\n                    {\n                      \"type\": \"object\",\n                      \"properties\": {\n                        \"name\": {\n                          \"enum\": [\"fields\"]\n                        },\n                        \"data\": {\n                          \"items\": {\n                            \"$ref\": \"#/definitions/FieldName\"\n                          }\n                        }\n                      }\n                    }\n                  ]\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          }\n        }\n      }\n    },\n    \"/rule/{ruleId}\": {\n      \"get\": {\n        \"summary\": \"retrieve one rule\",\n        \"parameters\": [\n          {\n            \"name\": \"ruleId\",\n            \"in\": \"path\",\n            \"required\": true,\n            \"schema\": {\n              \"type\": \"string\"\n            }\n          }\n        ],\n        \"responses\": {\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          },\n          \"404\": {\n            \"$ref\": \"#/responses/NotFound\"\n          },\n          \"405\": {\n            \"$ref\": \"#/responses/NotImplemented\"\n          }\n        }\n      }\n    },\n    \"/action/{actionId}\": {\n      \"get\": {\n        \"summary\": \"action definition\",\n        \"parameters\": [\n          {\n            \"name\": \"actionId\",\n            \"in\": \"path\",\n            \"required\": true,\n            \"examples\": {\n              \"discard\": {\n                \"value\": \"discard\"\n              },\n              \"replace\": {\n                \"value\": \"replace\"\n              },\n              \"set\": {\n                \"value\": \"set\"\n              },\n              \"stop\": {\n                \"value\": \"stop\"\n              },\n              \"stop_rule_set\": {\n                \"value\": \"stop_rule_set\"\n              }\n            },\n            \"schema\": {\n              \"$ref\": \"#/definitions/ActionName\"\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"content\": {\n              \"application/json\": {\n                \"example\": {\n                  \"name\": \"action\",\n                  \"id\": \"action\",\n                  \"data\": {\n                    \"name\": \"discard\",\n                    \"description\": \"Discards the event immediately, and applies no further processing.\",\n                    \"friendly_name\": \"Discard\",\n                    \"friendly_after\": \"this event\",\n                    \"input\": []\n                  }\n                },\n                \"schema\": {\n                  \"allOf\": [\n                    {\n                      \"$ref\": \"#/definitions/GeneralApiResponseArray\"\n                    },\n                    {\n                      \"type\": \"object\",\n                      \"properties\": {\n                        \"name\": {\n                          \"enum\": [\"action\"]\n                        },\n                        \"id\": {\n                          \"$ref\": \"#/definitions/ActionName\"\n                        },\n                        \"data\": {\n                          \"type\": \"object\",\n                          \"properties\": {\n                            \"name\": {\n                              \"type\": \"string\"\n                            },\n                            \"description\": {\n                              \"type\": \"string\"\n                            },\n                            \"input\": {\n                              \"type\": \"array\",\n                              \"items\": {\n                                \"$ref\": \"#/definitions/ActionInput\"\n                              }\n                            }\n                          }\n                        }\n                      }\n                    }\n                  ]\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          },\n          \"404\": {\n            \"$ref\": \"#/responses/NotFound\"\n          }\n        }\n      }\n    },\n    \"/select/{selectId}\": {\n      \"get\": {\n        \"summary\": \"select description\",\n        \"parameters\": [\n          {\n            \"name\": \"selectId\",\n            \"in\": \"path\",\n            \"required\": true,\n            \"schema\": {\n              \"$ref\": \"#/definitions/SelectCriterion\"\n            },\n            \"examples\": {\n              \"all\": {\n                \"value\": \"all\"\n              },\n              \"equals\": {\n                \"value\": \"equals\"\n              }\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"content\": {\n              \"application/json\": {\n                \"examples\": {\n                  \"all\": {\n                    \"value\": {\n                      \"name\": \"all\",\n                      \"id\": \"all\",\n                      \"data\": {\n                        \"name\": \"all\",\n                        \"input\": []\n                      }\n                    }\n                  },\n                  \"equals\": {\n                    \"value\": {\n                      \"name\": \"equals\",\n                      \"id\": \"equals\",\n                      \"data\": {\n                        \"name\": \"equals\",\n                        \"description\": \"Matches values that are exactly the same.\",\n                        \"friendly_before\": \"is\",\n                        \"friendly_name\": \"equal\",\n                        \"friendly_after\": \"to\",\n                        \"help\": \"This is a equals field, it must match the value exactly\",\n                        \"input\": [\n                          {\n                            \"name\": \"field\",\n                            \"label\": \"field\",\n                            \"type\": \"string\"\n                          },\n                          {\n                            \"name\": \"value\",\n                            \"label\": \"string or /regex/\",\n                            \"type\": \"stregex\",\n                            \"array\": true\n                          }\n                        ]\n                      }\n                    }\n                  }\n                },\n                \"schema\": {\n                  \"allOf\": [\n                    {\n                      \"$ref\": \"#/definitions/GeneralApiResponseArray\"\n                    },\n                    {\n                      \"type\": \"object\",\n                      \"properties\": {\n                        \"name\": {\n                          \"enum\": [\"select\"]\n                        },\n                        \"id\": {\n                          \"$ref\": \"#/definitions/SelectCriterion\"\n                        },\n                        \"data\": {\n                          \"type\": \"object\",\n                          \"properties\": {\n                            \"name\": {\n                              \"type\": \"string\"\n                            },\n                            \"description\": {\n                              \"type\": \"string\"\n                            },\n                            \"input\": {\n                              \"type\": \"array\",\n                              \"items\": {\n                                \"$ref\": \"#/definitions/ActionInput\"\n                              }\n                            }\n                          }\n                        }\n                      }\n                    }\n                  ]\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          },\n          \"404\": {\n            \"$ref\": \"#/responses/NotFound\"\n          }\n        }\n      }\n    },\n    \"/field/{fieldId}\": {\n      \"get\": {\n        \"summary\": \"API field description record\",\n        \"parameters\": [\n          {\n            \"name\": \"fieldId\",\n            \"in\": \"path\",\n            \"required\": true,\n            \"examples\": {\n              \"node\": {\n                \"value\": \"node\"\n              },\n              \"summary\": {\n                \"value\": \"summary\"\n              },\n              \"identifier\": {\n                \"value\": \"identifier\"\n              },\n              \"severity\": {\n                \"value\": \"severity\"\n              },\n              \"tag\": {\n                \"value\": \"tag\"\n              }\n            },\n            \"schema\": {\n              \"type\": \"string\"\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"content\": {\n              \"application/json\": {\n                \"examples\": {\n                  \"tag\": {\n                    \"value\": {\n                      \"name\": \"field\",\n                      \"id\": \"field\",\n                      \"data\": {\n                        \"name\": \"tag\",\n                        \"priority\": \"C\",\n                        \"alias\": \"app\",\n                        \"type\": \"String\",\n                        \"label\": \"Tag\",\n                        \"label_shrt\": \"Tag\",\n                        \"size\": 90,\n                        \"help\": \"Tag for the event\",\n                        \"view\": {\n                          \"priority\": 20\n                        }\n                      }\n                    }\n                  },\n                  \"severity\": {\n                    \"value\": {\n                      \"name\": \"field\",\n                      \"id\": \"field\",\n                      \"data\": {\n                        \"name\": \"severity\",\n                        \"priority\": \"M\",\n                        \"alias\": \"s\",\n                        \"type\": \"Number\",\n                        \"label\": \"Severity\",\n                        \"label_shrt\": \"Sev\",\n                        \"size\": 60,\n                        \"help\": \"Severity of the event (0-5)\",\n                        \"view\": {\n                          \"priority\": 120,\n                          \"default\": true\n                        }\n                      }\n                    }\n                  }\n                },\n                \"schema\": {\n                  \"allOf\": [\n                    {\n                      \"$ref\": \"#/definitions/GeneralApiResponse\"\n                    },\n                    {\n                      \"type\": \"object\",\n                      \"properties\": {\n                        \"id\": {\n                          \"type\": \"string\"\n                        },\n                        \"data\": {\n                          \"$ref\": \"#/definitions/FieldRecord\"\n                        }\n                      }\n                    }\n                  ]\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          },\n          \"404\": {\n            \"$ref\": \"#/responses/NotFound\"\n          }\n        }\n      }\n    },\n    \"/status\": {\n      \"get\": {\n        \"summary\": \"System uptime record\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"is it up\",\n            \"content\": {\n              \"application/json\": {\n                \"example\": {\n                  \"status\": {\n                    \"time\": {\n                      \"now\": 1588251181072,\n                      \"start\": 1588251060612,\n                      \"update\": 1588251061234\n                    }\n                  }\n                },\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"status\": {\n                      \"type\": \"object\",\n                      \"properties\": {\n                        \"time\": {\n                          \"$ref\": \"#/definitions/Time\"\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/status/time\": {\n      \"get\": {\n        \"summary\": \"System uptime record\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"is it up\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"time\": {\n                      \"$ref\": \"#/definitions/Time\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/status/time/now\": {\n      \"get\": {\n        \"summary\": \"System uptime record\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"is it up\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"$ref\": \"#/definitions/TimeNow\"\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/status/time/start\": {\n      \"get\": {\n        \"summary\": \"System uptime record\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"is it up\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"$ref\": \"#/definitions/TimeStart\"\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/status/time/update\": {\n      \"get\": {\n        \"summary\": \"System uptime record\",\n        \"responses\": {\n          \"200\": {\n            \"description\": \"is it up\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"$ref\": \"#/definitions/TimeUpdate\"\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/apikey/exists/{apiKey}\": {\n      \"get\": {\n        \"summary\": \"Checks for the existence of an API key\",\n        \"parameters\": [\n          {\n            \"name\": \"apiKey\",\n            \"in\": \"path\",\n            \"required\": true,\n            \"schema\": {\n              \"$ref\": \"#/definitions/ApiKey\"\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"found\": {\n                      \"type\": \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    \"/apikey/read\": {\n      \"get\": {\n        \"summary\": \"List of API keys\",\n        \"responses\": {\n          \"200\": {\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"results\": {\n                      \"type\": \"integer\",\n                      \"minimum\": 0\n                    },\n                    \"data\": {\n                      \"type\": \"array\",\n                      \"items\": {\n                        \"$ref\": \"#/definitions/ApiKeyRecord\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          }\n        }\n      }\n    },\n    \"/apikey/read/{apiKey}\": {\n      \"get\": {\n        \"summary\": \"view and API key\",\n        \"parameters\": [\n          {\n            \"name\": \"apiKey\",\n            \"in\": \"path\",\n            \"required\": true,\n            \"schema\": {\n              \"$ref\": \"#/definitions/ApiKey\"\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"results\": {\n                      \"type\": \"integer\",\n                      \"minimum\": 1,\n                      \"maximum\": 1\n                    },\n                    \"data\": {\n                      \"type\": \"array\",\n                      \"items\": {\n                        \"$ref\": \"#/definitions/ApiKeyRecord\"\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          },\n          \"404\": {\n            \"$ref\": \"#/responses/NotFound\"\n          }\n        }\n      }\n    },\n    \"/apikey/delete/{apiKey}\": {\n      \"delete\": {\n        \"summary\": \"remove an API key\",\n        \"parameters\": [\n          {\n            \"name\": \"apiKey\",\n            \"in\": \"path\",\n            \"required\": true,\n            \"schema\": {\n              \"$ref\": \"#/definitions/ApiKey\"\n            }\n          }\n        ],\n        \"responses\": {\n          \"200\": {\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"message\": {\n                      \"type\": \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"$ref\": \"#/responses/Unauthorised\"\n          },\n          \"404\": {\n            \"$ref\": \"#/responses/NotFound\"\n          }\n        }\n      }\n    },\n    \"/event/create\": {\n      \"post\": {\n        \"summary\": \"Event creation\",\n        \"security\": [\n          {\n            \"ApiKeyToken\": []\n          }\n        ],\n        \"operationId\": \"eventCreate\",\n        \"requestBody\": {\n          \"description\": \"Event to create\",\n          \"required\": true,\n          \"content\": {\n            \"application/json\": {\n              \"examples\": {\n                \"appup\": {\n                  \"value\": {\n                    \"event\": {\n                      \"node\": \"localhost\",\n                      \"summary\": \"app started\",\n                      \"severity\": 1\n                    }\n                  }\n                },\n                \"appdown\": {\n                  \"value\": {\n                    \"event\": {\n                      \"node\": \"localhost\",\n                      \"summary\": \"app shutdown\",\n                      \"severity\": 3\n                    }\n                  }\n                },\n                \"appcrashed\": {\n                  \"value\": {\n                    \"event\": {\n                      \"node\": \"localhost\",\n                      \"summary\": \"app crashed\",\n                      \"severity\": 5\n                    }\n                  }\n                }\n              },\n              \"schema\": {\n                \"type\": \"object\",\n                \"properties\": {\n                  \"event\": {\n                    \"type\": \"object\",\n                    \"required\": [\"node\", \"summary\", \"severity\"],\n                    \"properties\": {\n                      \"node\": {\n                        \"type\": \"string\"\n                      },\n                      \"summary\": {\n                        \"type\": \"string\"\n                      },\n                      \"tag\": {\n                        \"type\": \"string\"\n                      },\n                      \"severity\": {\n                        \"type\": \"integer\",\n                        \"format\": \"int32\",\n                        \"minimum\": 0,\n                        \"maxiumum\": 5\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          }\n        },\n        \"responses\": {\n          \"200\": {\n            \"description\": \"Event created or updated\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"type\": \"object\",\n                  \"properties\": {\n                    \"status\": {\n                      \"type\": \"string\"\n                    },\n                    \"message\": {\n                      \"type\": \"string\"\n                    },\n                    \"event\": {\n                      \"type\": \"object\",\n                      \"properties\": {\n                        \"agent\": {\n                          \"type\": \"string\",\n                          \"enum\": [\"http\"]\n                        }\n                      }\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"401\": {\n            \"description\": \"Not authorised\",\n            \"content\": {\n              \"application/json\": {\n                \"schema\": {\n                  \"$ref\": \"#/definitions/Error\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  \"definitions\": {\n    \"GeneralApiError\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\",\n          \"enum\": [\"error\"]\n        },\n        \"message\": {\n          \"type\": \"string\"\n        }\n      }\n    },\n    \"NameRecord\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\"\n        }\n      }\n    },\n    \"GeneralApiResponse\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\"\n        }\n      },\n      \"required\": [\"name\"]\n    },\n    \"GeneralApiResponseArray\": {\n      \"allOf\": [\n        {\n          \"$ref\": \"#/definitions/GeneralApiResponse\"\n        },\n        {\n          \"type\": \"object\",\n          \"properties\": {\n            \"data\": {\n              \"type\": \"array\",\n              \"items\": \"all\"\n            }\n          }\n        }\n      ]\n    },\n    \"SelectCriterion\": {\n      \"type\": \"string\",\n      \"enum\": [\n        \"all\",\n        \"none\",\n        \"match\",\n        \"equals\",\n        \"equals\",\n        \"field_exists\",\n        \"field_missing\",\n        \"starts_with\",\n        \"ends_with\",\n        \"less_than\",\n        \"greater_than\",\n        \"schedule\"\n      ]\n    },\n    \"RuleOption\": {\n      \"type\": \"string\",\n      \"enum\": [\"author\", \"debug\", \"original\", \"skip\", \"unless\"]\n    },\n    \"ActionName\": {\n      \"type\": \"string\",\n      \"enum\": [\"discard\", \"replace\", \"set\", \"stop\", \"stop_rule_set\"]\n    },\n    \"GroupName\": {\n      \"type\": \"string\",\n      \"pattern\": \"[\\\\w \\\\-_]+\"\n    },\n    \"FieldName\": {\n      \"type\": \"string\",\n      \"pattern\": \"[\\\\w \\\\-_]+\"\n    },\n    \"FieldRecord\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\"\n        },\n        \"priority\": {\n          \"type\": \"string\",\n          \"enum\": [\"C\", \"M\"]\n        },\n        \"alias\": {\n          \"type\": \"string\"\n        },\n        \"type\": {\n          \"type\": \"string\",\n          \"enum\": [\"String\", \"Number\"]\n        },\n        \"label\": {\n          \"type\": \"string\"\n        },\n        \"label_shrt\": {\n          \"type\": \"string\"\n        },\n        \"size\": {\n          \"type\": \"integer\",\n          \"minimum\": 1,\n          \"maximum\": 1000\n        },\n        \"help\": {\n          \"type\": \"string\"\n        },\n        \"uniq\": {\n          \"type\": \"boolean\"\n        },\n        \"view\": {\n          \"type\": \"object\",\n          \"properties\": {\n            \"priority\": {\n              \"type\": \"integer\",\n              \"minimum\": 1\n            },\n            \"default\": {\n              \"type\": \"boolean\"\n            }\n          }\n        }\n      }\n    },\n    \"ActionInput\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\"\n        },\n        \"label\": {\n          \"type\": \"string\"\n        },\n        \"type\": {\n          \"type\": \"string\"\n        },\n        \"beforetext\": {\n          \"type\": \"string\"\n        }\n      },\n      \"required\": [\"name\", \"label\", \"type\"]\n    },\n    \"ActionDiscard\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\",\n          \"enum\": [\"discard\"]\n        },\n        \"description\": {\n          \"type\": \"string\"\n        },\n        \"friendly_name\": {\n          \"type\": \"string\"\n        },\n        \"friendly_after\": {\n          \"type\": \"string\"\n        },\n        \"input\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"$ref\": \"#/definitions/ActionInput\"\n          }\n        }\n      }\n    },\n    \"ActionReplace\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\",\n          \"enum\": [\"replace\"]\n        },\n        \"description\": {\n          \"type\": \"string\"\n        },\n        \"input\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"$ref\": \"#/definitions/ActionInput\"\n          }\n        }\n      }\n    },\n    \"ActionSet\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\",\n          \"enum\": [\"set\"]\n        },\n        \"description\": {\n          \"type\": \"string\"\n        },\n        \"input\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"$ref\": \"#/definitions/ActionInput\"\n          }\n        }\n      }\n    },\n    \"ActionStop\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\",\n          \"enum\": [\"stop\"]\n        },\n        \"input\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"$ref\": \"#/definitions/ActionInput\"\n          }\n        }\n      }\n    },\n    \"ActionStopRuleSet\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\",\n          \"enum\": [\"stop_rule_set\"]\n        },\n        \"input\": {\n          \"type\": \"array\",\n          \"items\": {\n            \"$ref\": \"#/definitions/ActionInput\"\n          }\n        }\n      }\n    },\n    \"TimeStamp\": {\n      \"type\": \"integer\",\n      \"minimum\": 1\n    },\n    \"TimeStart\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"start\": {\n          \"$ref\": \"#/definitions/TimeStamp\"\n        }\n      }\n    },\n    \"TimeNow\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"now\": {\n          \"$ref\": \"#/definitions/TimeStamp\"\n        }\n      }\n    },\n    \"TimeUpdate\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"update\": {\n          \"$ref\": \"#/definitions/TimeStamp\"\n        }\n      }\n    },\n    \"Time\": {\n      \"type\": \"object\",\n      \"allOf\": [\n        {\n          \"$ref\": \"#/definitions/TimeStart\"\n        },\n        {\n          \"$ref\": \"#/definitions/TimeNow\"\n        },\n        {\n          \"$ref\": \"#/definitions/TimeUpdate\"\n        }\n      ]\n    },\n    \"Error\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"name\": {\n          \"type\": \"string\",\n          \"enum\": [\"error\"]\n        },\n        \"message\": {\n          \"type\": \"string\"\n        }\n      },\n      \"example\": {\n        \"name\": \"error\",\n        \"message\": \"Unauthorised\"\n      }\n    },\n    \"ApiKey\": {\n      \"type\": \"string\",\n      \"pattern\": \"^[a-zA-Z0-9]+$\"\n    },\n    \"ApiKeyRecord\": {\n      \"type\": \"object\",\n      \"properties\": {\n        \"_id\": {\n          \"type\": \"string\",\n          \"pattern\": \"[a-zA-Z0-9]+\"\n        },\n        \"username\": {\n          \"type\": \"string\"\n        },\n        \"__v\": {\n          \"type\": \"number\"\n        },\n        \"created\": {\n          \"type\": \"string\",\n          \"format\": \"date-time\"\n        },\n        \"apikey\": {\n          \"$ref\": \"#/definitions/ApiKey\"\n        }\n      },\n      \"required\": [\"_id\", \"username\", \"apikey\"]\n    }\n  },\n  \"responses\": {\n    \"200\": {\n      \"content\": {\n        \"application/json\": {\n          \"schema\": {\n            \"$ref\": \"#/definitions/GeneralApiResponse\"\n          }\n        }\n      }\n    },\n    \"Unauthorised\": {\n      \"description\": \"Unauthorised\",\n      \"content\": {\n        \"application/json\": {\n          \"schema\": {\n            \"$ref\": \"#/definitions/Error\"\n          }\n        }\n      }\n    },\n    \"NotFound\": {\n      \"description\": \"Not Found\",\n      \"content\": {\n        \"application/json\": {\n          \"schema\": {\n            \"$ref\": \"#/definitions/GeneralApiError\"\n          }\n        }\n      }\n    },\n    \"NotImplemented\": {\n      \"description\": \"Not implemented\",\n      \"content\": {\n        \"application/json\": {\n          \"schema\": {\n            \"$ref\": \"#/definitions/NameRecord\"\n          }\n        }\n      }\n    }\n  },\n  \"tags\": []\n}\n"
		}
	},
	"Error": "parse: parse spec: parse operations: paths: /rules/global: get: operation \"\": responses: 401: resolve \"#/responses/Unauthorised\" reference: invalid response reference: \"#/responses/Unauthorised\""
}