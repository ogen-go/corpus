{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/maasglobal/maas-tsp-api"
		},
		"file": {
			"name": "booking.yml",
			"size": 0,
			"path": "specs/booking.yml",
			"byteSize": 44062,
			"content": "openapi: 3.0.0\nservers:\n  - url: http://localhost:3000\n    description: Local server\ninfo:\n  version: 1.1.0\n  title: WhimApp TSP API\n  ## NB: All Markdown paragraphs need to be 2 empty lines and all Markdown links must be resolved against repo root (not against this file path)\n  ## Also x-logo must be resolved against repo root (not against this file path)\n  ## Examples (externalValue) and $ref are resolved relative to this file path\n  description: |\n    ## Introduction\n\n    This is an API specification of REST endpoints that a Transport Service\n    Provider (TSP) should implement to offer their services through the \n    [Whim application](https://whimapp.com/).\n\n    It is written in machine-readable [OpenAPI Specification](https://github.com/OAI/OpenAPI-Specification) format, \n    so that API endpoints, validators, and test clients can be generated from the\n    documentation.\n\n    ### Download \n\n    * OpenAPI Specification [JSON, single file document](./specs/booking.json)\n    * OpenAPI Specification [YAML](./specs/booking.yml)\n\n    ## Terminology\n\n    * **endpoint** Publically resolvable URL either managed by MaaS Global (Whim Backend API) or by TSP (Booking API).\n\n    * **booking** Information about single leg during the customer trip, together with customer information and state.\n\n    * **journey** Multi-leg trip which user plans via WhimApp.\n\n    * **leg** Single trip which is performed by TSP. Booking created and contain the state of this trip.\n\n    * **TSP** Transport service provider. MaaS Global partner which offers their services via WhimApp.\n\n    * **route** One of the possible journey. To determine it, we call TSP booking options endpoint to get available offers.\n\n    * **micromobility** Light vehicles such as electric scooters, shared bicycles and electric bicycles.\n\n    * **WhimApp** Mobile application or similar, which is used by Whim User to perform journeys. Collectively we treat all communication from the point of WhimApp and user experience during the time the user interacts with the application.\n\n    * **Whim backend** Caller of TSP API endpoints. WhimApp never calls TSP endpoints directly. All invocations are done from cloud-native infrastructure managed by MaaS Global.\n\n    * **MaaS Global** MaaS Global is the world’s first true Mobility-as-a-Service (MaaS) operator with its award-winning Whim app, which provides users all city transport services in one app.\n\n    ## Versions\n\n    ### 1.0.0 Initial release (2018)\n\n    **deprecated**\n      \n      * [OpenAPI Specification](specs/maas-v1.yml)\n      * [Documentation](?maas-v1.yml)\n      * [SwaggerUI](swagger-ui.html?urls.primaryName=maas-v1.yml)\n      * Source code [repository](https://github.com/maasglobal/maas-tsp-api/tree/v1.0)\n\n    ### 1.1.0 Current version\n\n    From this version onwards, this documentation are living documentation for current and future versions. Any specific features not available in production are marked as **1.X.X-future**.\n\n      * [OpenAPI Specification](specs/booking.json)\n      * [Documentation](?booking.json)\n      * [JSON Schema documentation](https://maasglobal.github.io/maas-schemas)\n      * [SwaggerUI](swagger-ui.html?urls.primaryName=booking.yml)\n      * Source code [repository](https://github.com/maasglobal/maas-tsp-api/)\n\n    ### 1.2.0 Future version\n\n      * Not yet available in production\n      * Marked by **v.1.2.0-future** in this documentation\n\n    ## Getting started\n\n    ### Running a local documentation server\n\n    To run local documentation server, follow the instructions in the [GitHub repo](https://github.com/maasglobal/maas-tsp-api/)\n\n        git clone https://github.com/maasglobal/maas-tsp-api/\n        cd maas-tsp-api\n        npm install\n        npm start\n\n    Open your browser and navigate to http://localhost:3000\n\n    \u003e ⚠️ You can change a port by specifying `PORT` env variable\n\n  contact:\n    name: Maas Global Team\n    email: tech@maas.global\n    url: 'https://github.com/maasglobal/maas-tsp-api'\n  license:\n    name: MIT\n    url: 'https://opensource.org/licenses/MIT'\n  x-logo:\n    url: 'assets/whim-logo.svg'\n    altText: 'Whim logo'\n    href: 'https://whimapp.com'\ntags:\n  - name: Booking lifecycle\n    description: |\n      The following scenario explains the life-cycle of an individual journey from a TSP viewpoint. Whenever a new concept (such as an actor or action is represented, it is imprinted in **bold**.\n\n      This scenario, with a few extra details, is shown in the sequence diagrams below. It should be noted from the picture that MaaS more often acts as a caller than a callee for Transport Service Provider. \n\n      ### TAXI \n\n      Taxi or Private Hire Vehicle (PHV) booking sequence flow, both on-demand and prebooking.\n\n      ![Taxi workflow](./specs/workflow/taxi-sequence.svg)\n\n      ### Docked Bike \n\n      Free ride and docked bike sharing.\n\n      ![Docked bike workflow](./specs/workflow/docked-bike-sequence.svg)\n\n      ## Booking explained\n\n      Booking represents state about one leg of a journey, connected with TSP specific information and state.\n\n      Data model as specified by [JSON Schema](https://maasglobal.github.io/maas-schemas/core/booking.html) allows representing information about any type of transport and state. To better understand how the booking works, let's take a look at the basic states and essential parts of the booking data.\n\n      ### State\n\n      Booking goes through multiple states during the journey; here are the most important states. Please see [Tracking booking](#section/Tracking-booking) on information on how WhimApp and TSP exchange this information.\n\n      | State | Description |\n      |-----|------|\n      | **RESERVED** | Booking created by calling [Create booking](#operation/bookingCreate) endpoint. |\n      | **CONFIRMED** | Booking confirmed, e.g. TAXI driver have accepted this order. We are waiting for this state update from TSP by periodically calling [Get booking](#operation/bookingGet) or waiting for webhook invocation via [Update booking state](#operation/backendBookingReceive) endpoint invocation. |\n      | **ARRIVED** | Not applicable for all modes of transportation. For TAXI means driver have arrived to the pickup point. We are waiting for this state update from TSP. |\n      | **ACTIVATED** | Booking has started. For TAXI means TAXI has picked up the passenger. We are waiting for this state update from some TSPs e.g. Taxi and will send this state update via [Update booking](#operation/bookingUpdate) call for car sharing and micromobility providers (to unlock car or a scooter and start a ride). |\n      | **ON_HOLD** | Booking still active but have been paused, for example for Car Sharing - lock the car but not finish the ride. We will send this state update via [Update booking](#operation/bookingUpdate) call. **v.1.2.0-future**: For docked bikes transition to this state reserves docking bay. | \n      | **EXPIRED** | Ride was completed. We are waiting for this state update from TSP. |\n      | **FINISHED** | Payment receipt reconcillation completed, for example for extra charges during Taxi ride, see [Get final booking receipt](#operation/bookingGetReceipt) endpoint. |\n      | **CANCELLED** | Cancelled by user. Booking can be subject to a fee or/and not be refundable as specified by TSP in booking cancellation rules. |\n      | **REJECTED** | Rejected by TSP. We can update with this state on **PENDING**, **RESERVED**, **CONFIRMED**, **ACTIVATED** state and show User message about the reason for rejection, as received from TSP. |\n\n      ### Taxi state\n\n      Flow for taxi, both for on-call and prebooking PHV (private hire vehicles) are shown below.\n\n      ![Taxi workflow](./specs/workflow/taxi.svg)\n\n      ### Rental car state\n\n      Flow for rental car\n\n      ![Rental car workflow](./specs/workflow/car-rental.svg)\n\n      ### Shared car state\n\n      Flow for car-sharing\n\n      ![Shared car workflow](./specs/workflow/car-sharing.svg)\n\n      ### Bike state\n\n      State flow for bike, scooter and other micromobility are shown below.\n\n      ![Bike workflow](./specs/workflow/bike.svg)\n\n      ### Docked bike state\n\n      Docked bike state, when you need to reserve a dock before you can return a bike.\n\n      \u003e ⚠️ ON_HOLD state for docked bikes only supported in version **v.1.2.0-future** which is not yet implemented.\n\n      ![Docked bike workflow](./specs/workflow/docked-bike.svg)\n\n      ### Structure\n\n      See examples for a [Create booking](#operation/bookingCreate) or schema for [Booking create](https://maasglobal.github.io/maas-schemas/#tspbooking-create) to understand all available data in a booking.\n\n      Here are the most essential parts of the booking data.\n\n      | State | Required? | Description |\n      |-----|------|------| \n      | `leg.from` | Y | Pickup point with name, address and coordinates (lat, long) |\n      | `leg.to` | N | Destination point with name, address and coordinates (lat, long) |\n      | `leg.startTime` | N | Start time of a trip, may be in future. |\n      | `leg.endTime` | N | End time of a trip, must be in future. |\n      | `leg.mode` | Y | Requested mode of transportation, i.e. TAXI |\n      | `customer` | Y | Customer information |\n      | `state` | Y | State of the booking |\n      | `meta` | Y | Information about TSP. Also contains driver for TAXI |\n      | `tspId` | Y | TSP specifid ID for this booking |\n      | `cost` | Y | Amount and currency this booking cost |\n\n      ## Planning a route\n\n      **User** **queries** for a **Route** with an address or latitude-longitude pair from one place to another. WhimApp queries the route from a third party **Routing Engine** that contains the data for **TSP** routes. At this point, WhimApp makes no queries to the TSP - it expects the Routing Engine contains valid GTFS data for the TSP.\n\n      \u003e ⚠️ Routing and GTFS are used only if applicable for TSP provider. For example, for micromobility providers, we don't use GTFS and route planning.\n\n      **WhimApp** shows several possible **Plans**, each containing a valid **Route** with several **Legs** with a part of a route using a specific TSP.\n\n      ## Booking options\n\n      To determine available mobility services, WhimApp calls [Available options](#operation/bookingOptionsGet) endpoint. Depending on the TSP mode of transportation, this endpoint returns available TAXIs or cars or bikes for the specified location. After User selection, one of the options is used to create a booking by calling [Create Booking](#operation/bookingCreate) endpoint.\n\n      | Related API   | Related schemas | Examples | \n      | --------- | --------- | ------ |\n      | [Available taxi types](#operation/bookingOptionsGet) | [tsp/booking-options-list](https://maasglobal.github.io/maas-schemas/#tspbooking-options-list) | TAXI - [response](examples/taxi/booking-options-response.json) |\n      | [Available scooters](#operation/bookingOptionsGet) | [tsp/booking-options-list](https://maasglobal.github.io/maas-schemas/#tspbooking-options-list) | SCOOTER - [response](examples/scooter/booking-options-response.json) |\n      | [Available cars](#operation/bookingOptionsGet) | [tsp/booking-options-list](https://maasglobal.github.io/maas-schemas/#tspbooking-options-list) | CAR SHARING - [response](examples/car/booking-options-response.json) |\n      | [Available bikes](#operation/bookingOptionsGet) | [tsp/booking-options-list](https://maasglobal.github.io/maas-schemas/#tspbooking-options-list) | DOCKED BIKE - [response](examples/bike/booking-options-response.json) |\n      | [Available stations](#operation/stationsGet) | [tsp/stations-list](https://maasglobal.github.io/maas-schemas/#tspstations-list) | DOCKED BIKE - [response](examples/bike/stations-list-response.json) |\n      | [Retrieve station](#operation/stationGet) | [tsp/stations-retrieve](https://maasglobal.github.io/maas-schemas/#tspstations-retrieve) | DOCKED BIKE - [response](examples/bike/stations-retrieve-response.json) |\n\n      ## Creating a booking\n\n      The User browses through the plans and chooses to book a journey. For each Leg in the Plan Route, WhimApp creates a new booking by invoking the corresponding endpoint in TSP.\n\n      It should be noted that the booking may be hours or days in advance - a bit like in booking a hotel. The booking contains the individual leg as the detailed travel plan for the TSP, as well as customer contact information.\n\n      \u003e ⚠️ Specific parts of customer information (E-mail, Phone, Last name, First name, etc.) which are sent to the TSP are subject to agreement between MaaS Global and TSP.\n\n      TSP receives the booking and confirms the trip. TSP may modify the details\n      of the booking, such as moving the **start location** to closest known\n      street address or delaying the Leg **start time**, as long as the\n      **end time** can be guaranteed. The booking is supplemented with\n      **booked** state information and additional **terms** such as\n      the latest **cancellation rules**.\n\n      WhimApp checks that the creation of booking succeeded and stores the booking for future reference.\n\n      \u003e ⚠️ User can also book a trip directly for the TAXI, car or micromobility transport (which will result in a journey with one leg)\n\n      | Related API   | Related schemas | Examples | \n      | --------- | --------- | ------ |\n      | [Create booking](#operation/bookingCreate) | [tsp/booking-create](https://maasglobal.github.io/maas-schemas/#tspbooking-create) | TAXI - [request](examples/taxi/booking-create-request.json), [response](examples/taxi/booking-create-response.json) |\n      | [Create booking](#operation/bookingCreate) | [tsp/booking-create](https://maasglobal.github.io/maas-schemas/#tspbooking-create) | SCOOTER - [request](examples/scooter/booking-create-request.json), [response](examples/scooter/booking-create-response.json) |\n      | [Create booking](#operation/bookingCreate) | [tsp/booking-create](https://maasglobal.github.io/maas-schemas/#tspbooking-create) | CAR SHARING - [request](examples/car/booking-create-request.json), [response](examples/car/booking-create-response.json) |\n      | [Create booking](#operation/bookingCreate) | [tsp/booking-create](https://maasglobal.github.io/maas-schemas/#tspbooking-create) | **v.1.2.0-future**: DOCKED BIKE -  [response](examples/bike/booking-create-response.json) |\n\n      ## Paying a booking\n\n      When booking created, it is already paid according to the options received and selected by User. See [Booking options](#section/Booking+options) for more information.\n\n      If the booking can not be created, the paid amount will be refunded to the User.\n\n      ## Navigating a route\n\n      The User starts to navigate the Route. WhimApp tracks for the user location to know if there are any changes needed in the plan. WhimApp triggers the changes for bookings by monitoring the individual legs.\n\n      WhimApp monitors the booking terms and Leg **start time**. When the actual Leg starts, WhimApp **starts** the Leg and notifies the TSP. User or TSP may request changes to the booking, e.g., in a case of a delay or cancellation.\n\n      Each of these scenarios is described below.\n\n      ## Updating a booking\n\n      A booking may be updated by a User or WhimApp when any party receives new information that the Leg needs to be changed. For example, when the User wants to change a destination. Such change may be subject to a fee, which should be reflected in response to update or when new booking retrieved via [Get booking](#operation/bookingGet) endpoint.\n\n      Also we update the booking when state for the booking changes, for example to start a ride on a scooter or shared car.\n\n      | Related API   | Related schemas | Examples | \n      | --------- | --------- | ------ |\n      | [Update booking](#operation/bookingUpdate) | [tsp/booking-update](https://maasglobal.github.io/maas-schemas/#tspbooking-update) | SCOOTER, finish a ride - [request](examples/scooter/booking-update-expired-request.json), [response](examples/scooter/booking-update-expired-response.json) |\n      | [Update booking](#operation/bookingUpdate) | [tsp/booking-update](https://maasglobal.github.io/maas-schemas/#tspbooking-update) | CAR SHARING, lock - [request](examples/car/booking-update-request-lock.json), [response](examples/car/booking-update-response-lock.json)|\n      | [Update booking](#operation/bookingUpdate) | [tsp/booking-update](https://maasglobal.github.io/maas-schemas/#tspbooking-update) | CAR SHARING, unlock - [request](examples/car/booking-update-request-unlock.json) |\n      | [Update booking](#operation/bookingUpdate) | [tsp/booking-update](https://maasglobal.github.io/maas-schemas/#tspbooking-update) | **v.1.2.0-future**: DOCKED BIKE, reserve dock - [request](examples/bike/booking-update-request-reserve-dock.json), [response](examples/bike/booking-update-response-reserve-dock.json) |\n\n      ## Cancelling a booking\n\n      A booking may be canceled by User or WhimApp as specified by **cancellation rules** in **terms** of the booking. WhimApp invokes a [Cancel booking](#operation/bookingCancel) endpoint. TSP confirms and updates its own systems. If TSP can not cancel booking, it returns a 403 Forbidden error.\n\n      It should be noted that cancellation is an exceptional case and is likely happen only when the user chooses to cancel the whole route Plan.\n\n      | Related API   | Related schemas | Examples | \n      | --------- | --------- | ------ |\n      | [Cancel booking](#operation/bookingCancel) | [tsp/booking-cancel](https://maasglobal.github.io/maas-schemas/#tspbooking-cancel  ) | CAR SHARING - [response](examples/car/booking-cancel-response.json) |\n\n      ## Tracking a booking\n\n      To provide a smooth user experience, it is very important to keep the booking state updated on the WhimApp side. To do this, we can use two approaches:\n\n      * We periodically check booking state, by calling [Get booking](#operation/bookingGet) endpoint\n      * TSP sends us latest update, by calling Whim Backend endpoint [Update booking state](#operation/backendBookingReceive)\n\n      While the latter is preferred way, MVP implementation can be created by only providing **required** [Get booking](#operation/bookingGet) endpoint.\n\n      | Related API   | Related schemas | Examples | \n      | --------- | --------- | ------ |\n      | [Get booking](#operation/bookingGet) | [tsp/booking-read-by-id](https://maasglobal.github.io/maas-schemas/#tspbooking-read-by-id) | TAXI - [RESERVED](examples/taxi/booking-read-by-id-response.json), [ACTIVATED](examples/taxi/booking-read-by-id-response-activated.json) |\n      | [Get booking](#operation/bookingGet) | [tsp/booking-read-by-id](https://maasglobal.github.io/maas-schemas/#tspbooking-read-by-id) | SCOOTER - [ACTIVATED](examples/scooter/booking-read-by-id-response-activated.json) |\n      | [Update booking state](#operation/backendBookingReceive) | [tsp/booking-read-by-id](https://maasglobal.github.io/maas-schemas/#tspbooking-read-by-id) | See [above](#section/Updating-a-booking) |\n      | [Get receipt](#operation/bookingGetReceipt) | [tsp/booking-receipt](https://maasglobal.github.io/maas-schemas/#tspbooking-receipt) | SCOOTER - [response](examples/scooter/booking-receipt-response.json) | \n\n      ## Error Cases\n\n      It may be possible that WhimApp sends an invalid request, or the TSP cannot fulfill a request. In any such case, TSP may respond with an error. If TSP responds with an error, WhimApp assumes the state was not changed (e.g., a transaction was rolled back). WhimApp may repeat the request with the same or different data later on.\n\n      The same principle applies when TSP is communicating with WhimApp.\n\n      The error response body are defined as JSON in [JSON Schema](https://maasglobal.github.io/maas-schemas/core/error.html#code) and can contain additional fields, e.g.\n\n      ```json\n      {\n        code: \"BOOKING_ALREADY_EXISTS\",\n        message: \"Active booking already exists for this user.\",\n        bookingId: \"deadbeefdeadbeefdeadcafe0000\"\n      }\n      ```\n    x-traitTag: true\n  - name: Booking\n    description: |\n      Booking related APIs are the core of a TSP implementation.\n\n      Correspondingly, a booking is the main object exchanged between WhimApp and a\n      TSP. For more information about booking, see [Booking explained](#section/Booking-explained)\n    x-traitTag: false\n    x-displayName: Booking API\n  - name: Stations\n    description: |\n      Stations available for public transport and micromobility docking.\n    x-traitTag: false\n    x-displayName: Stations API\n  - name: WebHook\n    description: |\n      Publically available API which you can call to send booking state changes immediately when they happen, without the need to for us to poll our system by calling [Get booking](#operation/bookingGet) multiple times.\n\n      These endpoints are treated as Webhooks, which TSP **may** call to make communication faster and booking process smoother.\n\n      \u003e ⚠️ The specific endpoint URL to be invoked are subject to agreement between TSP and MaaS Global.\n    x-traitTag: false\n    x-displayName: Whim Backend API\n  - name: Support\n    description: |\n      We would like to help you with code and other questions you might have.\n\n      Search our documentation, contact our [tech  team](mailto:tech@maas.global), or connect with our [sales team](https://whimapp.com/partners/).\n\n      ### Improving documentation\n\n      It would be great if you have anything to contribute to our documentation, you can do it by creating a fork and issuing a pull-request.\n\n      Or you can file an [issue](https://github.com/maasglobal/maas-tsp-api/issues) if you discover some problem or invalid information.\n\n      You also can reach the team via tech@maas.global\n    x-traitTag: true\n    x-displayName: Support\ncomponents:\n  securitySchemes:\n    apiKeyHeader:\n      in: header\n      name: X-API-Key\n      type: apiKey\n      description: |\n        Authorization scheme to use with TSP API should be based on specifying `X-API-Key` header when WhimApp makes a request to the TSP API.\n\n        *Please note* what due to serverless nature of our infrastructure we are unable to provide you with a set of IP addresses HTTP request will be originating from.\nsecurity:\n  - apiKeyHeader: []\npaths:\n  /bookings/options:\n    get:\n      operationId: bookingOptionsGet\n      summary: Available options\n      description: |\n        Returns available options or offers.\n\n        The options are used to construct a booking to be created after the User selects it by calling [Create booking](#operation/bookingCreate).\n\n        Full schema for parameters defined in [maas-schemas](https://maasglobal.github.io/maas-schemas/tsp/booking-options-list/request.html) project\n      tags:\n        - Booking\n      parameters:\n        - name: from\n          description: \"User's location in comma separated form e.g. 60.123,27.456\"\n          in: query\n          required: true\n          schema:\n            $ref: ../schemas/core/components/units-geo.json#/definitions/shortLocationString\n        - name: to\n          description: 'A desired destination e.g. 60.123,27.456'\n          in: query\n          required: false\n          schema:\n            $ref: ../schemas/core/components/units-geo.json#/definitions/shortLocationString\n        - name: startTime\n          description: 'Start journey time'\n          in: query\n          required: true\n          schema:\n            $ref: ../schemas/core/components/units.json#/definitions/time\n        - name: endTime\n          description: 'End journey time'\n          in: query\n          required: false\n          schema:\n            $ref: ../schemas/core/components/units.json#/definitions/time\n        - name: mode\n          description: 'Transfer mode'\n          in: query\n          required: false\n          schema:\n            $ref: ../schemas/core/components/travel-mode.json\n      x-code-samples:\n        - lang: Shell\n          label: Query for taxi\n          source: |\n            curl --location --request GET 'http://localhost:3000/bookings/options? \\\n              customer[clientId]=whim\u0026customer[locale]=en\u0026 \\\n              customer[opaqueId]=deadbeef-deadbeef\u0026 \\\n              customer[phone]=+35840000000\u0026 \\\n              distance=9734\u0026endTime=1572347575000\u0026 \\\n              from=60.1769789,24.9504135\u0026 \\\n              fromAddress=streetName:Siltasaarenkatu|streetNumber:1|city:Helsinki|zipCode:00530|country:Suomi\u0026fromName=Siltasaarenkatu%201%20Helsinki\u0026 \\\n              mode=TAXI\u0026 \\\n              startTime=1572347575000\u0026 \\\n              tspProductIds=testtaxi1-product1\u0026 \\\n              to=60.23044350000001,24.8990183\u0026 \\\n              toAddress=streetName:Ida%20Aalbergin%20tie|streetNumber:3|city:Helsinki|zipCode:00400|country:Suomi\u0026 \\\n              toName=Ida%20Aalbergin%20tie%203%20Helsinki' \\\n                --header \"x-api-key: pieY8Oezeicioyei5eisheeb7sheeLie\"\n        - lang: Shell\n          label: Query for scooter\n          source: |\n            curl --location --request GET 'http://localhost:3000/bookings/options? \\\n              customer[clientId]=whim\u0026customer[locale]=en\u0026 \\\n              customer[opaqueId]=deadbeef-deadbeef\u0026 \\\n              customer[phone]=+358400001010\u0026 \\\n              customer[firstName]=Tester\u0026 \\\n              customer[lastName]=Test\u0026 \\\n              endTime=1577969729830\u0026 \\\n              from=60.1769789,24.9504135\u0026 \\\n              fromRadius=400\u0026 \\\n              mode=SCOOTER\u0026 \\\n              tspProductIds=scooterinc1\u0026 \\\n              startTime=1577966129830\u0026 \\\n              to=60.1769789,24.9504135\u0026' \\\n                --header \"x-api-key: pieY8Oezeicioyei5eisheeb7sheeLie\"\n        - lang: Shell\n          label: Query for car sharing\n          source: |\n            curl --location --request GET 'http://localhost:3000/bookings/options? \\\n              customer[clientId]=whim\u0026customer[locale]=en\u0026 \\\n              customer[opaqueId]=deadbeef-deadbeef\u0026 \\\n              customer[phone]=+358400001010\u0026 \\\n              customer[firstName]=Tester\u0026 \\\n              customer[lastName]=Test\u0026 \\\n              endTime=1577969729830\u0026 \\\n              from=60.1769789,24.9504135\u0026 \\\n              fromRadius=20000\u0026 \\\n              mode=CAR\u0026 \\\n              tspProductIds=carsharingabc1\u0026 \\\n              startTime=1577966129830\u0026 \\\n              to=60.1769789,24.9504135\u0026' \\\n                --header \"x-api-key: pieY8Oezeicioyei5eisheeb7sheeLie\"\n      responses:\n        '200':\n          x-summary: Array of options\n          description: |\n            Available transport options matching the given query parameters. If no transport options are available; an empty array is returned.\n\n            ### JSON Schema documentation\n\n            Full schema for response defined in [maas-schemas](https://maasglobal.github.io/maas-schemas/tsp/booking-options-list/response.html) project\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/tsp/booking-options-list/response.json\n              examples:\n                Taxi:\n                  summary: Taxi\n                  externalValue: '../examples/taxi/booking-options-response.json'\n                Scooter:\n                  summary: Scooter\n                  externalValue: '../examples/scooter/booking-options-response.json'\n                CarSharing:\n                  summary: Car sharing\n                  externalValue: '../examples/car/booking-options-response.json'\n  /bookings:\n    post:\n      operationId: bookingCreate\n      summary: Create booking\n      description: |\n        Creates a new booking for the TSP in **RESERVED** state. \n\n        The returned object will be a reference that is passed back \u0026 forth throughout the booking lifecycle.\n\n        Booking request are based upon the response returned by calling [Available options](#operation/bookingOptionsGet) endpoint.\n\n        The booking may be modified in the response, e.g., the location can be adjusted for a more suitable pick-up location.\n\n        In addition, the service may contain a **meta** attribute for arbitrary TSP metadata that the TSP needs later, and **token** attribute depicting how long the current state is valid.\n\n        ### JSON Schema documentation\n\n        Full schema for request defined in [maas-schemas](https://maasglobal.github.io/maas-schemas/tsp/booking-create/request.html) project\n      tags:\n        - Booking\n      requestBody:\n        content:\n          application/json:\n            schema:\n              $ref: ../schemas/tsp/booking-create/request.json\n            examples:\n              Taxi:\n                summary: Taxi\n                externalValue: ../examples/taxi/booking-create-request.json\n              Scooter:\n                summary: Scooter\n                externalValue: ../examples/scooter/booking-create-request.json\n              CarSharing:\n                summary: Car sharing\n                externalValue: ../examples/car/booking-create-request.json\n        description: |\n          Parameters of booking to be created, optionally referencing \n          offerId returned on the `/bookings/options` call.\n        required: true\n      responses:\n        '200':\n          x-summary: Booking\n          description: |\n            Booking information. For more information about the booking, see [Booking explained](#section/Booking-explained).\n            \n            ### JSON Schema documentation\n\n            Full schema for response defined in [maas-schemas](https://maasglobal.github.io/maas-schemas/tsp/booking-create/response.html) project\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/tsp/booking-create/response.json\n              examples:\n                Taxi:\n                  summary: Taxi\n                  externalValue: ../examples/taxi/booking-create-response.json\n                Scooter:\n                  summary: Scooter\n                  externalValue: ../examples/scooter/booking-create-response.json\n                CarSharing:\n                  summary: Car sharing\n                  externalValue: ../examples/car/booking-create-response.json\n        '400':\n          description: Bad request\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        '401':\n          description: Authorization error (invalid API key)\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        '409':\n          description: |\n            Another Booking exists for this User.\n\n            If TSP does not support more than one booking per user, it can indicate it by sending this response when \n            WhimApp creates a new booking. Booking ID can be specified as an extra property in a response. See [Error Cases](#section/Error-Cases) for more information.\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        default:\n          description: unexpected error\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n  /bookings/{tspId}:\n    get:\n      operationId: bookingGet\n      summary: Get booking\n      description: |\n        Returns the booking that has been created earlier.\n\n        ### JSON Schema documentation\n\n        Full schema for response defined in [maas-schemas](https://maasglobal.github.io/maas-schemas/tsp/booking-read-by-id/response.html) project\n      tags:\n        - Booking\n      parameters:\n        - name: tspId\n          description: ID of the booking created earlier\n          in: path\n          required: true\n          schema:\n            $ref: ../schemas/core/booking.json#/definitions/tspId\n      responses:\n        '200':\n          description: The booking matching the query\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/tsp/booking-read-by-id/response.json\n              examples:\n                Taxi1:\n                  summary: Taxi - RESERVED\n                  externalValue: '../examples/taxi/booking-read-by-id-response.json'\n                Taxi2:\n                  summary: Taxi - ACTIVATED\n                  externalValue: '../examples/taxi/booking-read-by-id-response-activated.json'\n                Scooter:\n                  summary: Scooter - ACTIVATED\n                  externalValue: '../examples/scooter/booking-read-by-id-response-activated.json'\n        '400':\n          description: Bad request (invalid query parameters)\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        '401':\n          description: Authorization error (invalid API key)\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        default:\n          description: unexpected error\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n    patch:\n      operationId: bookingUpdate\n      summary: Update booking\n      description: |\n        Update booking, changing state, or changing booking details.\n\n        ### JSON Schema documentation\n\n        Full schema for request defined in [maas-schemas](https://maasglobal.github.io/maas-schemas/tsp/booking-update/request.html) project\n      tags:\n        - Booking\n      parameters:\n        - name: tspId\n          description: ID of the booking created earlier\n          in: path\n          required: true\n          schema:\n            $ref: ../schemas/core/booking.json#/definitions/tspId\n      requestBody:\n        content:\n          application/json:\n            schema:\n              $ref: ../schemas/tsp/booking-update/request.json\n            examples:\n              carSharingLock:\n                summary: Lock a car\n                externalValue: ../examples/car/booking-update-request-lock.json\n              carSharingUnlock:\n                summary: Unlock a car\n                externalValue: ../examples/car/booking-update-request-unlock.json\n              scooterReturn:\n                summary: Return scooter\n                externalValue: ../examples/scooter/booking-update-expired-request.json\n      responses:\n        '200':\n          description: Updated, old booking returned\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/tsp/booking-update/response.json\n              examples:\n                CarSharing:\n                  summary: Car sharing response lock\n                  externalValue: '../examples/car/booking-update-response-lock.json'\n        '204':\n          description: Updated, no content returned\n        '400':\n          description: Bad request\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        '401':\n          description: Authorization error (invalid API key)\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        default:\n          description: unexpected error\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n    delete:\n      operationId: bookingCancel\n      summary: Cancel booking\n      description: |\n        Cancel booking if it is possible.\n\n        Cancel can be subject to a fee, as returned by 200 OK response to this method.\n      tags:\n        - Booking\n      parameters:\n        - name: tspId\n          description: ID of the booking created earlier\n          in: path\n          required: true\n          schema:\n            $ref: ../schemas/core/booking.json#/definitions/tspId\n      responses:\n        '200':\n          description: Deleted, old booking returned\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/tsp/booking-cancel/response.json\n              examples:\n                CarSharing:\n                  summary: Car sharing cancel\n                  externalValue: '../examples/car/booking-cancel-response.json'\n        '204':\n          description: Deleted, no content returned\n        '400':\n          description: Bad request\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        '401':\n          description: Authorization error (invalid API key)\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        '403':\n          description: Cancellation forbidden\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        default:\n          description: unexpected error\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n  /bookings/{tspId}/receipt:\n    get:\n      operationId: bookingGetReceipt\n      summary: Get final booking receipt\n      description: |\n        Get finalized pricing and receipt for the booking.\n\n        ### JSON Schema documentation\n\n        Full schema for response defined in [maas-schemas](https://maasglobal.github.io/maas-schemas/tsp/booking-receipt/response.html) project\n      tags:\n        - Booking\n      parameters:\n        - name: tspId\n          description: ID of the booking created earlier\n          in: path\n          required: true\n          schema:\n            $ref: ../schemas/core/booking.json#/definitions/tspId\n      responses:\n        '200':\n          description: The bookings matching the query with final receipt\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/booking.json\n              examples:\n                Scooter:\n                  summary: Scooter\n                  externalValue: '../examples/scooter/booking-receipt-response.json'\n        '400':\n          description: Bad request (invalid query parameters)\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        '401':\n          description: Authorization error (invalid API key)\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        '404':\n          description: Receipt not ready\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        default:\n          description: unexpected error\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n  /stations:\n    get:\n      operationId: stationsGet\n      summary: Get stations\n      description: |\n        Returns the list of stations\n\n        ### JSON Schema documentation\n\n        Full schema for response defined in [maas-schemas](https://maasglobal.github.io/maas-schemas/tsp/stations-list/response.html) project\n      tags:\n        - Stations\n      parameters:\n        - name: location\n          description: Starting point\n          in: query\n          required: true\n          schema:\n            $ref: ../schemas/core/components/units-geo.json#/definitions/shortLocationString\n        - name: radius\n          description: Radius to look for stations in, if not specified return all stations.\n          in: query\n          required: false\n          schema:\n            $ref: ../schemas/core/components/units-geo.json#/definitions/distance\n        - name: type\n          description: Type of points to return\n          in: query\n          required: false\n          schema:\n            type: string\n      responses:\n        '200':\n          description: The stations matching the query\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/tsp/stations-list/response.json\n              examples:\n                Bikes1:\n                  summary: Docked bike stations\n                  externalValue: '../examples/bike/stations-list-response.json'\n        '400':\n          description: Bad request (invalid query parameters)\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        '401':\n          description: Authorization error (invalid API key)\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        default:\n          description: unexpected error\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n  /stations/{id}:\n    get:\n      operationId: stationGet\n      summary: Get station\n      description: |\n        Returns the information about the specific station\n\n        ### JSON Schema documentation\n\n        Full schema for response defined in [maas-schemas](https://maasglobal.github.io/maas-schemas/tsp/stations-retrieve/response.html) project\n      tags:\n        - Stations\n      parameters:\n        - name: id\n          description: ID of the station\n          in: path\n          required: true\n          schema:\n            $ref: ../schemas/core/components/station.json#/definitions/id\n        - name: agencyId\n          description: TSP provider id which this station belongs to\n          in: query\n          required: true\n          schema:\n            $ref: ../schemas/core/components/common.json#/definitions/agencyId\n      responses:\n        '200':\n          description: Information about a single station\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/tsp/stations-retrieve/response.json\n              examples:\n                Bikes1:\n                  summary: Docked bike stations\n                  externalValue: '../examples/bike/stations-retrieve-response.json'\n        '400':\n          description: Bad request (invalid query parameters)\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        '401':\n          description: Authorization error (invalid API key)\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n        default:\n          description: unexpected error\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n  /backend/booking/{tspId}:\n    patch:\n      operationId: backendBookingReceive\n      summary: Receive updated booking state\n      description: |\n        Updates booking information at the WhimApp backend. \n\n        It is called by the TSP whenever the state of the booking are updated.\n\n        ### JSON Schema documentation\n\n        Full schema for payload defined in [maas-schemas](https://maasglobal.github.io/maas-schemas/tsp/webhooks-bookings-update/remote-request.html) project\n      parameters:\n        - name: tspId\n          description: ID of the booking created earlier\n          in: path\n          required: true\n          schema:\n            $ref: ../schemas/core/booking.json#/definitions/tspId\n      tags:\n        - WebHook\n      requestBody:\n        content:\n          application/json:\n            schema:\n              $ref: ../schemas/tsp/webhooks-bookings-update/remote-request.json\n            examples:\n              Taxi:\n                summary: Taxi\n                externalValue: '../examples/taxi/webhook-booking-update-status.json'\n        description: |\n          Booking information with updated state.\n        required: true\n      responses:\n        '204':\n          x-summary: Acknowledged\n          description: |\n            Received, no state.\n        '400':\n          description: Bad request (data failed validation)\n          content:\n            application/json:\n              schema:\n                $ref: ../schemas/core/error.json\n"
		}
	},
	"Error": "parse: parse spec: parse operations: paths: /bookings/{tspId}: get: operation \"bookingGet\": parameters: parse parameter \"tspId\": schema: parse schema: resolve \"../schemas/core/booking.json#/definitions/tspId\": find schema: external base \"../schemas/core/booking.json\" is not supported"
}