{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/wikimedia/restbase"
		},
		"file": {
			"name": "transform.yaml",
			"size": 0,
			"path": "v1/transform.yaml",
			"byteSize": 19392,
			"content": "openapi: 3.0.1\ninfo:\n  version: 1.0.0-beta\n  title: MediaWiki Content API\n  description: Basic MediaWiki content api.\n  termsofservice: https://github.com/wikimedia/restbase#restbase\n  contact:\n    name: Services\n    email: services@lists.wikimedia.org\n    url: https://www.mediawiki.org/wiki/Services\n  license:\n    name: Apache licence, v2\n    url: https://www.apache.org/licenses/LICENSE-2.0\ntags:\n  - name: Transforms\n    description: convert content between HTML and Wikitext\npaths:\n  /html/to/wikitext:\n    post: \u0026html_to_wikitext_post_spec\n      tags:\n        - Transforms\n      summary: Transform HTML to Wikitext\n      description: |\n        Transform [Parsoid HTML](https://www.mediawiki.org/wiki/Parsoid/MediaWiki_DOM_spec)\n        to Wikitext.\n\n        When converting pre-existing (possibly modified) content, you should\n        pass in the `title`, `revision`, and `If-Match` header. This lets\n        [Parsoid](https://www.mediawiki.org/wiki/Parsoid) preserve small\n        syntactic variations in wikitext, which ensures that diffs are\n        readable.\n\n        - Stability: [stable](https://www.mediawiki.org/wiki/API_versioning#Stable)\n        - Rate limit: 25 req/s\n      parameters:\n        - name: if-match\n          in: header\n          description: |\n            The `ETag` header of the original render indicating it's revision and timeuuid.\n            Required if both `title` and `revision` parameters are present.\n          schema:\n            type: string\n      requestBody:\n        content:\n          multipart/form-data:\n            schema:\n              required:\n                - html\n              properties:\n                html:\n                  type: string\n                  description: The HTML to transform\n                  x-textarea: true\n                scrub_wikitext:\n                  type: boolean\n                  description: Normalise the DOM to yield cleaner wikitext?\n        required: true\n      responses:\n        200:\n          description: MediaWiki Wikitext.\n          content:\n            text/plain; charset=utf-8; profile=\"https://www.mediawiki.org/wiki/Specs/wikitext/1.0.0\":\n              schema:\n                type: string\n        403:\n          description: Access to the specific revision is restricted\n          content:\n            application/problem+json:\n              schema:\n                $ref: '#/components/schemas/problem'\n        404:\n          description: Unknown page title or revision\n          content:\n            application/problem+json:\n              schema:\n                $ref: '#/components/schemas/problem'\n        409:\n          description: Revision was restricted\n          content:\n            application/problem+json:\n              schema:\n                $ref: '#/components/schemas/problem'\n        410:\n          description: Page was deleted\n          content:\n            application/problem+json:\n              schema:\n                $ref: '#/components/schemas/problem'\n        default:\n          description: Error\n          content:\n            application/problem+json:\n              schema:\n                $ref: '#/components/schemas/problem'\n      x-route-filters:\n        - type: default\n          name: ratelimit_route\n          options:\n            limits:\n              # T276485: Due to recent proxy changes requests from clients such as MediaWiki\n              # appear as internal requests and is causing high alerts\n              # internal: 10\n              external: 25\n\n      x-request-handler:\n        - get_from_backend:\n            request:\n              uri: /{domain}/sys/parsoid/transform/html/to/wikitext\n              headers:\n                if-match: '{{if-match}}'\n              body:\n                html: '{{html}}'\n                scrub_wikitext: '{{scrub_wikitext}}'\n      x-monitor: false\n\n  /html/to/wikitext/{title}:\n    post:\n      \u003c\u003c: *html_to_wikitext_post_spec\n      parameters:\n        - name: title\n          in: path\n          description: 'Page title. Use underscores instead of spaces. Use percent-encoding. Example: `Main_Page`.'\n          required: true\n          schema:\n            type: string\n        - name: if-match\n          in: header\n          description: |\n            The `ETag` header of the original render indicating it's revision and timeuuid.\n            Required if both `title` and `revision` parameters are present.\n          schema:\n            type: string\n      requestBody:\n        content:\n          multipart/form-data:\n            schema:\n              required:\n                - html\n              properties:\n                html:\n                  type: string\n                  description: The HTML to transform\n                  x-textarea: true\n                scrub_wikitext:\n                  type: boolean\n                  description: Normalise the DOM to yield cleaner wikitext?\n        required: true\n      x-request-handler:\n        - get_from_backend:\n            request:\n              uri: /{domain}/sys/parsoid/transform/html/to/wikitext/{title}\n              headers:\n                if-match: '{{if-match}}'\n              body:\n                html: '{{html}}'\n                scrub_wikitext: '{{scrub_wikitext}}'\n\n  /html/to/wikitext/{title}/{revision}:\n    post:\n      \u003c\u003c: *html_to_wikitext_post_spec\n      parameters:\n        - name: title\n          in: path\n          description: 'Page title. Use underscores instead of spaces. Use percent-encoding. Example: `Main_Page`.'\n          required: true\n          schema:\n            type: string\n        - name: revision\n          in: path\n          description: The page revision\n          required: true\n          schema:\n            type: integer\n        - name: if-match\n          in: header\n          description: |\n            The `ETag` header of the original render indicating it's revision and timeuuid.\n            Required if both `title` and `revision` parameters are present.\n          schema:\n            type: string\n      requestBody:\n        content:\n          multipart/form-data:\n            schema:\n              required:\n                - html\n              properties:\n                html:\n                  type: string\n                  description: The HTML to transform\n                  x-textarea: true\n                scrub_wikitext:\n                  type: boolean\n                  description: Normalise the DOM to yield cleaner wikitext?\n        required: true\n      x-request-handler:\n        - get_from_backend:\n            request:\n              uri: /{domain}/sys/parsoid/transform/html/to/wikitext/{title}/{revision}\n              headers:\n                if-match: '{{if-match}}'\n              body:\n                html: '{{html}}'\n                scrub_wikitext: '{{scrub_wikitext}}'\n\n  /wikitext/to/html:\n    post: \u0026wikitext_to_html_post_spec\n      tags:\n        - Transforms\n      summary: Transform Wikitext to HTML\n      description: |\n        Transform wikitext to HTML. Note that if you set `stash: true`, you\n        also need to supply the title.\n\n        - Stability: [stable](https://www.mediawiki.org/wiki/API_versioning#Stable)\n        - Rate limit: 25 req/s (5 req/s when `stash: true`)\n      requestBody:\n        content:\n          multipart/form-data:\n            schema:\n              required:\n                - wikitext\n              properties:\n                wikitext:\n                  type: string\n                  description: The Wikitext to transform to HTML\n                  x-textarea: true\n                body_only:\n                  type: boolean\n                  description: Return only `body.innerHTML`\n                stash:\n                  type: boolean\n                  description: Whether to temporarily stash the result of the transformation\n        required: true\n      responses:\n        200:\n          description: See wikipage https://www.mediawiki.org/wiki/Parsoid/MediaWiki_DOM_spec\n          content:\n            text/html; charset=utf-8; profile=\"https://www.mediawiki.org/wiki/Specs/HTML/2.1.0\":\n              schema:\n                type: string\n        403:\n          description: access to the specific revision is restricted\n          content:\n            application/problem+json:\n              schema:\n                $ref: '#/components/schemas/problem'\n        404:\n          description: Unknown page title or revision\n          content:\n            application/problem+json:\n              schema:\n                $ref: '#/components/schemas/problem'\n        409:\n          description: Revision was restricted\n          content:\n            application/problem+json:\n              schema:\n                $ref: '#/components/schemas/problem'\n        410:\n          description: Page was deleted\n          content:\n            application/problem+json:\n              schema:\n                $ref: '#/components/schemas/problem'\n        default:\n          description: Error\n          content:\n            application/problem+json:\n              schema:\n                $ref: '#/components/schemas/problem'\n      x-route-filters:\n        - type: default\n          name: ratelimit_route\n          options:\n            limits:\n              # T276485: Due to recent proxy changes requests from clients such as MediaWiki\n              # appear as internal requests and is causing high alerts\n              # internal: 10\n              external: 25\n\n      x-request-handler:\n        - get_from_backend:\n            request:\n              uri: /{domain}/sys/parsoid/transform/wikitext/to/html\n              body:\n                wikitext: '{{wikitext}}'\n                body_only: '{{body_only}}'\n                stash: '{{stash}}'\n      x-monitor: false\n\n  /wikitext/to/html/{title}:\n    post:\n      \u003c\u003c: *wikitext_to_html_post_spec\n      parameters:\n        - name: title\n          in: path\n          description: 'Page title. Use underscores instead of spaces. Use percent-encoding. Example: `Main_Page`.'\n          required: true\n          schema:\n            type: string\n      requestBody:\n        content:\n          multipart/form-data:\n            schema:\n              required:\n                - wikitext\n              properties:\n                wikitext:\n                  type: string\n                  description: The Wikitext to transform to HTML\n                  x-textarea: true\n                body_only:\n                  type: boolean\n                  description: Return only `body.innerHTML`\n                stash:\n                  type: boolean\n                  description: Whether to temporarily stash the result of the transformation\n        required: true\n      x-request-handler:\n        - get_from_backend:\n            request:\n              uri: /{domain}/sys/parsoid/transform/wikitext/to/html/{title}\n              body:\n                wikitext: '{{wikitext}}'\n                body_only: '{{body_only}}'\n                stash: '{{stash}}'\n      x-monitor: true\n      x-amples:\n        - title: Transform wikitext to html\n          request:\n            params:\n              domain: en.wikipedia.org\n              title: User:BSitzmann_(WMF)/MCS/Test/Frankenstein\n            body:\n              wikitext: == Heading ==\n              body_only: true\n          response:\n            status: 200\n            headers:\n              content-type: /^text\\/html.+/\n            body: /^\u003ch2.*\u003eHeading\u003c\\/h2\u003e$/\n\n  /wikitext/to/html/{title}/{revision}:\n    post:\n      \u003c\u003c: *wikitext_to_html_post_spec\n      parameters:\n        - name: title\n          in: path\n          description: 'Page title. Use underscores instead of spaces. Use percent-encoding. Example: `Main_Page`.'\n          required: true\n          schema:\n            type: string\n        - name: revision\n          in: path\n          description: The page revision\n          required: true\n          schema:\n            type: integer\n      requestBody:\n        content:\n          multipart/form-data:\n            schema:\n              required:\n                - wikitext\n              properties:\n                wikitext:\n                  type: string\n                  description: The Wikitext to transform to HTML\n                  x-textarea: true\n                body_only:\n                  type: boolean\n                  description: Return only `body.innerHTML`\n                stash:\n                  type: boolean\n                  description: Whether to temporarily stash the result of the transformation\n        required: true\n      x-request-handler:\n        - get_from_backend:\n            request:\n              uri: /{domain}/sys/parsoid/transform/wikitext/to/html/{title}/{revision}\n              body:\n                wikitext: '{{wikitext}}'\n                body_only: '{{body_only}}'\n                stash: '{{stash}}'\n\n  /wikitext/to/lint:\n    post: \u0026wikitext_to_lint_post_spec\n      tags:\n        - Transforms\n      summary: Check Wikitext for lint errors\n      description: |\n        Parse the supplied wikitext and check it for lint errors.\n\n        - Stability: [experimental](https://www.mediawiki.org/wiki/API_versioning#Experimental)\n        - Rate limit: 25 req/s\n      requestBody:\n        content:\n          multipart/form-data:\n            schema:\n              required:\n                - wikitext\n              properties:\n                wikitext:\n                  type: string\n                  description: The Wikitext to check\n                  x-textarea: true\n          application/json:\n            schema:\n              required:\n                - wikitext\n              properties:\n                wikitext:\n                  type: string\n                  description: The Wikitext to check\n                  x-textarea: true\n        required: true\n      responses:\n        200:\n          description: Linter errors, if any, as a JSON blob\n          content:\n            application/json:\n              schema:\n                type: object\n        404:\n          description: Unknown page title\n          content:\n            application/problem+json:\n              schema:\n                $ref: '#/components/schemas/problem'\n        409:\n          description: Latest revision was restricted\n          content:\n            application/problem+json:\n              schema:\n                $ref: '#/components/schemas/problem'\n        410:\n          description: Page was deleted\n          content:\n            application/problem+json:\n              schema:\n                $ref: '#/components/schemas/problem'\n        default:\n          description: Error\n          content:\n            application/problem+json:\n              schema:\n                $ref: '#/components/schemas/problem'\n      x-route-filters:\n        - type: default\n          name: ratelimit_route\n          options:\n            limits:\n              # T276485: Due to recent proxy changes requests from clients such as MediaWiki\n              # appear as internal requests and is causing high alerts\n              # internal: 10\n              external: 25\n\n      x-request-handler:\n        - get_from_backend:\n            request:\n              uri: /{domain}/sys/parsoid/transform/wikitext/to/lint\n              body:\n                wikitext: '{{wikitext}}'\n      x-monitor: false\n\n  /wikitext/to/lint/{title}:\n    post:\n      \u003c\u003c: *wikitext_to_lint_post_spec\n      parameters:\n        - name: title\n          in: path\n          description: 'Page title. Use underscores instead of spaces. Use percent-encoding. Example: `Main_Page`.'\n          required: true\n          schema:\n            type: string\n      requestBody:\n        content:\n          multipart/form-data:\n            schema:\n              required:\n                - wikitext\n              properties:\n                wikitext:\n                  type: string\n                  description: The Wikitext to check\n                  x-textarea: true\n        required: true\n      x-request-handler:\n        - get_from_backend:\n            request:\n              uri: /{domain}/sys/parsoid/transform/wikitext/to/lint/{title}\n              body:\n                wikitext: '{{wikitext}}'\n\n  /wikitext/to/lint/{title}/{revision}:\n    post:\n      \u003c\u003c: *wikitext_to_lint_post_spec\n      parameters:\n        - name: title\n          in: path\n          description: 'Page title. Use underscores instead of spaces. Use percent-encoding. Example: `Main_Page`.'\n          required: true\n          schema:\n            type: string\n        - name: revision\n          in: path\n          description: The page revision\n          required: true\n          schema:\n            type: integer\n      requestBody:\n        content:\n          multipart/form-data:\n            schema:\n              required:\n                - wikitext\n              properties:\n                wikitext:\n                  type: string\n                  description: The Wikitext to check\n                  x-textarea: true\n        required: true\n      x-request-handler:\n        - get_from_backend:\n            request:\n              uri: /{domain}/sys/parsoid/transform/wikitext/to/lint/{title}/{revision}\n              body:\n                wikitext: '{{wikitext}}'\n\n# Keeping this in, as we'll re-introduce a html2html end point later.\n#  /html/to/html{/title}{/revision}:\n#    post:\n#      tags:\n#        - Transforms\n#\n#      description: |\n#        Update / refresh / sanitize HTML\n#\n#        Stability: [unstable](https://www.mediawiki.org/wiki/API_versioning#Unstable)\n#      consumes:\n#        - multipart/form-data\n#      produces:\n#        - text/html; charset=utf-8; profile=\"https://www.mediawiki.org/wiki/Specs/HTML/2.1.0\"\n#        - application/problem+json\n#      parameters:\n#        - name: title\n#          in: path\n#          description: The page title\n#          type: string\n#          required: false\n#        - name: revision\n#          in: path\n#          description: The page revision\n#          type: integer\n#          required: false\n#        - name: html\n#          in: formData\n#          description: The HTML to transform\n#          type: string\n#          required: true\n#          x-textarea: true\n#        - name: body_only\n#          in: formData\n#          description: Return only `body.innerHTML`\n#          type: boolean\n#          required: false\n#      responses:\n#        '200':\n#          description: See wikipage https://www.mediawiki.org/wiki/Parsoid/MediaWiki_DOM_spec\n#        '403':\n#          description: access to the specific revision is restricted\n#          schema:\n#            $ref: '#/definitions/problem'\n#        '404':\n#          description: Unknown page title or revision\n#          schema:\n#            $ref: '#/definitions/problem'\n#        '409':\n#          description: Revision was restricted\n#          schema:\n#            $ref: '#/definitions/problem'\n#        '410':\n#          description: Page was deleted\n#          schema:\n#            $ref: '#/definitions/problem'\n#        default:\n#          description: Error\n#          schema:\n#            $ref: '#/definitions/problem'\n#      x-request-handler:\n#        - get_from_backend:\n#            request:\n#              uri: /{domain}/sys/parsoid/transform/html/to/html{/title}{/revision}\n#              headers:\n#                if-match: '{if-match}'\n#              body:\n#                html: '{html}'\n#                body_only: '{body_only}'\n#      x-monitor: false\n"
		}
	},
	"Error": "parse: parse spec: paths: /wikitext/to/html/{title}/{revision}: post: operation \"\": responses: 409: content: \"application/problem+json\": schema: parse schema: reference \"#/components/schemas/problem\": resolve reference \"#/components/schemas/problem\": schema not found"
}