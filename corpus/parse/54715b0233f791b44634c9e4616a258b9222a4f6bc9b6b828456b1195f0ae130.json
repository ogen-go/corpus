{
	"File": {
		"__typename": "FileMatch",
		"repository": {
			"name": "github.com/consumer-reports-digital-lab/data-rights-protocol"
		},
		"file": {
			"name": "openapi.yaml",
			"size": 0,
			"path": "openapi.yaml",
			"byteSize": 6864,
			"content": "openapi: 3.0.0\ninfo:\n  version: 0.4\n  title: Data Rights Protocol - PIP Interface\n\nservers:\n- url: http://localhost:9000/drp\n\ncomponents:\n  schemas:\n    JSONWebToken:\n      oneOf:\n        # - $ref: \"#/components/schemas/JSONSerializedJWT\"\n        - $ref: \"#/components/schemas/FlattenedJSONSerializedJWT\"\n        - $ref: \"#/components/schemas/StringSerializedJWT\"\n    \n    JWTClaims:\n      type: object\n      format: base64\n      required:\n        - iss\n        - aud\n      properties:\n        iss:\n          type: string\n        aud:\n          type: string\n        sub:\n          type: string\n        # user claims\n        name:\n          type: string\n        email:\n          type: string\n          format: email\n        email_verified:\n          type: boolean\n        phone_number:\n          type: string\n        phone_number_verified:\n          type: boolean\n        address:\n          type: string\n        address_verified:\n          type: boolean\n        power_of_attorney:\n          type: string\n    \n    StringSerializedJWT:\n      type: byte\n      format: base64\n      description: JWS Compact Serialization JWT -  https://datatracker.ietf.org/doc/html/rfc7515#section-7.1\n    \n    # https://github.com/OAI/OpenAPI-Specification/issues/1971\n    FlattenedJSONSerializedJWT:\n      type: object\n      description: JWS Flattened JSON Serialized JWT - https://datatracker.ietf.org/doc/html/rfc7515#section-7.2\n      properties:\n        payload:\n          $ref: \"#/components/schemas/JWTClaims\"\n        signatures:\n          type: array\n          items:\n            type: object\n        protected:\n          type: string\n        header:\n          type: object            \n    DataRightsRequest:\n      type: object\n      required:\n        - meta\n        - regime\n        - exercise\n        - identity\n      properties:\n        meta:\n          type: object\n          required:\n          - version\n          properties:\n            version:\n              type: string\n              description: the version of the DRP API as implemented. \n              example: \"0.4\"\n              enum: [ 0.4 ]\n        regime:\n          type: string\n          example: ccpa\n          enum: [ ccpa ]\n        exercise:\n          type: array\n          items:\n            type: string\n          enum: \n            - \"sale:opt-out\"\n            - \"sale:opt-in\"\n            - \"deletion\"\n            - \"access\"\n            - \"access:categories\"\n            - \"access:specific\"\n        identity:\n          oneOf:\n            - $ref: '#/components/schemas/JSONWebToken'\n        relationships:\n          type: array\n          items:\n            type: string\n        # https://swagger.io/docs/specification/callbacks/\n        status_callback:\n          type: string\n          format: uri\n    DataRightsStatus:\n      type: object\n      required:\n      - request_id\n      - received_at\n      - status\n      properties:\n        request_id:\n          type: string\n          format: uuid\n        received_at:\n          type: date-time\n        expected_by:\n          type: date-time\n        processing_details:\n          type: string\n        results_url:\n          type: string\n          format: uri\n        # how to express how these compose together?\n        status:\n          type: string\n          enum:\n          - in_progress\n          - open\n          - fulfilled\n          - revoked\n          - denied\n          - expired\n        reason:\n          type: string\n          enum:\n          - need_user_verification\n          - suspected_fraud\n          - insuf_verification\n          - no_match\n          - claim_not_covered\n          - too_many_requests\n          - other\n\n  responses:\n    ValidDRRStatus:\n      description: The Data Rights Request was captured by the PIP.\n      content:\n        application/json:\n          schema: \n            $ref: '#/components/schemas/DataRightsStatus'\n      links:\n        GetDRRStatus:\n          operationId: exerciseStatus\n          description: Status's requestId can be used to get the status again.\n          parameters:\n            requestId: '$response.body#/request_id'\n        RevokeDRR:\n          operationId: revokeRequest\n          description: Status's requestId can be used to revoke open DRRs\n          parameters:\n            requestId: '$response.body#/request_id'\n    \n    InvalidDRRStatus:\n      description: The submitted or queried Data Rights Request is in an invalid state\n      content:\n        application/json:\n          schema:\n            type: object\n            required:\n              - code\n              - message\n            properties:\n              code:\n                description: This must be the same as the HTTP status code for clients which cannot process the headers.\n                type: string\n              message:\n                type: string\n              fatal:\n                type: boolean\n\npaths:\n  /exercise:\n    post:\n      summary: Submit a new Data Rights Request\n      operationId: exerciseRequest\n      requestBody: \n        required: true\n        content:\n          application/json:\n            schema:\n              $ref: '#/components/schemas/DataRightsRequest'\n      responses:\n        '200':\n          $ref: '#/components/responses/ValidDRRStatus'\n        '4XX':\n          $ref: '#/components/responses/InvalidDRRStatus'\n        '5XX':\n          $ref: '#/components/responses/InvalidDRRStatus'\n\n  /status:\n    get:\n      summary: Query the PIP interface for the status of an existing request\n      operationId: exerciseStatus\n      parameters:\n        - in: query\n          name: requestId\n          schema:\n            type: string\n            format: uuid\n          required: true\n          description: the Request ID returned in exerciseRequest\n      responses:\n        '200':\n          $ref: '#/components/responses/ValidDRRStatus'\n        '4XX':\n          $ref: '#/components/responses/InvalidDRRStatus'\n        '5XX':\n          $ref: '#/components/responses/InvalidDRRStatus'\n\n  /revoke:\n    post:\n      summary: Cancel or revoke an in-progress Data Rights Request\n      description: \u003e-\n        This endpoint will instruct the PIP to cancel or revoke a Data\n        Rights Request which is still in a non-terminal state.\n      operationId: revokeRequest\n      requestBody:\n        required: true\n        content:\n          application/json:\n            schema:\n              type: object\n              required:\n                - request_id\n              properties:\n                request_id:\n                  description: The ID of the request to revoke\n                  type: string\n                  format: uuid\n                reason:\n                  description: MAY contain a user-provided reason for the request to not be processed\n                  type: string\n            \n      responses:\n        '200':\n          $ref: '#/components/responses/ValidDRRStatus'\n",
			"canonicalURL": "/github.com/consumer-reports-digital-lab/data-rights-protocol@be2f61c5c469ea58bb909db8560d339087641109/-/blob/openapi.yaml",
			"externalURLs": [
				{
					"url": "https://github.com/consumer-reports-digital-lab/data-rights-protocol/blob/be2f61c5c469ea58bb909db8560d339087641109/openapi.yaml",
					"serviceKind": "GITHUB"
				}
			]
		}
	},
	"Error": "parse: parse spec: parse components: schemas: \"DataRightsRequest\": parse schema: property \"exercise\": at 1:1021: parse enum values: parse value \"\\\"sale:opt-out\\\"\": expected type \"array\", got \"string\""
}